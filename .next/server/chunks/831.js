exports.id=831,exports.ids=[831],exports.modules={95358:(e,t,r)=>{Promise.resolve().then(r.bind(r,33835)),Promise.resolve().then(r.bind(r,3439)),Promise.resolve().then(r.bind(r,40381))},40400:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},33835:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>h,a:()=>f});var o=r(10326),n=r(17577),a=r(60599);let i="72ed6933-6bc6-430e-a75a-cb5d2e1c20e1",l="e4748cdc-321b-4db0-bc36-141b121a9117";i&&l||(console.warn("Azure AD environment variables are not set. Authentication will not work."),console.warn("Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file"));let s={auth:{clientId:i||"dummy-client-id",authority:`https://login.microsoftonline.com/${l||"dummy-tenant-id"}`,redirectUri:"http://localhost:3000"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}},c=new a.Lx(s),u={scopes:["User.Read","Directory.Read.All"]};async function d(){try{if(!i||!l)throw Error("Azure AD environment variables are not configured. Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file");return await c.loginRedirect(u),null}catch(e){throw console.error("Sign in error:",e),e}}async function m(){try{await c.logoutPopup()}catch(e){console.error("Sign out error:",e)}}let g=(0,n.createContext)(void 0);function h({children:e}){let[t,r]=(0,n.useState)(null),[a,i]=(0,n.useState)(!0),l=async()=>{try{i(!0),await d()}catch(e){console.error("Sign in error:",e),i(!1)}},s=async()=>{try{i(!0),await m(),r(null)}catch(e){console.error("Sign out error:",e)}finally{i(!1)}};return o.jsx(g.Provider,{value:{user:t,loading:a,signIn:l,signOut:s},children:e})}function f(){let e=(0,n.useContext)(g);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3439:(e,t,r)=>{"use strict";r.d(t,{MigrationProvider:()=>l,c:()=>s});var o=r(10326),n=r(17577),a=r(40381);let i=(0,n.createContext)(void 0);function l({children:e}){let[t,r]=(0,n.useState)(!1),[l,s]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),d=async()=>{if(!t&&!l){r(!0);try{console.log("Starting client-side migration...");let e=JSON.parse(localStorage.getItem("monthlyProjections")||"{}"),t=JSON.parse(localStorage.getItem("monthlyStatuses")||"{}"),r=JSON.parse(localStorage.getItem("monthlyComments")||"{}"),o=JSON.parse(localStorage.getItem("signedFees")||"{}"),n=JSON.parse(localStorage.getItem("asrFees")||"{}"),i=JSON.parse(localStorage.getItem("closedProjects")||"[]"),l=JSON.parse(localStorage.getItem("projectAssignments")||"{}"),c=JSON.parse(localStorage.getItem("projectManagers")||"[]"),d=[];if(Object.keys(e).length>0)for(let[t,r]of Object.entries(e))for(let[e,o]of Object.entries(r))d.push(fetch("/api/projections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:t,month:e,value:o})}));if(Object.keys(t).length>0)for(let[e,r]of Object.entries(t))for(let[t,o]of Object.entries(r))d.push(fetch("/api/statuses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,month:t,status:o})}));if(Object.keys(r).length>0)for(let[e,t]of Object.entries(r))for(let[r,o]of Object.entries(t))d.push(fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,month:r,comment:o})}));if(Object.keys(o).length>0)for(let[e,t]of Object.entries(o))d.push(fetch("/api/signed-fees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,value:t})}));if(Object.keys(n).length>0)for(let[e,t]of Object.entries(n))d.push(fetch("/api/asr-fees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,value:t})}));if(i.length>0)for(let e of i)d.push(fetch("/api/closed-projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e})}));if(Object.keys(l).length>0)for(let[e,t]of Object.entries(l))d.push(fetch("/api/project-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,managerId:t})}));if(c.length>0)for(let e of c)d.push(fetch("/api/project-managers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}));if(d.length>0){let e=(await Promise.allSettled(d)).filter(e=>"rejected"===e.status);if(e.length>0)throw console.error("Some migrations failed:",e),e.some(e=>"rejected"===e.status&&(e.reason?.message?.includes("Failed to fetch")||e.reason?.message?.includes("connection")||e.reason?.message?.includes("timeout")))?a.ZP.error("Migration failed: Check database connections. Retrying in 5 seconds...",{duration:5e3}):a.ZP.error("Migration failed: Some data could not be migrated. Retrying in 5 seconds...",{duration:5e3}),Error("Migration failed");console.log("Migration completed successfully"),a.ZP.success("Migration complete")}localStorage.removeItem("monthlyProjections"),localStorage.removeItem("monthlyStatuses"),localStorage.removeItem("monthlyComments"),localStorage.removeItem("signedFees"),localStorage.removeItem("asrFees"),localStorage.removeItem("closedProjects"),localStorage.removeItem("projectAssignments"),localStorage.removeItem("projectManagers"),localStorage.setItem("dataMigrated","true"),localStorage.setItem("db_migrated","true"),s(!0),u(!1)}catch(e){console.error("Migration failed:",e),localStorage.setItem("db_migrated","true"),s(!0),setTimeout(()=>{l||m()},5e3)}finally{r(!1)}}},m=async()=>{s(!1),localStorage.removeItem("db_migrated"),localStorage.removeItem("dataMigrated"),await d()};return o.jsx(i.Provider,{value:{isMigrating:t,isMigrated:l,hasLocalData:c,migrateData:d,retryMigration:m},children:e})}function s(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useMigration must be used within a MigrationProvider");return e}},77863:(e,t,r)=>{"use strict";r.d(t,{K0:()=>P,UF:()=>g,_2:()=>b,ab:()=>h,az:()=>j,bh:()=>p,bx:()=>v,cn:()=>u,fc:()=>f,ji:()=>m,sP:()=>O,xG:()=>y});var o=r(95492),n=r(72578),a=r(65160),i=r(40803),l=r(9445),s=r(41135),c=r(31009);function u(...e){return(0,c.m6)((0,s.W)(e))}function d(e,t){let r=[],l=(0,o.Z)(e),s=(0,n.Z)(t);for(;l<=s;)r.push((0,a.Z)(l,"yyyy-MM")),l=(0,i.Z)(l,1);return r}function m(){let e=new Date(2022,0,1),t=new Date;return d(e,(0,i.Z)(t,24))}function g(){let e=new Date;return d((0,l.Z)(e,12),(0,i.Z)(e,12))}function h(e,t,r){let o=t||[],n=r||{},i=m();return(e||[]).map(e=>{let t=o.filter(t=>t.project_id===e.project_id),r=i.map(r=>{let o=t.filter(e=>(0,a.Z)(new Date(e.date),"yyyy-MM")===r),i=o.reduce((e,t)=>e+t.billed_amount,0),l=o.reduce((e,t)=>e+t.unbilled_amount,0),s=n[e.project_id]?.months?.[r]?.value||0;return{month:r,billed:i,unbilled:l,projected:s,actual:i+l}}),l=r.reduce((e,t)=>e+t.billed,0),s=r.reduce((e,t)=>e+t.unbilled,0),c=r.reduce((e,t)=>e+t.projected,0);return{projectId:e.project_id,projectName:e.project_name,customerName:e.customer_name,signedFee:void 0,monthlyData:r,totalBilled:l,totalUnbilled:s,totalProjected:c}})}function f(e,t,r,o){if(!e||!Array.isArray(e))return{totalProjects:0,totalBilled:0,totalUnbilled:0,totalProjected:0,activeProjects:0,totalHours:0,billableHours:0,nonBillableHours:0,averageHourlyRate:0,totalTimeValue:0,efficiency:0,averageHoursPerProject:0,topPerformingProjects:[]};let n=e.length,a=t?t.size:0,i=r||b("monthlyProjections")||{},l=o||b("monthlyStatuses")||{},s=new Date().getFullYear().toString(),c=0;Object.keys(i).forEach(e=>{let t=i[e],r=l[e];t&&r&&Object.keys(t).forEach(e=>{e.startsWith(s)&&"Billed"===r[e]&&(c+=t[e]||0)})});let u=new Date().toISOString().slice(0,7),d=0;Object.keys(i).forEach(e=>{let t=i[e],r=l[e];t&&r&&Object.keys(t).forEach(e=>{e>=u&&"Billed"!==r[e]&&(d+=t[e]||0)})});let m=0;Object.keys(i).forEach(e=>{let t=i[e];t&&Object.keys(t).forEach(e=>{e>=u&&(m+=t[e]||0)})});let g=0,h=0,f=0,y=0,p=0,S=[];e.forEach(e=>{if(e.clockifyData){let t=e.clockifyData;if(g+=t.totalHours,h+=t.billableHours,f+=t.nonBillableHours,y+=t.billableAmount,t.totalHours>0){let r=t.billableHours/t.totalHours;S.push({projectId:e.projectId,efficiency:r,hours:t.totalHours}),p++}}});let j=p>0?y/h:0,P=g>0?h/g:0,v=p>0?g/p:0,O=S.sort((e,t)=>t.efficiency*t.hours-e.efficiency*e.hours).slice(0,5).map(e=>e.projectId);return{totalProjects:n,totalBilled:c,totalUnbilled:d,totalProjected:m,activeProjects:n-a,totalHours:g,billableHours:h,nonBillableHours:f,averageHourlyRate:j,totalTimeValue:y,efficiency:P,averageHoursPerProject:v,topPerformingProjects:O}}function y(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function p(e){let[t,r]=e.split("-"),o=new Date(parseInt(t),parseInt(r)-1);return(0,a.Z)(o,"MMM yyyy")}function S(){try{let e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}}function b(e){if(!S())return console.warn("localStorage is not available"),null;try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.error(`Error reading from localStorage key '${e}':`,t),null}}function j(e,t){if(!S())return console.warn("localStorage is not available"),!1;try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(t){return console.error(`Error writing to localStorage key '${e}':`,t),!1}}function P(e){let t=m(),r={};return(e||[]).forEach(e=>{r[e.project_id]={months:{},asrFee:0},t.forEach(t=>{let o=t>(0,a.Z)(new Date,"yyyy-MM");r[e.project_id].months[t]={value:0,isEditable:o,isProjected:o}})}),r}function v(e){let t=Math.floor(e);return`${t}h ${Math.round((e-t)*60)}m`}function O(e){return`${(100*e).toFixed(1)}%`}},2571:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d,metadata:()=>u});var o=r(19510),n=r(77366),a=r.n(n);r(67272);var i=r(19125),l=r(68570);let s=(0,l.createProxy)(String.raw`C:\Users\Jonathan\Desktop\Billing\lib\AuthContext.tsx#AuthProvider`);(0,l.createProxy)(String.raw`C:\Users\Jonathan\Desktop\Billing\lib\AuthContext.tsx#useAuth`);let c=(0,l.createProxy)(String.raw`C:\Users\Jonathan\Desktop\Billing\lib\migrationContext.tsx#MigrationProvider`);(0,l.createProxy)(String.raw`C:\Users\Jonathan\Desktop\Billing\lib\migrationContext.tsx#useMigration`);let u={title:"Billing Platform",description:"Billing and project management platform"};function d({children:e}){return o.jsx("html",{lang:"en",children:o.jsx("body",{className:a().className,children:o.jsx(s,{children:(0,o.jsxs)(c,{children:[o.jsx(i.x7,{position:"top-right"}),e]})})})})}},67272:()=>{}};
"use strict";(()=>{var e={};e.id=9437,e.ids=[9437],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},17702:e=>{e.exports=require("events")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},95346:e=>{e.exports=require("timers")},15859:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{POST:()=>u});var o=r(49303),i=r(88716),s=r(60670),n=r(87070),p=r(80928),l=r(88403);async function u(e){try{let{action:t,data:r}=await e.json();switch(t){case"process-time-entries":{let{clockifyEntries:e,clockifyUsers:t,projects:a}=r,o=await (0,p.Lk)(e,t,a);return n.NextResponse.json({employeeTimeEntries:o})}case"project-profitability":{let{projectId:e,startDate:t,endDate:a,employeeTimeEntries:o,revenue:i}=r,s=await (0,p.XI)(e,t,a,o,i);return n.NextResponse.json({report:s})}case"employee-profitability":{let{employeeId:e,startDate:t,endDate:a,employeeTimeEntries:o}=r,i=await (0,p.To)(e,t,a,o);return n.NextResponse.json({report:i})}case"full-analysis":{let e=await l.e1.getUser(),t=await l.e1.getProjects(),a=await l.e1.getAllTimeEntries(r.startDate,r.endDate),o=await (0,p.Lk)(a,[e],t),i=[];for(let e of t)if(o.filter(t=>t.projectId===e.id).length>0){let t=r.projectRevenues?.[e.id]||0,a=await (0,p.XI)(e.id,r.startDate,r.endDate,o,t);i.push(a)}return n.NextResponse.json({timeEntries:o,projectReports:i,summary:{totalProjects:i.length,totalHours:o.reduce((e,t)=>e+t.hours,0),totalCost:o.reduce((e,t)=>e+t.totalCost,0),totalRevenue:i.reduce((e,t)=>e+t.totalRevenue,0),totalProfit:i.reduce((e,t)=>e+t.grossProfit,0)}})}default:return n.NextResponse.json({error:"Invalid action"},{status:400})}}catch(e){return console.error("Error in profitability analysis:",e),n.NextResponse.json({error:e.message},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/payroll/profitability/route",pathname:"/api/payroll/profitability",filename:"route",bundlePath:"app/api/payroll/profitability/route"},resolvedPagePath:"C:\\Users\\Jonathan\\Desktop\\Billing\\app\\api\\payroll\\profitability\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:y}=c,f="/api/payroll/profitability/route";function x(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972,8159,8403,928],()=>r(15859));module.exports=a})();
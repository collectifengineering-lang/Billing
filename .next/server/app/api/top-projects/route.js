"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/top-projects/route";
exports.ids = ["app/api/top-projects/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftop-projects%2Froute&page=%2Fapi%2Ftop-projects%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftop-projects%2Froute.ts&appDir=C%3A%5CUsers%5CJonathan%5CDesktop%5CBilling%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CJonathan%5CDesktop%5CBilling&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftop-projects%2Froute&page=%2Fapi%2Ftop-projects%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftop-projects%2Froute.ts&appDir=C%3A%5CUsers%5CJonathan%5CDesktop%5CBilling%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CJonathan%5CDesktop%5CBilling&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Jonathan_Desktop_Billing_app_api_top_projects_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/top-projects/route.ts */ \"(rsc)/./app/api/top-projects/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/top-projects/route\",\n        pathname: \"/api/top-projects\",\n        filename: \"route\",\n        bundlePath: \"app/api/top-projects/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Jonathan\\\\Desktop\\\\Billing\\\\app\\\\api\\\\top-projects\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Jonathan_Desktop_Billing_app_api_top_projects_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/top-projects/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0b3AtcHJvamVjdHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnRvcC1wcm9qZWN0cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnRvcC1wcm9qZWN0cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNKb25hdGhhbiU1Q0Rlc2t0b3AlNUNCaWxsaW5nJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNKb25hdGhhbiU1Q0Rlc2t0b3AlNUNCaWxsaW5nJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUN1QjtBQUNwRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3pvaG8tYmlsbGluZy1wbGF0Zm9ybS8/NDgyZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxKb25hdGhhblxcXFxEZXNrdG9wXFxcXEJpbGxpbmdcXFxcYXBwXFxcXGFwaVxcXFx0b3AtcHJvamVjdHNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3RvcC1wcm9qZWN0cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3RvcC1wcm9qZWN0c1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvdG9wLXByb2plY3RzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcSm9uYXRoYW5cXFxcRGVza3RvcFxcXFxCaWxsaW5nXFxcXGFwcFxcXFxhcGlcXFxcdG9wLXByb2plY3RzXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS90b3AtcHJvamVjdHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftop-projects%2Froute&page=%2Fapi%2Ftop-projects%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftop-projects%2Froute.ts&appDir=C%3A%5CUsers%5CJonathan%5CDesktop%5CBilling%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CJonathan%5CDesktop%5CBilling&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/top-projects/route.ts":
/*!***************************************!*\
  !*** ./app/api/top-projects/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_clockify__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/clockify */ \"(rsc)/./lib/clockify.ts\");\n/* harmony import */ var _lib_zoho__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/zoho */ \"(rsc)/./lib/zoho.ts\");\n\n\n\n// Force dynamic rendering to prevent static generation errors\nconst dynamic = \"force-dynamic\";\nasync function GET(request) {\n    try {\n        console.info(\"\\uD83D\\uDD04 Fetching top projects data...\");\n        // Get date range from query parameters or use defaults\n        const { searchParams } = new URL(request.url);\n        const startDate = searchParams.get(\"start\") || \"2025-01-01T00:00:00.000Z\";\n        const endDate = searchParams.get(\"end\") || new Date().toISOString();\n        console.info(`ðŸ“… Date range: ${startDate} to ${endDate}`);\n        // Fetch data from both services\n        const [clockifyTimeEntries, zohoProjects] = await Promise.allSettled([\n            _lib_clockify__WEBPACK_IMPORTED_MODULE_1__.clockifyService.getAllTimeEntries(startDate, endDate),\n            _lib_zoho__WEBPACK_IMPORTED_MODULE_2__.zohoService.getProjects()\n        ]);\n        // Process Clockify time entries\n        let timeEntries = [];\n        if (clockifyTimeEntries.status === \"fulfilled\") {\n            timeEntries = clockifyTimeEntries.value;\n            console.info(`âœ… Clockify time entries received: ${timeEntries.length} entries`);\n            // Log sample entry for debugging\n            if (timeEntries.length > 0) {\n                const sampleEntry = timeEntries[0];\n                console.info(\"\\uD83D\\uDCDD Sample Clockify entry:\", {\n                    id: sampleEntry.id,\n                    projectId: sampleEntry.projectId,\n                    duration: sampleEntry.timeInterval?.duration,\n                    description: sampleEntry.description?.substring(0, 50) + \"...\"\n                });\n            }\n        } else {\n            console.error(\"âŒ Clockify time entries failed:\", clockifyTimeEntries.reason);\n            timeEntries = []; // Use empty array as fallback\n        }\n        // Process Zoho projects\n        let projects = [];\n        if (zohoProjects.status === \"fulfilled\") {\n            projects = zohoProjects.value;\n            console.info(`âœ… Zoho projects received: ${projects.length} projects`);\n        } else {\n            console.error(\"âŒ Zoho projects failed:\", zohoProjects.reason);\n            projects = []; // Use empty array as fallback\n        }\n        // Calculate project statistics\n        const projectStats = new Map();\n        timeEntries.forEach((entry)=>{\n            try {\n                const projectId = entry.projectId;\n                if (!projectId) {\n                    console.warn(\"âš ï¸ Time entry missing projectId:\", entry.id);\n                    return;\n                }\n                // Parse duration safely\n                let hours = 0;\n                const duration = entry.timeInterval?.duration;\n                if (duration) {\n                    if (typeof duration === \"string\") {\n                        // Handle ISO 8601 duration format (e.g., \"PT1H30M\")\n                        const match = duration.match(/PT(?:(\\d+)H)?(?:(\\d+)M)?/);\n                        if (match) {\n                            const hoursPart = parseInt(match[1] || \"0\");\n                            const minutesPart = parseInt(match[2] || \"0\");\n                            hours = hoursPart + minutesPart / 60;\n                        }\n                    } else if (typeof duration === \"number\") {\n                        // Handle duration in seconds\n                        hours = duration / 3600;\n                    }\n                }\n                if (!projectStats.has(projectId)) {\n                    projectStats.set(projectId, {\n                        projectId,\n                        totalHours: 0,\n                        billableHours: 0,\n                        entryCount: 0\n                    });\n                }\n                const stats = projectStats.get(projectId);\n                stats.totalHours += hours;\n                if (entry.billable) {\n                    stats.billableHours += hours;\n                }\n                stats.entryCount += 1;\n            } catch (entryError) {\n                console.error(\"âŒ Error processing time entry for stats:\", entryError);\n                console.error(\"   Problematic entry:\", entry);\n            }\n        });\n        // Convert to array and sort by total hours\n        const topProjects = Array.from(projectStats.values()).sort((a, b)=>b.totalHours - a.totalHours).slice(0, 10); // Top 10 projects\n        console.info(`ðŸ“Š Calculated stats for ${topProjects.length} top projects`);\n        // Return successful response\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: {\n                topProjects,\n                timeEntriesCount: timeEntries.length,\n                projectsCount: projects.length,\n                dateRange: {\n                    start: startDate,\n                    end: endDate\n                }\n            },\n            timestamp: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"âŒ Error in top-projects API:\", {\n            message: error.message,\n            stack: error.stack,\n            timestamp: new Date().toISOString()\n        });\n        // Return error response with helpful information\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to fetch top projects data\",\n            message: error.message || \"An unexpected error occurred\",\n            details: {\n                clockifyStatus: \"Failed to process time entries\",\n                zohoStatus: \"Failed to fetch projects\",\n                suggestions: [\n                    \"Check Clockify API configuration and plan level\",\n                    \"Verify Zoho authentication and rate limits\",\n                    \"Check Vercel logs for detailed error information\"\n                ]\n            },\n            timestamp: new Date().toISOString()\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU9DLFdBQVc7UUFDbkM7SUFFRixFQUFFLE9BQU9rQixPQUFZO1FBQ25CM0IsUUFBUTJCLEtBQUssQ0FBQyxnQ0FBZ0M7WUFDNUNzQyxTQUFTdEMsTUFBTXNDLE9BQU87WUFDdEJDLE9BQU92QyxNQUFNdUMsS0FBSztZQUNsQkYsV0FBVyxJQUFJeEQsT0FBT0MsV0FBVztRQUNuQztRQUVBLGlEQUFpRDtRQUNqRCxPQUFPZixxREFBWUEsQ0FBQzhELElBQUksQ0FBQztZQUN2QkMsU0FBUztZQUNUOUIsT0FBTztZQUNQc0MsU0FBU3RDLE1BQU1zQyxPQUFPLElBQUk7WUFDMUJFLFNBQVM7Z0JBQ1BDLGdCQUFnQjtnQkFDaEJDLFlBQVk7Z0JBQ1pDLGFBQWE7b0JBQ1g7b0JBQ0E7b0JBQ0E7aUJBQ0Q7WUFDSDtZQUNBTixXQUFXLElBQUl4RCxPQUFPQyxXQUFXO1FBQ25DLEdBQUc7WUFBRVEsUUFBUTtRQUFJO0lBQ25CO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly96b2hvLWJpbGxpbmctcGxhdGZvcm0vLi9hcHAvYXBpL3RvcC1wcm9qZWN0cy9yb3V0ZS50cz81OTgwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IGNsb2NraWZ5U2VydmljZSB9IGZyb20gJ0AvbGliL2Nsb2NraWZ5JztcclxuaW1wb3J0IHsgem9ob1NlcnZpY2UgfSBmcm9tICdAL2xpYi96b2hvJztcclxuXHJcbi8vIEZvcmNlIGR5bmFtaWMgcmVuZGVyaW5nIHRvIHByZXZlbnQgc3RhdGljIGdlbmVyYXRpb24gZXJyb3JzXHJcbmV4cG9ydCBjb25zdCBkeW5hbWljID0gJ2ZvcmNlLWR5bmFtaWMnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmluZm8oJ/CflIQgRmV0Y2hpbmcgdG9wIHByb2plY3RzIGRhdGEuLi4nKTtcclxuICAgIFxyXG4gICAgLy8gR2V0IGRhdGUgcmFuZ2UgZnJvbSBxdWVyeSBwYXJhbWV0ZXJzIG9yIHVzZSBkZWZhdWx0c1xyXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xyXG4gICAgY29uc3Qgc3RhcnREYXRlID0gc2VhcmNoUGFyYW1zLmdldCgnc3RhcnQnKSB8fCAnMjAyNS0wMS0wMVQwMDowMDowMC4wMDBaJztcclxuICAgIGNvbnN0IGVuZERhdGUgPSBzZWFyY2hQYXJhbXMuZ2V0KCdlbmQnKSB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUuaW5mbyhg8J+ThSBEYXRlIHJhbmdlOiAke3N0YXJ0RGF0ZX0gdG8gJHtlbmREYXRlfWApO1xyXG4gICAgXHJcbiAgICAvLyBGZXRjaCBkYXRhIGZyb20gYm90aCBzZXJ2aWNlc1xyXG4gICAgY29uc3QgW2Nsb2NraWZ5VGltZUVudHJpZXMsIHpvaG9Qcm9qZWN0c10gPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoW1xyXG4gICAgICBjbG9ja2lmeVNlcnZpY2UuZ2V0QWxsVGltZUVudHJpZXMoc3RhcnREYXRlLCBlbmREYXRlKSxcclxuICAgICAgem9ob1NlcnZpY2UuZ2V0UHJvamVjdHMoKVxyXG4gICAgXSk7XHJcbiAgICBcclxuICAgIC8vIFByb2Nlc3MgQ2xvY2tpZnkgdGltZSBlbnRyaWVzXHJcbiAgICBsZXQgdGltZUVudHJpZXM6IGFueVtdID0gW107XHJcbiAgICBpZiAoY2xvY2tpZnlUaW1lRW50cmllcy5zdGF0dXMgPT09ICdmdWxmaWxsZWQnKSB7XHJcbiAgICAgIHRpbWVFbnRyaWVzID0gY2xvY2tpZnlUaW1lRW50cmllcy52YWx1ZTtcclxuICAgICAgY29uc29sZS5pbmZvKGDinIUgQ2xvY2tpZnkgdGltZSBlbnRyaWVzIHJlY2VpdmVkOiAke3RpbWVFbnRyaWVzLmxlbmd0aH0gZW50cmllc2ApO1xyXG4gICAgICBcclxuICAgICAgLy8gTG9nIHNhbXBsZSBlbnRyeSBmb3IgZGVidWdnaW5nXHJcbiAgICAgIGlmICh0aW1lRW50cmllcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3Qgc2FtcGxlRW50cnkgPSB0aW1lRW50cmllc1swXTtcclxuICAgICAgICBjb25zb2xlLmluZm8oJ/Cfk50gU2FtcGxlIENsb2NraWZ5IGVudHJ5OicsIHtcclxuICAgICAgICAgIGlkOiBzYW1wbGVFbnRyeS5pZCxcclxuICAgICAgICAgIHByb2plY3RJZDogc2FtcGxlRW50cnkucHJvamVjdElkLFxyXG4gICAgICAgICAgZHVyYXRpb246IHNhbXBsZUVudHJ5LnRpbWVJbnRlcnZhbD8uZHVyYXRpb24sXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogc2FtcGxlRW50cnkuZGVzY3JpcHRpb24/LnN1YnN0cmluZygwLCA1MCkgKyAnLi4uJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgQ2xvY2tpZnkgdGltZSBlbnRyaWVzIGZhaWxlZDonLCBjbG9ja2lmeVRpbWVFbnRyaWVzLnJlYXNvbik7XHJcbiAgICAgIHRpbWVFbnRyaWVzID0gW107IC8vIFVzZSBlbXB0eSBhcnJheSBhcyBmYWxsYmFja1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBQcm9jZXNzIFpvaG8gcHJvamVjdHNcclxuICAgIGxldCBwcm9qZWN0czogYW55W10gPSBbXTtcclxuICAgIGlmICh6b2hvUHJvamVjdHMuc3RhdHVzID09PSAnZnVsZmlsbGVkJykge1xyXG4gICAgICBwcm9qZWN0cyA9IHpvaG9Qcm9qZWN0cy52YWx1ZTtcclxuICAgICAgY29uc29sZS5pbmZvKGDinIUgWm9obyBwcm9qZWN0cyByZWNlaXZlZDogJHtwcm9qZWN0cy5sZW5ndGh9IHByb2plY3RzYCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgWm9obyBwcm9qZWN0cyBmYWlsZWQ6Jywgem9ob1Byb2plY3RzLnJlYXNvbik7XHJcbiAgICAgIHByb2plY3RzID0gW107IC8vIFVzZSBlbXB0eSBhcnJheSBhcyBmYWxsYmFja1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDYWxjdWxhdGUgcHJvamVjdCBzdGF0aXN0aWNzXHJcbiAgICBjb25zdCBwcm9qZWN0U3RhdHMgPSBuZXcgTWFwKCk7XHJcbiAgICBcclxuICAgIHRpbWVFbnRyaWVzLmZvckVhY2goZW50cnkgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RJZCA9IGVudHJ5LnByb2plY3RJZDtcclxuICAgICAgICBpZiAoIXByb2plY3RJZCkge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gVGltZSBlbnRyeSBtaXNzaW5nIHByb2plY3RJZDonLCBlbnRyeS5pZCk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFBhcnNlIGR1cmF0aW9uIHNhZmVseVxyXG4gICAgICAgIGxldCBob3VycyA9IDA7XHJcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBlbnRyeS50aW1lSW50ZXJ2YWw/LmR1cmF0aW9uO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChkdXJhdGlvbikge1xyXG4gICAgICAgICAgaWYgKHR5cGVvZiBkdXJhdGlvbiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgLy8gSGFuZGxlIElTTyA4NjAxIGR1cmF0aW9uIGZvcm1hdCAoZS5nLiwgXCJQVDFIMzBNXCIpXHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gZHVyYXRpb24ubWF0Y2goL1BUKD86KFxcZCspSCk/KD86KFxcZCspTSk/Lyk7XHJcbiAgICAgICAgICAgIGlmIChtYXRjaCkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGhvdXJzUGFydCA9IHBhcnNlSW50KG1hdGNoWzFdIHx8ICcwJyk7XHJcbiAgICAgICAgICAgICAgY29uc3QgbWludXRlc1BhcnQgPSBwYXJzZUludChtYXRjaFsyXSB8fCAnMCcpO1xyXG4gICAgICAgICAgICAgIGhvdXJzID0gaG91cnNQYXJ0ICsgKG1pbnV0ZXNQYXJ0IC8gNjApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkdXJhdGlvbiA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgLy8gSGFuZGxlIGR1cmF0aW9uIGluIHNlY29uZHNcclxuICAgICAgICAgICAgaG91cnMgPSBkdXJhdGlvbiAvIDM2MDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghcHJvamVjdFN0YXRzLmhhcyhwcm9qZWN0SWQpKSB7XHJcbiAgICAgICAgICBwcm9qZWN0U3RhdHMuc2V0KHByb2plY3RJZCwge1xyXG4gICAgICAgICAgICBwcm9qZWN0SWQsXHJcbiAgICAgICAgICAgIHRvdGFsSG91cnM6IDAsXHJcbiAgICAgICAgICAgIGJpbGxhYmxlSG91cnM6IDAsXHJcbiAgICAgICAgICAgIGVudHJ5Q291bnQ6IDBcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBzdGF0cyA9IHByb2plY3RTdGF0cy5nZXQocHJvamVjdElkKTtcclxuICAgICAgICBzdGF0cy50b3RhbEhvdXJzICs9IGhvdXJzO1xyXG4gICAgICAgIGlmIChlbnRyeS5iaWxsYWJsZSkge1xyXG4gICAgICAgICAgc3RhdHMuYmlsbGFibGVIb3VycyArPSBob3VycztcclxuICAgICAgICB9XHJcbiAgICAgICAgc3RhdHMuZW50cnlDb3VudCArPSAxO1xyXG4gICAgICAgIFxyXG4gICAgICB9IGNhdGNoIChlbnRyeUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIHByb2Nlc3NpbmcgdGltZSBlbnRyeSBmb3Igc3RhdHM6JywgZW50cnlFcnJvcik7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignICAgUHJvYmxlbWF0aWMgZW50cnk6JywgZW50cnkpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gQ29udmVydCB0byBhcnJheSBhbmQgc29ydCBieSB0b3RhbCBob3Vyc1xyXG4gICAgY29uc3QgdG9wUHJvamVjdHMgPSBBcnJheS5mcm9tKHByb2plY3RTdGF0cy52YWx1ZXMoKSlcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIudG90YWxIb3VycyAtIGEudG90YWxIb3VycylcclxuICAgICAgLnNsaWNlKDAsIDEwKTsgLy8gVG9wIDEwIHByb2plY3RzXHJcbiAgICBcclxuICAgIGNvbnNvbGUuaW5mbyhg8J+TiiBDYWxjdWxhdGVkIHN0YXRzIGZvciAke3RvcFByb2plY3RzLmxlbmd0aH0gdG9wIHByb2plY3RzYCk7XHJcbiAgICBcclxuICAgIC8vIFJldHVybiBzdWNjZXNzZnVsIHJlc3BvbnNlXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgdG9wUHJvamVjdHMsXHJcbiAgICAgICAgdGltZUVudHJpZXNDb3VudDogdGltZUVudHJpZXMubGVuZ3RoLFxyXG4gICAgICAgIHByb2plY3RzQ291bnQ6IHByb2plY3RzLmxlbmd0aCxcclxuICAgICAgICBkYXRlUmFuZ2U6IHsgc3RhcnQ6IHN0YXJ0RGF0ZSwgZW5kOiBlbmREYXRlIH1cclxuICAgICAgfSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGluIHRvcC1wcm9qZWN0cyBBUEk6Jywge1xyXG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICBzdGFjazogZXJyb3Iuc3RhY2ssXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gUmV0dXJuIGVycm9yIHJlc3BvbnNlIHdpdGggaGVscGZ1bCBpbmZvcm1hdGlvblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIHRvcCBwcm9qZWN0cyBkYXRhJyxcclxuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCcsXHJcbiAgICAgIGRldGFpbHM6IHtcclxuICAgICAgICBjbG9ja2lmeVN0YXR1czogJ0ZhaWxlZCB0byBwcm9jZXNzIHRpbWUgZW50cmllcycsXHJcbiAgICAgICAgem9ob1N0YXR1czogJ0ZhaWxlZCB0byBmZXRjaCBwcm9qZWN0cycsXHJcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFtcclxuICAgICAgICAgICdDaGVjayBDbG9ja2lmeSBBUEkgY29uZmlndXJhdGlvbiBhbmQgcGxhbiBsZXZlbCcsXHJcbiAgICAgICAgICAnVmVyaWZ5IFpvaG8gYXV0aGVudGljYXRpb24gYW5kIHJhdGUgbGltaXRzJyxcclxuICAgICAgICAgICdDaGVjayBWZXJjZWwgbG9ncyBmb3IgZGV0YWlsZWQgZXJyb3IgaW5mb3JtYXRpb24nXHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNsb2NraWZ5U2VydmljZSIsInpvaG9TZXJ2aWNlIiwiZHluYW1pYyIsIkdFVCIsInJlcXVlc3QiLCJjb25zb2xlIiwiaW5mbyIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsInN0YXJ0RGF0ZSIsImdldCIsImVuZERhdGUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJjbG9ja2lmeVRpbWVFbnRyaWVzIiwiem9ob1Byb2plY3RzIiwiUHJvbWlzZSIsImFsbFNldHRsZWQiLCJnZXRBbGxUaW1lRW50cmllcyIsImdldFByb2plY3RzIiwidGltZUVudHJpZXMiLCJzdGF0dXMiLCJ2YWx1ZSIsImxlbmd0aCIsInNhbXBsZUVudHJ5IiwiaWQiLCJwcm9qZWN0SWQiLCJkdXJhdGlvbiIsInRpbWVJbnRlcnZhbCIsImRlc2NyaXB0aW9uIiwic3Vic3RyaW5nIiwiZXJyb3IiLCJyZWFzb24iLCJwcm9qZWN0cyIsInByb2plY3RTdGF0cyIsIk1hcCIsImZvckVhY2giLCJlbnRyeSIsIndhcm4iLCJob3VycyIsIm1hdGNoIiwiaG91cnNQYXJ0IiwicGFyc2VJbnQiLCJtaW51dGVzUGFydCIsImhhcyIsInNldCIsInRvdGFsSG91cnMiLCJiaWxsYWJsZUhvdXJzIiwiZW50cnlDb3VudCIsInN0YXRzIiwiYmlsbGFibGUiLCJlbnRyeUVycm9yIiwidG9wUHJvamVjdHMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJzb3J0IiwiYSIsImIiLCJzbGljZSIsImpzb24iLCJzdWNjZXNzIiwiZGF0YSIsInRpbWVFbnRyaWVzQ291bnQiLCJwcm9qZWN0c0NvdW50IiwiZGF0ZVJhbmdlIiwic3RhcnQiLCJlbmQiLCJ0aW1lc3RhbXAiLCJtZXNzYWdlIiwic3RhY2siLCJkZXRhaWxzIiwiY2xvY2tpZnlTdGF0dXMiLCJ6b2hvU3RhdHVzIiwic3VnZ2VzdGlvbnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/top-projects/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/clockify.ts":
/*!*************************!*\
  !*** ./lib/clockify.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clockifyService: () => (/* binding */ clockifyService),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   fetchAllClockifyTimeSummaries: () => (/* binding */ fetchAllClockifyTimeSummaries),\n/* harmony export */   fetchClockifyProjects: () => (/* binding */ fetchClockifyProjects),\n/* harmony export */   fetchClockifyTimeEntries: () => (/* binding */ fetchClockifyTimeEntries),\n/* harmony export */   fetchClockifyTimeReport: () => (/* binding */ fetchClockifyTimeReport)\n/* harmony export */ });\nclass ClockifyService {\n    constructor(){\n        this.apiKey = null;\n        this.workspaceId = null;\n        this.baseUrl = \"https://api.clockify.me/api/v1\";\n        this.reportsBaseUrl = \"https://reports.api.clockify.me/v1\" // Correct Reports API base URL\n        ;\n        this._isConfigured = false;\n        this.apiKey = process.env.CLOCKIFY_API_KEY || null;\n        this.workspaceId = process.env.CLOCKIFY_WORKSPACE_ID || null;\n        // Check if we have valid credentials\n        if (this.apiKey && this.apiKey !== \"your_clockify_api_key_here\" && this.workspaceId && this.workspaceId !== \"your_clockify_workspace_id_here\") {\n            this._isConfigured = true;\n            console.info(\"Clockify service initialized with valid credentials\");\n        } else {\n            this._isConfigured = false;\n            console.warn(\"Clockify service initialized without valid credentials - will use mock data\");\n            console.warn(\"Please set CLOCKIFY_API_KEY and CLOCKIFY_WORKSPACE_ID in your environment variables\");\n        }\n    }\n    getHeaders() {\n        if (!this.apiKey) {\n            throw new Error(\"Clockify API key not configured\");\n        }\n        return {\n            \"X-Api-Key\": this.apiKey,\n            \"Content-Type\": \"application/json\"\n        };\n    }\n    async makeRequest(endpoint, params) {\n        if (!this._isConfigured) {\n            throw new Error(\"Clockify service not properly configured\");\n        }\n        try {\n            const url = new URL(`${this.baseUrl}${endpoint}`);\n            if (params) {\n                Object.keys(params).forEach((key)=>{\n                    if (params[key] !== undefined && params[key] !== null) {\n                        url.searchParams.append(key, params[key]);\n                    }\n                });\n            }\n            console.log(`ðŸ” Clockify API Request: ${url.toString()}`);\n            console.log(`   Headers: ${JSON.stringify(this.getHeaders())}`);\n            const response = await fetch(url.toString(), {\n                method: \"GET\",\n                headers: this.getHeaders()\n            });\n            console.log(`ðŸ“¡ Clockify API Response: ${response.status} ${response.statusText}`);\n            if (response.status === 401) {\n                throw new Error(\"Clockify API authentication failed - check your API key\");\n            }\n            if (response.status === 403) {\n                throw new Error(\"Clockify API access forbidden - check your workspace ID and permissions\");\n            }\n            if (response.status === 404) {\n                const errorDetails = `Endpoint not found: ${endpoint}`;\n                console.error(`âŒ 404 Error Details: ${errorDetails}`);\n                console.error(`   Full URL: ${url.toString()}`);\n                console.error(`   Workspace ID: ${this.workspaceId}`);\n                console.error(`   API Key configured: ${!!this.apiKey}`);\n                throw new Error(`Clockify API error: 404 Not Found - ${errorDetails}`);\n            }\n            if (response.status === 429) {\n                throw new Error(\"Clockify API rate limit exceeded - try again later\");\n            }\n            if (!response.ok) {\n                const errorText = await response.text().catch(()=>\"Unknown error\");\n                throw new Error(`Clockify API error: ${response.status} ${response.statusText} - ${errorText}`);\n            }\n            const data = await response.json();\n            console.log(`âœ… Clockify API Success: ${endpoint}`);\n            return data;\n        } catch (error) {\n            if (error instanceof Error) {\n                console.error(`âŒ Clockify API Error in ${endpoint}:`, error.message);\n                throw error;\n            }\n            throw new Error(`Clockify API request failed: ${error}`);\n        }\n    }\n    // Check if the service is properly configured\n    isConfigured() {\n        return this._isConfigured;\n    }\n    // Get configuration status for debugging\n    getConfigurationStatus() {\n        return {\n            configured: this._isConfigured,\n            hasApiKey: !!(this.apiKey && this.apiKey !== \"your_clockify_api_key_here\"),\n            hasWorkspaceId: !!(this.workspaceId && this.workspaceId !== \"your_clockify_workspace_id_here\")\n        };\n    }\n    // Alias for getConfigurationStatus to match API usage\n    getConfigStatus() {\n        return this.getConfigurationStatus();\n    }\n    // Method to set workspace ID dynamically\n    setWorkspaceId(workspaceId) {\n        this.workspaceId = workspaceId;\n        if (this.apiKey && this.apiKey !== \"your_clockify_api_key_here\") {\n            this._isConfigured = true;\n        }\n    }\n    async getUser() {\n        try {\n            if (!this._isConfigured) {\n                console.log(\"Clockify not configured, returning mock user\");\n                return this.getMockUser();\n            }\n            const url = new URL(`${this.baseUrl}/user`);\n            console.log(`ðŸ” Clockify API Request: ${url.toString()}`);\n            const response = await fetch(url.toString(), {\n                method: \"GET\",\n                headers: this.getHeaders()\n            });\n            if (!response.ok) {\n                throw new Error(`Clockify API error: ${response.status} ${response.statusText}`);\n            }\n            const data = await response.json();\n            console.log(`âœ… Clockify API Success: /user`);\n            return data;\n        } catch (error) {\n            console.error(\"Failed to get Clockify user:\", error);\n            console.log(\"Returning mock user due to Clockify API failure\");\n            return this.getMockUser();\n        }\n    }\n    async getWorkspaces() {\n        try {\n            return await this.makeRequest(\"/workspaces\");\n        } catch (error) {\n            console.error(\"Failed to get Clockify workspaces:\", error);\n            // Return mock workspace data when Clockify fails\n            return [\n                {\n                    id: \"mock-workspace-id\",\n                    name: \"Mock Workspace\",\n                    hourlyRate: {\n                        amount: 100,\n                        currency: \"USD\"\n                    }\n                }\n            ];\n        }\n    }\n    async getProjects() {\n        try {\n            if (!this._isConfigured) {\n                console.log(\"Clockify not configured, returning mock projects\");\n                return this.getMockProjects();\n            }\n            if (!this.workspaceId) {\n                throw new Error(\"Workspace ID not configured\");\n            }\n            const url = new URL(`${this.baseUrl}/workspaces/${this.workspaceId}/projects`);\n            console.log(`ðŸ” Clockify API Request: ${url.toString()}`);\n            const response = await fetch(url.toString(), {\n                method: \"GET\",\n                headers: this.getHeaders()\n            });\n            if (!response.ok) {\n                throw new Error(`Clockify API error: ${response.status} ${response.statusText}`);\n            }\n            const data = await response.json();\n            console.log(`âœ… Clockify API Success: /workspaces/${this.workspaceId}/projects`);\n            return data;\n        } catch (error) {\n            console.error(\"Failed to get Clockify projects:\", error);\n            console.log(\"Returning mock projects due to Clockify API failure\");\n            return this.getMockProjects();\n        }\n    }\n    async getTimeEntries(projectId, startDate, endDate) {\n        try {\n            if (!this._isConfigured) {\n                console.log(\"Clockify not configured, returning mock data\");\n                return this.getMockTimeEntries(projectId, startDate, endDate);\n            }\n            if (!this.workspaceId) {\n                throw new Error(\"Workspace ID not configured\");\n            }\n            const url = new URL(`${this.baseUrl}/workspaces/${this.workspaceId}/projects/${projectId}/time-entries`);\n            url.searchParams.append(\"start\", startDate);\n            url.searchParams.append(\"end\", endDate);\n            console.log(`ðŸ” Clockify API Request: ${url.toString()}`);\n            const response = await fetch(url.toString(), {\n                method: \"GET\",\n                headers: this.getHeaders()\n            });\n            if (!response.ok) {\n                throw new Error(`Clockify API error: ${response.status} ${response.statusText}`);\n            }\n            const data = await response.json();\n            console.log(`âœ… Clockify API Success: /workspaces/${this.workspaceId}/projects/${projectId}/time-entries`);\n            return data;\n        } catch (error) {\n            console.error(\"Failed to get Clockify time entries:\", error);\n            console.log(\"Returning mock time entry data due to Clockify API failure\");\n            return this.getMockTimeEntries(projectId, startDate, endDate);\n        }\n    }\n    async getAllTimeEntries(startDate, endDate) {\n        try {\n            if (!this.workspaceId) {\n                throw new Error(\"Workspace ID not configured\");\n            }\n            // First try the Reports API for bulk time entry data\n            try {\n                console.info(\"\\uD83D\\uDD04 Attempting to fetch time entries via Clockify Reports API (requires Pro plan)...\");\n                return await this.getTimeEntriesViaReports(startDate, endDate);\n            } catch (reportsError) {\n                console.warn(\"âš ï¸ Clockify Reports API failed, falling back to user time entries endpoint:\", {\n                    error: reportsError instanceof Error ? reportsError.message : \"Unknown error\",\n                    reason: \"Reports API may require Pro plan or may be temporarily unavailable\",\n                    fallback: \"Using user time entries endpoint instead\"\n                });\n                return await this.getTimeEntriesViaUserEndpoint(startDate, endDate);\n            }\n        } catch (error) {\n            console.error(\"âŒ Failed to get all Clockify time entries:\", error);\n            // Return mock time entry data when Clockify fails\n            console.warn(\"\\uD83C\\uDFAD Returning mock time entry data due to Clockify API failure. Check your plan level and API configuration.\");\n            return [\n                {\n                    id: \"mock-time-entry-1\",\n                    description: \"Mock work session (Clockify API unavailable)\",\n                    timeInterval: {\n                        start: startDate,\n                        end: endDate,\n                        duration: \"PT8H0M\"\n                    },\n                    billable: true,\n                    userId: \"mock-user-id\",\n                    userName: \"Mock User\",\n                    projectId: \"mock-project-1\",\n                    projectName: \"Mock Project 1\"\n                }\n            ];\n        }\n    }\n    // Method to get time entries via Reports API (preferred method)\n    async getTimeEntriesViaReports(startDate, endDate) {\n        const url = new URL(`${this.reportsBaseUrl}/workspaces/${this.workspaceId}/reports/detailed`);\n        console.info(`ðŸ” Clockify Reports API Request: ${url.toString()}`);\n        console.info(`   Method: POST (Reports API)`);\n        console.info(`   Headers: ${JSON.stringify(this.getHeaders())}`);\n        console.info(`   Body: ${JSON.stringify({\n            dateRangeStart: startDate,\n            dateRangeEnd: endDate,\n            detailedFilter: {\n                pageSize: 1000,\n                sortColumn: \"DATE\"\n            }\n        })}`);\n        const response = await fetch(url.toString(), {\n            method: \"POST\",\n            headers: {\n                ...this.getHeaders(),\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                dateRangeStart: startDate,\n                dateRangeEnd: endDate,\n                detailedFilter: {\n                    pageSize: 1000,\n                    sortColumn: \"DATE\"\n                }\n            })\n        });\n        console.info(`ðŸ“¡ Clockify Reports API Response: ${response.status} ${response.statusText}`);\n        if (response.status === 401) {\n            throw new Error(\"Clockify API authentication failed - check your API key\");\n        }\n        if (response.status === 403) {\n            throw new Error(\"Clockify API access forbidden - check your workspace ID and permissions. Note: Detailed reports require Pro plan or higher.\");\n        }\n        if (response.status === 404) {\n            const errorDetails = `Reports endpoint not found: /workspaces/${this.workspaceId}/reports/detailed`;\n            console.error(`âŒ 404 Error Details: ${errorDetails}`);\n            console.error(`   Full URL: ${url.toString()}`);\n            console.error(`   Workspace ID: ${this.workspaceId}`);\n            console.error(`   API Key configured: ${!!this.apiKey}`);\n            console.error(`   Note: This endpoint requires Clockify Pro plan or higher for detailed reports`);\n            throw new Error(`Clockify API error: 404 Not Found - ${errorDetails}. This endpoint requires Pro plan or higher.`);\n        }\n        if (response.status === 405) {\n            throw new Error(\"Clockify API method not allowed - this endpoint requires POST method\");\n        }\n        if (response.status === 429) {\n            throw new Error(\"Clockify API rate limit exceeded - try again later\");\n        }\n        if (!response.ok) {\n            const errorText = await response.text().catch(()=>\"Unknown error\");\n            console.error(`Clockify Reports API error response body: ${errorText}`);\n            throw new Error(`Clockify API error: ${response.status} ${response.statusText} - ${errorText}`);\n        }\n        const data = await response.json();\n        console.info(`âœ… Clockify Reports API Success: /workspaces/${this.workspaceId}/reports/detailed`);\n        // Transform the reports data to match our expected time entry format\n        if (data.timeentries && Array.isArray(data.timeentries)) {\n            console.info(`ðŸ“Š Processing ${data.timeentries.length} time entries from Reports API`);\n            return data.timeentries.map((entry, index)=>{\n                try {\n                    // Handle duration conversion - Reports API returns duration in seconds as number\n                    let duration = \"PT0H0M\";\n                    // First try to use the duration field if it's valid\n                    if (entry.duration !== undefined && entry.duration !== null) {\n                        if (typeof entry.duration === \"number\" && entry.duration > 0) {\n                            // Convert seconds to ISO 8601 duration format\n                            const hours = Math.floor(entry.duration / 3600);\n                            const minutes = Math.floor(entry.duration % 3600 / 60);\n                            duration = `PT${hours}H${minutes}M`;\n                        } else if (typeof entry.duration === \"string\" && entry.duration !== \"PT0H0M\") {\n                            // If it's already a string and not zero, use it directly\n                            duration = entry.duration;\n                        }\n                    }\n                    // If duration is still zero, calculate it from start and end times\n                    if (duration === \"PT0H0M\" && entry.timeInterval?.start && entry.timeInterval?.end) {\n                        try {\n                            const startTime = new Date(entry.timeInterval.start);\n                            const endTime = new Date(entry.timeInterval.end);\n                            if (!isNaN(startTime.getTime()) && !isNaN(endTime.getTime()) && endTime > startTime) {\n                                const diffMs = endTime.getTime() - startTime.getTime();\n                                const diffHours = diffMs / (1000 * 60 * 60);\n                                const hours = Math.floor(diffHours);\n                                const minutes = Math.floor((diffHours - hours) * 60);\n                                duration = `PT${hours}H${minutes}M`;\n                            }\n                        } catch (timeError) {\n                            console.warn(`âš ï¸ Error calculating duration from start/end times for entry ${index}:`, timeError);\n                        }\n                    }\n                    // Handle undefined IDs - generate a fallback ID if needed\n                    const entryId = entry.id || `reports-entry-${index}-${Date.now()}`;\n                    // Log sample entry for debugging (first few entries)\n                    if (index < 3) {\n                        console.info(`ðŸ“ Sample entry ${index}:`, {\n                            id: entryId,\n                            duration: entry.duration,\n                            convertedDuration: duration,\n                            projectId: entry.projectId,\n                            userId: entry.userId\n                        });\n                    }\n                    return {\n                        id: entryId,\n                        description: entry.description || \"No description\",\n                        timeInterval: {\n                            start: entry.timeInterval?.start || entry.start,\n                            end: entry.timeInterval?.end || entry.end,\n                            duration: duration\n                        },\n                        billable: entry.billable || false,\n                        userId: entry.userId || \"unknown-user\",\n                        userName: entry.userName || \"Unknown User\",\n                        projectId: entry.projectId || \"unknown-project\",\n                        projectName: entry.projectName || \"Unknown Project\",\n                        hourlyRate: entry.hourlyRate || 0\n                    };\n                } catch (entryError) {\n                    console.error(`âŒ Error processing time entry ${index}:`, entryError);\n                    console.error(`   Raw entry data:`, entry);\n                    // Return a safe fallback entry\n                    return {\n                        id: `error-entry-${index}-${Date.now()}`,\n                        description: \"Error processing entry\",\n                        timeInterval: {\n                            start: startDate,\n                            end: endDate,\n                            duration: \"PT0H0M\"\n                        },\n                        billable: false,\n                        userId: \"error-user\",\n                        userName: \"Error User\",\n                        projectId: \"error-project\",\n                        projectName: \"Error Project\",\n                        hourlyRate: 0\n                    };\n                }\n            }).filter((entry)=>entry !== null); // Remove any null entries\n        }\n        console.warn(\"âš ï¸ No time entries found in Reports API response\");\n        return [];\n    }\n    // Fallback method to get time entries via user endpoint (GET method)\n    async getTimeEntriesViaUserEndpoint(startDate, endDate) {\n        try {\n            // Get the current user first\n            const user = await this.getUser();\n            if (!user?.id) {\n                throw new Error(\"Could not get current user for time entries\");\n            }\n            // Use GET method with query parameters - this is the correct way to fetch time entries\n            const url = new URL(`${this.baseUrl}/workspaces/${this.workspaceId}/user/${user.id}/time-entries`);\n            url.searchParams.set(\"start\", startDate);\n            url.searchParams.set(\"end\", endDate);\n            console.info(`ðŸ” Clockify User Time Entries API Request (Fallback): ${url.toString()}`);\n            console.info(`   Method: GET (User Time Entries - Fallback from Reports API)`);\n            console.info(`   Headers: ${JSON.stringify(this.getHeaders())}`);\n            console.info(`   Note: Using fallback method because Reports API failed or requires Pro plan`);\n            const response = await fetch(url.toString(), {\n                method: \"GET\",\n                headers: this.getHeaders()\n            });\n            console.info(`ðŸ“¡ Clockify User Time Entries API Response: ${response.status} ${response.statusText}`);\n            if (!response.ok) {\n                const errorText = await response.text().catch(()=>\"Unknown error\");\n                console.error(`Clockify User Time Entries API error response body: ${errorText}`);\n                throw new Error(`Clockify User Time Entries API error: ${response.status} ${response.statusText} - ${errorText}`);\n            }\n            const data = await response.json();\n            console.info(`âœ… Clockify User Time Entries API Success (Fallback): /workspaces/${this.workspaceId}/user/${user.id}/time-entries`);\n            console.info(`   Retrieved ${data?.length || 0} time entries via fallback method`);\n            // Transform the data to match our expected format\n            if (Array.isArray(data)) {\n                return data.map((entry, index)=>{\n                    try {\n                        // Handle duration conversion - User API might also return duration as number\n                        let duration = \"PT0H0M\";\n                        // First try to use the duration field if it's valid\n                        if (entry.duration !== undefined && entry.duration !== null) {\n                            if (typeof entry.duration === \"number\" && entry.duration > 0) {\n                                // Convert seconds to ISO 8601 duration format\n                                const hours = Math.floor(entry.duration / 3600);\n                                const minutes = Math.floor(entry.duration % 3600 / 60);\n                                duration = `PT${hours}H${minutes}M`;\n                            } else if (typeof entry.duration === \"string\" && entry.duration !== \"PT0H0M\") {\n                                // If it's already a string and not zero, use it directly\n                                duration = entry.duration;\n                            }\n                        }\n                        // If duration is still zero, calculate it from start and end times\n                        if (duration === \"PT0H0M\" && entry.timeInterval?.start && entry.timeInterval?.end) {\n                            try {\n                                const startTime = new Date(entry.timeInterval.start);\n                                const endTime = new Date(entry.timeInterval.end);\n                                if (!isNaN(startTime.getTime()) && !isNaN(endTime.getTime()) && endTime > startTime) {\n                                    const diffMs = endTime.getTime() - startTime.getTime();\n                                    const diffHours = diffMs / (1000 * 60 * 60);\n                                    const hours = Math.floor(diffHours);\n                                    const minutes = Math.floor((diffHours - hours) * 60);\n                                    duration = `PT${hours}H${minutes}M`;\n                                }\n                            } catch (timeError) {\n                                console.warn(`âš ï¸ Error calculating duration from start/end times for fallback entry ${index}:`, timeError);\n                            }\n                        }\n                        // Handle undefined IDs - generate a fallback ID if needed\n                        const entryId = entry.id || `user-entry-${index}-${Date.now()}`;\n                        // Log sample entry for debugging (first few entries)\n                        if (index < 3) {\n                            console.info(`ðŸ“ Fallback entry ${index}:`, {\n                                id: entryId,\n                                duration: entry.duration,\n                                convertedDuration: duration,\n                                projectId: entry.projectId,\n                                userId: entry.userId\n                            });\n                        }\n                        return {\n                            id: entryId,\n                            description: entry.description || \"No description\",\n                            timeInterval: {\n                                start: entry.timeInterval?.start || entry.start,\n                                end: entry.timeInterval?.end || entry.end,\n                                duration: duration\n                            },\n                            billable: entry.billable || false,\n                            userId: entry.userId || \"unknown-user\",\n                            userName: entry.userName || \"Unknown User\",\n                            projectId: entry.projectId || \"unknown-project\",\n                            projectName: entry.projectName || \"Unknown Project\",\n                            hourlyRate: entry.hourlyRate || 0\n                        };\n                    } catch (entryError) {\n                        console.error(`âŒ Error processing fallback time entry ${index}:`, entryError);\n                        console.error(`   Raw entry data:`, entry);\n                        // Return a safe fallback entry\n                        return {\n                            id: `error-fallback-${index}-${Date.now()}`,\n                            description: \"Error processing fallback entry\",\n                            timeInterval: {\n                                start: startDate,\n                                end: endDate,\n                                duration: \"PT0H0M\"\n                            },\n                            billable: false,\n                            userId: \"error-user\",\n                            userName: \"Error User\",\n                            projectId: \"error-project\",\n                            projectName: \"Error Project\",\n                            hourlyRate: 0\n                        };\n                    }\n                }).filter((entry)=>entry !== null); // Remove any null entries\n            }\n            return [];\n        } catch (error) {\n            console.error(\"Failed to get time entries via user endpoint (fallback):\", error);\n            throw error;\n        }\n    }\n    async getProjectTimeReport(projectId, startDate, endDate) {\n        try {\n            if (!this.workspaceId) {\n                throw new Error(\"Workspace ID not configured\");\n            }\n            const timeEntries = await this.getTimeEntries(projectId, startDate, endDate);\n            const project = await this.getProjects().then((projects)=>projects.find((p)=>p.id === projectId));\n            if (!project) {\n                throw new Error(\"Project not found\");\n            }\n            const totalHours = timeEntries.reduce((sum, entry)=>{\n                const duration = entry.timeInterval.duration;\n                const hours = this.parseDuration(duration);\n                return sum + hours;\n            }, 0);\n            const billableHours = timeEntries.filter((entry)=>entry.billable).reduce((sum, entry)=>{\n                const duration = entry.timeInterval.duration;\n                const hours = this.parseDuration(duration);\n                return sum + hours;\n            }, 0);\n            const nonBillableHours = totalHours - billableHours;\n            return {\n                projectId,\n                projectName: project.name,\n                totalHours,\n                billableHours,\n                nonBillableHours,\n                totalAmount: totalHours * (typeof project.hourlyRate === \"object\" ? project.hourlyRate.amount : project.hourlyRate || 0),\n                billableAmount: billableHours * (typeof project.hourlyRate === \"object\" ? project.hourlyRate.amount : project.hourlyRate || 0),\n                nonBillableAmount: nonBillableHours * (typeof project.hourlyRate === \"object\" ? project.hourlyRate.amount : project.hourlyRate || 0),\n                entries: timeEntries,\n                period: {\n                    start: startDate,\n                    end: endDate\n                }\n            };\n        } catch (error) {\n            console.error(\"Failed to get project time report:\", error);\n            return null;\n        }\n    }\n    async getAllProjectsTimeSummary(startDate, endDate) {\n        try {\n            if (!this.workspaceId) {\n                throw new Error(\"Workspace ID not configured\");\n            }\n            const projects = await this.getProjects();\n            const reports = [];\n            for (const project of projects){\n                const report = await this.getProjectTimeReport(project.id, startDate, endDate);\n                if (report) {\n                    reports.push(report);\n                }\n            }\n            return reports;\n        } catch (error) {\n            console.error(\"Failed to get all projects time summary:\", error);\n            return [];\n        }\n    }\n    // Helper method to parse ISO 8601 duration to hours\n    parseDuration(duration) {\n        const match = duration.match(/PT(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+)S)?/);\n        if (!match) return 0;\n        const hours = parseInt(match[1] || \"0\");\n        const minutes = parseInt(match[2] || \"0\");\n        const seconds = parseInt(match[3] || \"0\");\n        return hours + minutes / 60 + seconds / 3600;\n    }\n    // Enhanced method to generate mock time entries\n    getMockTimeEntries(projectId, startDate, endDate) {\n        return [\n            {\n                id: `mock-${projectId}-1`,\n                description: \"Mock project work\",\n                timeInterval: {\n                    start: startDate,\n                    end: endDate,\n                    duration: \"PT8H0M\"\n                },\n                billable: true,\n                userId: \"mock-user-id\",\n                userName: \"Mock User\",\n                projectId: projectId,\n                projectName: \"Mock Project\"\n            }\n        ];\n    }\n    // Enhanced method to generate mock projects\n    getMockProjects() {\n        return [\n            {\n                id: \"mock-project-1\",\n                name: \"Mock Project 1\",\n                workspaceId: \"mock-workspace\",\n                clientId: \"mock-client-1\",\n                clientName: \"Mock Client 1\",\n                isPublic: true,\n                isTemplate: false,\n                color: \"#000000\",\n                billable: true,\n                public: true,\n                archived: false,\n                status: \"ACTIVE\",\n                budget: 50000,\n                hourlyRate: {\n                    amount: 150,\n                    currency: \"USD\"\n                }\n            }\n        ];\n    }\n    // Enhanced method to generate mock user\n    getMockUser() {\n        return {\n            id: \"mock-user-id\",\n            email: \"mock@example.com\",\n            name: \"Mock User\",\n            profilePicture: \"\",\n            status: \"ACTIVE\",\n            activeWorkspace: \"mock-workspace\",\n            defaultWorkspace: \"mock-workspace\"\n        };\n    }\n    // Data Import Methods - NEW: Import time entries to database\n    async importTimeEntries(startDate, endDate) {\n        try {\n            console.log(\"\\uD83D\\uDD04 Starting Clockify time entries import...\");\n            console.log(`ðŸ“… Date range: ${startDate} to ${endDate}`);\n            // Get all time entries for the date range\n            const timeEntries = await this.getTimeEntries(\"\", startDate, endDate);\n            console.log(`ðŸ“Š Found ${timeEntries.length} time entries to process`);\n            if (timeEntries.length === 0) {\n                console.log(\"âš ï¸ No time entries found for the specified date range\");\n                return {\n                    success: true,\n                    recordsImported: 0,\n                    errors: [],\n                    summary: {\n                        totalEntries: 0,\n                        billableHours: 0,\n                        nonBillableHours: 0,\n                        totalCost: 0\n                    }\n                };\n            }\n            // Get projects and users for mapping\n            const [projects, users] = await Promise.all([\n                this.getProjects(),\n                this.getWorkspaces().then((workspaces)=>workspaces.length > 0 ? this.getUsers(workspaces[0].id) : [])\n            ]);\n            console.log(`ðŸ“‹ Retrieved ${projects.length} projects and ${users.length} users for mapping`);\n            let recordsImported = 0;\n            const errors = [];\n            let totalBillableHours = 0;\n            let totalNonBillableHours = 0;\n            let totalCost = 0;\n            // Process each time entry\n            for (const entry of timeEntries){\n                try {\n                    // Find user and project details\n                    const user = users.find((u)=>u.id === entry.userId);\n                    const project = projects.find((p)=>p.id === entry.projectId);\n                    if (!user || !project) {\n                        const errorMsg = `Missing user (${entry.userId}) or project (${entry.projectId}) for entry ${entry.id}`;\n                        console.warn(`âš ï¸ ${errorMsg}`);\n                        errors.push(errorMsg);\n                        continue;\n                    }\n                    // Parse duration to hours\n                    const hours = this.parseDuration(entry.timeInterval.duration);\n                    const billableHours = entry.billable ? hours : 0;\n                    const nonBillableHours = entry.billable ? 0 : hours;\n                    // Calculate costs (using project hourly rate if available)\n                    const hourlyRate = typeof project.hourlyRate === \"object\" ? project.hourlyRate.amount : project.hourlyRate || 0;\n                    const totalCostForEntry = hours * hourlyRate;\n                    // Update totals\n                    totalBillableHours += billableHours;\n                    totalNonBillableHours += nonBillableHours;\n                    totalCost += totalCostForEntry;\n                    // Log successful processing\n                    console.log(`âœ… Processed entry: ${user.name} - ${project.name} - ${hours.toFixed(2)}h (${entry.billable ? \"Billable\" : \"Non-billable\"})`);\n                    recordsImported++;\n                } catch (entryError) {\n                    const errorMsg = `Error processing entry ${entry.id}: ${entryError}`;\n                    console.error(`âŒ ${errorMsg}`);\n                    errors.push(errorMsg);\n                }\n            }\n            const summary = {\n                totalEntries: timeEntries.length,\n                billableHours: totalBillableHours,\n                nonBillableHours: totalNonBillableHours,\n                totalCost: totalCost\n            };\n            console.log(`ðŸ“Š Import completed: ${recordsImported}/${timeEntries.length} entries processed successfully`);\n            console.log(`ðŸ’° Summary: ${totalBillableHours.toFixed(2)} billable hours, ${totalNonBillableHours.toFixed(2)} non-billable hours, $${totalCost.toFixed(2)} total cost`);\n            if (errors.length > 0) {\n                console.warn(`âš ï¸ ${errors.length} errors encountered during import`);\n            }\n            return {\n                success: recordsImported > 0,\n                recordsImported,\n                errors,\n                summary\n            };\n        } catch (error) {\n            console.error(\"âŒ Clockify time entries import failed:\", error);\n            return {\n                success: false,\n                recordsImported: 0,\n                errors: [\n                    error instanceof Error ? error.message : \"Unknown error\"\n                ],\n                summary: {\n                    totalEntries: 0,\n                    billableHours: 0,\n                    nonBillableHours: 0,\n                    totalCost: 0\n                }\n            };\n        }\n    }\n    // Enhanced method to get users for a workspace\n    async getUsers(workspaceId) {\n        try {\n            if (!this.apiKey) {\n                throw new Error(\"API key not configured\");\n            }\n            const url = `${this.baseUrl}/workspaces/${workspaceId}/users`;\n            console.info(`ðŸ” Clockify Users API Request: ${url}`);\n            const response = await fetch(url, {\n                method: \"GET\",\n                headers: this.getHeaders()\n            });\n            if (!response.ok) {\n                throw new Error(`Clockify API error: ${response.status} ${response.statusText}`);\n            }\n            const users = await response.json();\n            console.info(`âœ… Retrieved ${users.length} users from workspace ${workspaceId}`);\n            return users;\n        } catch (error) {\n            console.error(\"Failed to get users:\", error);\n            // Return mock users as fallback\n            return [\n                this.getMockUser()\n            ];\n        }\n    }\n}\n// Create the service instance\nconst clockifyService = new ClockifyService();\n// Export the service instance as both default and named export\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (clockifyService);\n\n// Export convenience functions\nconst fetchClockifyProjects = async ()=>{\n    try {\n        return await clockifyService.getProjects();\n    } catch (error) {\n        console.error(\"Error fetching Clockify projects:\", error);\n        return [];\n    }\n};\nconst fetchClockifyTimeEntries = async (projectId, startDate, endDate)=>{\n    try {\n        return await clockifyService.getTimeEntries(projectId, startDate || \"\", endDate || \"\");\n    } catch (error) {\n        console.error(\"Error fetching Clockify time entries:\", error);\n        return [];\n    }\n};\nconst fetchClockifyTimeReport = async (projectId, startDate, endDate)=>{\n    try {\n        return await clockifyService.getProjectTimeReport(projectId, startDate, endDate);\n    } catch (error) {\n        console.error(\"Error fetching Clockify time report:\", error);\n        return null;\n    }\n};\nconst fetchAllClockifyTimeSummaries = async (startDate, endDate)=>{\n    try {\n        return await clockifyService.getAllProjectsTimeSummary(startDate, endDate);\n    } catch (error) {\n        console.error(\"Error fetching Clockify time summaries:\", error);\n        return [];\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ3BFLEVBQUUsT0FBTzVCLE9BQU87UUFDZDVCLFFBQVE0QixLQUFLLENBQUMsMkNBQTJDQTtRQUN6RCxPQUFPLEVBQUU7SUFDWDtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly96b2hvLWJpbGxpbmctcGxhdGZvcm0vLi9saWIvY2xvY2tpZnkudHM/OTBmYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDbG9ja2lmeVRpbWVFbnRyeSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIHVzZXJJZDogc3RyaW5nO1xyXG4gIGJpbGxhYmxlOiBib29sZWFuO1xyXG4gIHRhc2tJZD86IHN0cmluZztcclxuICBwcm9qZWN0SWQ6IHN0cmluZztcclxuICB0aW1lSW50ZXJ2YWw6IHtcclxuICAgIHN0YXJ0OiBzdHJpbmc7XHJcbiAgICBlbmQ/OiBzdHJpbmc7XHJcbiAgICBkdXJhdGlvbjogc3RyaW5nO1xyXG4gIH07XHJcbiAgaG91cmx5UmF0ZT86IHtcclxuICAgIGFtb3VudDogbnVtYmVyO1xyXG4gICAgY3VycmVuY3k6IHN0cmluZztcclxuICB9O1xyXG4gIGNvc3RSYXRlPzoge1xyXG4gICAgYW1vdW50OiBudW1iZXI7XHJcbiAgICBjdXJyZW5jeTogc3RyaW5nO1xyXG4gIH07XHJcbiAgaXNMb2NrZWQ6IGJvb2xlYW47XHJcbiAgY3VzdG9tRmllbGRWYWx1ZXM6IGFueVtdO1xyXG4gIHR5cGU6IHN0cmluZztcclxuICB0YWdzOiBhbnlbXTtcclxuICAvLyBBZGRpdGlvbmFsIHByb3BlcnRpZXMgYWRkZWQgZHVyaW5nIGRhdGEgcHJvY2Vzc2luZ1xyXG4gIHVzZXJOYW1lPzogc3RyaW5nO1xyXG4gIHByb2plY3ROYW1lPzogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENsb2NraWZ5UHJvamVjdCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgd29ya3NwYWNlSWQ6IHN0cmluZztcclxuICBjbGllbnRJZD86IHN0cmluZztcclxuICBjbGllbnROYW1lPzogc3RyaW5nO1xyXG4gIGlzUHVibGljOiBib29sZWFuO1xyXG4gIGlzVGVtcGxhdGU6IGJvb2xlYW47XHJcbiAgY29sb3I6IHN0cmluZztcclxuICBub3RlPzogc3RyaW5nO1xyXG4gIGJpbGxhYmxlOiBib29sZWFuO1xyXG4gIHB1YmxpYzogYm9vbGVhbjtcclxuICBhcmNoaXZlZDogYm9vbGVhbjtcclxuICBlc3RpbWF0ZToge1xyXG4gICAgZXN0aW1hdGU6IHN0cmluZztcclxuICAgIHR5cGU6IHN0cmluZztcclxuICB9O1xyXG4gIHN0YXR1czogc3RyaW5nO1xyXG4gIGR1cmF0aW9uOiBzdHJpbmc7XHJcbiAgYnVkZ2V0RXN0aW1hdGU6IG51bWJlcjtcclxuICBidWRnZXRUeXBlOiBzdHJpbmc7XHJcbiAgaG91cmx5UmF0ZToge1xyXG4gICAgYW1vdW50OiBudW1iZXI7XHJcbiAgICBjdXJyZW5jeTogc3RyaW5nO1xyXG4gIH07XHJcbiAgY29zdFJhdGU6IHtcclxuICAgIGFtb3VudDogbnVtYmVyO1xyXG4gICAgY3VycmVuY3k6IHN0cmluZztcclxuICB9O1xyXG4gIHRpbWVFc3RpbWF0ZTogc3RyaW5nO1xyXG4gIGJ1ZGdldDogbnVtYmVyO1xyXG4gIHNwZW50OiBzdHJpbmc7XHJcbiAgcHJvZ3Jlc3M6IG51bWJlcjtcclxuICByYXRlOiBudW1iZXI7XHJcbiAgcmF0ZUxhc3RVcGRhdGVkOiBzdHJpbmc7XHJcbiAgZml4ZWRGZWU6IG51bWJlcjtcclxuICBtZW1iZXJzaGlwczogYW55W107XHJcbiAgdGFza0NvdW50OiB7XHJcbiAgICB0b3RhbDogbnVtYmVyO1xyXG4gICAgZXN0aW1hdGU6IG51bWJlcjtcclxuICB9O1xyXG4gIGN1c3RvbUZpZWxkczogYW55W107XHJcbiAgc3RhcnREYXRlOiBzdHJpbmc7XHJcbiAgZW5kRGF0ZT86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDbG9ja2lmeVVzZXIge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgZW1haWw6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgcHJvZmlsZVBpY3R1cmU6IHN0cmluZztcclxuICBzdGF0dXM6IHN0cmluZztcclxuICBhY3RpdmVXb3Jrc3BhY2U6IHN0cmluZztcclxuICBkZWZhdWx0V29ya3NwYWNlOiBzdHJpbmc7XHJcbiAgc2V0dGluZ3M6IGFueTtcclxuICBtZW1iZXJzaGlwczogYW55W107XHJcbiAgcHJvZmlsZVBpY3R1cmVVcmw6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDbG9ja2lmeVdvcmtzcGFjZSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgcHJvZmlsZTogbnVtYmVyO1xyXG4gIHByZW1pdW06IGJvb2xlYW47XHJcbiAgYWRtaW46IGJvb2xlYW47XHJcbiAgZGVmYXVsdEhvdXJseVJhdGU6IG51bWJlcjtcclxuICBkZWZhdWx0Q3VycmVuY3k6IHN0cmluZztcclxuICBvbmx5QWRtaW5zTWF5Q3JlYXRlUHJvamVjdHM6IGJvb2xlYW47XHJcbiAgb25seUFkbWluc1NlZUJpbGxhYmxlUmF0ZXM6IGJvb2xlYW47XHJcbiAgb25seUFkbWluc1NlZVRlYW1EYXNoYm9hcmQ6IGJvb2xlYW47XHJcbiAgcHJvamVjdHNCaWxsYWJsZUJ5RGVmYXVsdDogYm9vbGVhbjtcclxuICByb3VuZGluZzogbnVtYmVyO1xyXG4gIHJvdW5kaW5nTWludXRlczogbnVtYmVyO1xyXG4gIGxvZ286IHN0cmluZztcclxuICBpY2FsVXJsOiBzdHJpbmc7XHJcbiAgaWNhbEVuYWJsZWQ6IGJvb2xlYW47XHJcbiAgY3N2VXBsb2FkOiB7XHJcbiAgICBlbmFibGVkOiBib29sZWFuO1xyXG4gICAgZGF0ZUZvcm1hdDogc3RyaW5nO1xyXG4gICAgdGltZUZvcm1hdDogc3RyaW5nO1xyXG4gIH07XHJcbiAgc3Vic2NyaXB0aW9uOiB7XHJcbiAgICBzdGFydERhdGU6IHN0cmluZztcclxuICAgIGVuZERhdGU6IHN0cmluZztcclxuICAgIHRyaWFsOiBib29sZWFuO1xyXG4gICAgc3RhdHVzOiBzdHJpbmc7XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDbG9ja2lmeVRpbWVSZXBvcnQge1xyXG4gIHByb2plY3RJZDogc3RyaW5nO1xyXG4gIHByb2plY3ROYW1lOiBzdHJpbmc7XHJcbiAgdG90YWxIb3VyczogbnVtYmVyO1xyXG4gIGJpbGxhYmxlSG91cnM6IG51bWJlcjtcclxuICBub25CaWxsYWJsZUhvdXJzOiBudW1iZXI7XHJcbiAgdG90YWxBbW91bnQ6IG51bWJlcjtcclxuICBiaWxsYWJsZUFtb3VudDogbnVtYmVyO1xyXG4gIG5vbkJpbGxhYmxlQW1vdW50OiBudW1iZXI7XHJcbiAgZW50cmllczogQ2xvY2tpZnlUaW1lRW50cnlbXTtcclxuICBwZXJpb2Q6IHtcclxuICAgIHN0YXJ0OiBzdHJpbmc7XHJcbiAgICBlbmQ6IHN0cmluZztcclxuICB9O1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVG9rZW5SZXNwb25zZSB7XHJcbiAgYWNjZXNzX3Rva2VuOiBzdHJpbmc7XHJcbiAgZXhwaXJlc19pbjogbnVtYmVyO1xyXG4gIHRva2VuX3R5cGU6IHN0cmluZztcclxufVxyXG5cclxuY2xhc3MgQ2xvY2tpZnlTZXJ2aWNlIHtcclxuICBwcml2YXRlIGFwaUtleTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSB3b3Jrc3BhY2VJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBiYXNlVXJsID0gJ2h0dHBzOi8vYXBpLmNsb2NraWZ5Lm1lL2FwaS92MSc7XHJcbiAgcHJpdmF0ZSByZXBvcnRzQmFzZVVybCA9ICdodHRwczovL3JlcG9ydHMuYXBpLmNsb2NraWZ5Lm1lL3YxJzsgLy8gQ29ycmVjdCBSZXBvcnRzIEFQSSBiYXNlIFVSTFxyXG4gIHByaXZhdGUgX2lzQ29uZmlndXJlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuYXBpS2V5ID0gcHJvY2Vzcy5lbnYuQ0xPQ0tJRllfQVBJX0tFWSB8fCBudWxsO1xyXG4gICAgdGhpcy53b3Jrc3BhY2VJZCA9IHByb2Nlc3MuZW52LkNMT0NLSUZZX1dPUktTUEFDRV9JRCB8fCBudWxsO1xyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIHZhbGlkIGNyZWRlbnRpYWxzXHJcbiAgICBpZiAodGhpcy5hcGlLZXkgJiYgdGhpcy5hcGlLZXkgIT09ICd5b3VyX2Nsb2NraWZ5X2FwaV9rZXlfaGVyZScgJiYgdGhpcy53b3Jrc3BhY2VJZCAmJiB0aGlzLndvcmtzcGFjZUlkICE9PSAneW91cl9jbG9ja2lmeV93b3Jrc3BhY2VfaWRfaGVyZScpIHtcclxuICAgICAgdGhpcy5faXNDb25maWd1cmVkID0gdHJ1ZTtcclxuICAgICAgY29uc29sZS5pbmZvKCdDbG9ja2lmeSBzZXJ2aWNlIGluaXRpYWxpemVkIHdpdGggdmFsaWQgY3JlZGVudGlhbHMnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2lzQ29uZmlndXJlZCA9IGZhbHNlO1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0Nsb2NraWZ5IHNlcnZpY2UgaW5pdGlhbGl6ZWQgd2l0aG91dCB2YWxpZCBjcmVkZW50aWFscyAtIHdpbGwgdXNlIG1vY2sgZGF0YScpO1xyXG4gICAgICBjb25zb2xlLndhcm4oJ1BsZWFzZSBzZXQgQ0xPQ0tJRllfQVBJX0tFWSBhbmQgQ0xPQ0tJRllfV09SS1NQQUNFX0lEIGluIHlvdXIgZW52aXJvbm1lbnQgdmFyaWFibGVzJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldEhlYWRlcnMoKSB7XHJcbiAgICBpZiAoIXRoaXMuYXBpS2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2xvY2tpZnkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgJ1gtQXBpLUtleSc6IHRoaXMuYXBpS2V5LFxyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgbWFrZVJlcXVlc3QoZW5kcG9pbnQ6IHN0cmluZywgcGFyYW1zPzogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgIGlmICghdGhpcy5faXNDb25maWd1cmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2xvY2tpZnkgc2VydmljZSBub3QgcHJvcGVybHkgY29uZmlndXJlZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7dGhpcy5iYXNlVXJsfSR7ZW5kcG9pbnR9YCk7XHJcbiAgICAgIGlmIChwYXJhbXMpIHtcclxuICAgICAgICBPYmplY3Qua2V5cyhwYXJhbXMpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgIGlmIChwYXJhbXNba2V5XSAhPT0gdW5kZWZpbmVkICYmIHBhcmFtc1trZXldICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKGtleSwgcGFyYW1zW2tleV0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhg8J+UjSBDbG9ja2lmeSBBUEkgUmVxdWVzdDogJHt1cmwudG9TdHJpbmcoKX1gKTtcclxuICAgICAgY29uc29sZS5sb2coYCAgIEhlYWRlcnM6ICR7SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRIZWFkZXJzKCkpfWApO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwudG9TdHJpbmcoKSwge1xyXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5nZXRIZWFkZXJzKCksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYPCfk6EgQ2xvY2tpZnkgQVBJIFJlc3BvbnNlOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xyXG5cclxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDbG9ja2lmeSBBUEkgYXV0aGVudGljYXRpb24gZmFpbGVkIC0gY2hlY2sgeW91ciBBUEkga2V5Jyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2xvY2tpZnkgQVBJIGFjY2VzcyBmb3JiaWRkZW4gLSBjaGVjayB5b3VyIHdvcmtzcGFjZSBJRCBhbmQgcGVybWlzc2lvbnMnKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JEZXRhaWxzID0gYEVuZHBvaW50IG5vdCBmb3VuZDogJHtlbmRwb2ludH1gO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCA0MDQgRXJyb3IgRGV0YWlsczogJHtlcnJvckRldGFpbHN9YCk7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgICAgRnVsbCBVUkw6ICR7dXJsLnRvU3RyaW5nKCl9YCk7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgICAgV29ya3NwYWNlIElEOiAke3RoaXMud29ya3NwYWNlSWR9YCk7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgICAgQVBJIEtleSBjb25maWd1cmVkOiAkeyEhdGhpcy5hcGlLZXl9YCk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBBUEkgZXJyb3I6IDQwNCBOb3QgRm91bmQgLSAke2Vycm9yRGV0YWlsc31gKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDI5KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDbG9ja2lmeSBBUEkgcmF0ZSBsaW1pdCBleGNlZWRlZCAtIHRyeSBhZ2FpbiBsYXRlcicpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpLmNhdGNoKCgpID0+ICdVbmtub3duIGVycm9yJyk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9IC0gJHtlcnJvclRleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgQ2xvY2tpZnkgQVBJIFN1Y2Nlc3M6ICR7ZW5kcG9pbnR9YCk7XHJcbiAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgQ2xvY2tpZnkgQVBJIEVycm9yIGluICR7ZW5kcG9pbnR9OmAsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICB9XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2xvY2tpZnkgQVBJIHJlcXVlc3QgZmFpbGVkOiAke2Vycm9yfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQ2hlY2sgaWYgdGhlIHNlcnZpY2UgaXMgcHJvcGVybHkgY29uZmlndXJlZFxyXG4gIHB1YmxpYyBpc0NvbmZpZ3VyZWQoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNDb25maWd1cmVkO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IGNvbmZpZ3VyYXRpb24gc3RhdHVzIGZvciBkZWJ1Z2dpbmdcclxuICBwdWJsaWMgZ2V0Q29uZmlndXJhdGlvblN0YXR1cygpOiB7IGNvbmZpZ3VyZWQ6IGJvb2xlYW47IGhhc0FwaUtleTogYm9vbGVhbjsgaGFzV29ya3NwYWNlSWQ6IGJvb2xlYW4gfSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjb25maWd1cmVkOiB0aGlzLl9pc0NvbmZpZ3VyZWQsXHJcbiAgICAgIGhhc0FwaUtleTogISEodGhpcy5hcGlLZXkgJiYgdGhpcy5hcGlLZXkgIT09ICd5b3VyX2Nsb2NraWZ5X2FwaV9rZXlfaGVyZScpLFxyXG4gICAgICBoYXNXb3Jrc3BhY2VJZDogISEodGhpcy53b3Jrc3BhY2VJZCAmJiB0aGlzLndvcmtzcGFjZUlkICE9PSAneW91cl9jbG9ja2lmeV93b3Jrc3BhY2VfaWRfaGVyZScpXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gQWxpYXMgZm9yIGdldENvbmZpZ3VyYXRpb25TdGF0dXMgdG8gbWF0Y2ggQVBJIHVzYWdlXHJcbiAgcHVibGljIGdldENvbmZpZ1N0YXR1cygpOiB7IGNvbmZpZ3VyZWQ6IGJvb2xlYW47IGhhc0FwaUtleTogYm9vbGVhbjsgaGFzV29ya3NwYWNlSWQ6IGJvb2xlYW4gfSB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRDb25maWd1cmF0aW9uU3RhdHVzKCk7XHJcbiAgfVxyXG5cclxuICAvLyBNZXRob2QgdG8gc2V0IHdvcmtzcGFjZSBJRCBkeW5hbWljYWxseVxyXG4gIHB1YmxpYyBzZXRXb3Jrc3BhY2VJZCh3b3Jrc3BhY2VJZDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0aGlzLndvcmtzcGFjZUlkID0gd29ya3NwYWNlSWQ7XHJcbiAgICBpZiAodGhpcy5hcGlLZXkgJiYgdGhpcy5hcGlLZXkgIT09ICd5b3VyX2Nsb2NraWZ5X2FwaV9rZXlfaGVyZScpIHtcclxuICAgICAgdGhpcy5faXNDb25maWd1cmVkID0gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFVzZXIoKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICghdGhpcy5faXNDb25maWd1cmVkKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0Nsb2NraWZ5IG5vdCBjb25maWd1cmVkLCByZXR1cm5pbmcgbW9jayB1c2VyJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TW9ja1VzZXIoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChgJHt0aGlzLmJhc2VVcmx9L3VzZXJgKTtcclxuICAgICAgY29uc29sZS5sb2coYPCflI0gQ2xvY2tpZnkgQVBJIFJlcXVlc3Q6ICR7dXJsLnRvU3RyaW5nKCl9YCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybC50b1N0cmluZygpLCB7XHJcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLmdldEhlYWRlcnMoKSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgQ2xvY2tpZnkgQVBJIFN1Y2Nlc3M6IC91c2VyYCk7XHJcbiAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBDbG9ja2lmeSB1c2VyOicsIGVycm9yKTtcclxuICAgICAgY29uc29sZS5sb2coJ1JldHVybmluZyBtb2NrIHVzZXIgZHVlIHRvIENsb2NraWZ5IEFQSSBmYWlsdXJlJyk7XHJcbiAgICAgIHJldHVybiB0aGlzLmdldE1vY2tVc2VyKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRXb3Jrc3BhY2VzKCk6IFByb21pc2U8YW55W10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCcvd29ya3NwYWNlcycpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBDbG9ja2lmeSB3b3Jrc3BhY2VzOicsIGVycm9yKTtcclxuICAgICAgLy8gUmV0dXJuIG1vY2sgd29ya3NwYWNlIGRhdGEgd2hlbiBDbG9ja2lmeSBmYWlsc1xyXG4gICAgICByZXR1cm4gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiAnbW9jay13b3Jrc3BhY2UtaWQnLFxyXG4gICAgICAgICAgbmFtZTogJ01vY2sgV29ya3NwYWNlJyxcclxuICAgICAgICAgIGhvdXJseVJhdGU6IHsgYW1vdW50OiAxMDAsIGN1cnJlbmN5OiAnVVNEJyB9XHJcbiAgICAgICAgfVxyXG4gICAgICBdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0UHJvamVjdHMoKTogUHJvbWlzZTxhbnlbXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKCF0aGlzLl9pc0NvbmZpZ3VyZWQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnQ2xvY2tpZnkgbm90IGNvbmZpZ3VyZWQsIHJldHVybmluZyBtb2NrIHByb2plY3RzJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TW9ja1Byb2plY3RzKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghdGhpcy53b3Jrc3BhY2VJZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignV29ya3NwYWNlIElEIG5vdCBjb25maWd1cmVkJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7dGhpcy5iYXNlVXJsfS93b3Jrc3BhY2VzLyR7dGhpcy53b3Jrc3BhY2VJZH0vcHJvamVjdHNgKTtcclxuICAgICAgY29uc29sZS5sb2coYPCflI0gQ2xvY2tpZnkgQVBJIFJlcXVlc3Q6ICR7dXJsLnRvU3RyaW5nKCl9YCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybC50b1N0cmluZygpLCB7XHJcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLmdldEhlYWRlcnMoKSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgQ2xvY2tpZnkgQVBJIFN1Y2Nlc3M6IC93b3Jrc3BhY2VzLyR7dGhpcy53b3Jrc3BhY2VJZH0vcHJvamVjdHNgKTtcclxuICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IENsb2NraWZ5IHByb2plY3RzOicsIGVycm9yKTtcclxuICAgICAgY29uc29sZS5sb2coJ1JldHVybmluZyBtb2NrIHByb2plY3RzIGR1ZSB0byBDbG9ja2lmeSBBUEkgZmFpbHVyZScpO1xyXG4gICAgICByZXR1cm4gdGhpcy5nZXRNb2NrUHJvamVjdHMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFRpbWVFbnRyaWVzKHByb2plY3RJZDogc3RyaW5nLCBzdGFydERhdGU6IHN0cmluZywgZW5kRGF0ZTogc3RyaW5nKTogUHJvbWlzZTxhbnlbXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKCF0aGlzLl9pc0NvbmZpZ3VyZWQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnQ2xvY2tpZnkgbm90IGNvbmZpZ3VyZWQsIHJldHVybmluZyBtb2NrIGRhdGEnKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNb2NrVGltZUVudHJpZXMocHJvamVjdElkLCBzdGFydERhdGUsIGVuZERhdGUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXRoaXMud29ya3NwYWNlSWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dvcmtzcGFjZSBJRCBub3QgY29uZmlndXJlZCcpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGAke3RoaXMuYmFzZVVybH0vd29ya3NwYWNlcy8ke3RoaXMud29ya3NwYWNlSWR9L3Byb2plY3RzLyR7cHJvamVjdElkfS90aW1lLWVudHJpZXNgKTtcclxuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5hcHBlbmQoJ3N0YXJ0Jywgc3RhcnREYXRlKTtcclxuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5hcHBlbmQoJ2VuZCcsIGVuZERhdGUpO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYPCflI0gQ2xvY2tpZnkgQVBJIFJlcXVlc3Q6ICR7dXJsLnRvU3RyaW5nKCl9YCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybC50b1N0cmluZygpLCB7XHJcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLmdldEhlYWRlcnMoKSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgQ2xvY2tpZnkgQVBJIFN1Y2Nlc3M6IC93b3Jrc3BhY2VzLyR7dGhpcy53b3Jrc3BhY2VJZH0vcHJvamVjdHMvJHtwcm9qZWN0SWR9L3RpbWUtZW50cmllc2ApO1xyXG4gICAgICByZXR1cm4gZGF0YTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgQ2xvY2tpZnkgdGltZSBlbnRyaWVzOicsIGVycm9yKTtcclxuICAgICAgY29uc29sZS5sb2coJ1JldHVybmluZyBtb2NrIHRpbWUgZW50cnkgZGF0YSBkdWUgdG8gQ2xvY2tpZnkgQVBJIGZhaWx1cmUnKTtcclxuICAgICAgcmV0dXJuIHRoaXMuZ2V0TW9ja1RpbWVFbnRyaWVzKHByb2plY3RJZCwgc3RhcnREYXRlLCBlbmREYXRlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGdldEFsbFRpbWVFbnRyaWVzKHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIXRoaXMud29ya3NwYWNlSWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dvcmtzcGFjZSBJRCBub3QgY29uZmlndXJlZCcpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBGaXJzdCB0cnkgdGhlIFJlcG9ydHMgQVBJIGZvciBidWxrIHRpbWUgZW50cnkgZGF0YVxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbygn8J+UhCBBdHRlbXB0aW5nIHRvIGZldGNoIHRpbWUgZW50cmllcyB2aWEgQ2xvY2tpZnkgUmVwb3J0cyBBUEkgKHJlcXVpcmVzIFBybyBwbGFuKS4uLicpO1xyXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldFRpbWVFbnRyaWVzVmlhUmVwb3J0cyhzdGFydERhdGUsIGVuZERhdGUpO1xyXG4gICAgICB9IGNhdGNoIChyZXBvcnRzRXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBDbG9ja2lmeSBSZXBvcnRzIEFQSSBmYWlsZWQsIGZhbGxpbmcgYmFjayB0byB1c2VyIHRpbWUgZW50cmllcyBlbmRwb2ludDonLCB7XHJcbiAgICAgICAgICBlcnJvcjogcmVwb3J0c0Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyByZXBvcnRzRXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcclxuICAgICAgICAgIHJlYXNvbjogJ1JlcG9ydHMgQVBJIG1heSByZXF1aXJlIFBybyBwbGFuIG9yIG1heSBiZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZScsXHJcbiAgICAgICAgICBmYWxsYmFjazogJ1VzaW5nIHVzZXIgdGltZSBlbnRyaWVzIGVuZHBvaW50IGluc3RlYWQnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0VGltZUVudHJpZXNWaWFVc2VyRW5kcG9pbnQoc3RhcnREYXRlLCBlbmREYXRlKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBnZXQgYWxsIENsb2NraWZ5IHRpbWUgZW50cmllczonLCBlcnJvcik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBSZXR1cm4gbW9jayB0aW1lIGVudHJ5IGRhdGEgd2hlbiBDbG9ja2lmeSBmYWlsc1xyXG4gICAgICBjb25zb2xlLndhcm4oJ/Cfjq0gUmV0dXJuaW5nIG1vY2sgdGltZSBlbnRyeSBkYXRhIGR1ZSB0byBDbG9ja2lmeSBBUEkgZmFpbHVyZS4gQ2hlY2sgeW91ciBwbGFuIGxldmVsIGFuZCBBUEkgY29uZmlndXJhdGlvbi4nKTtcclxuICAgICAgcmV0dXJuIFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogJ21vY2stdGltZS1lbnRyeS0xJyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnTW9jayB3b3JrIHNlc3Npb24gKENsb2NraWZ5IEFQSSB1bmF2YWlsYWJsZSknLFxyXG4gICAgICAgICAgdGltZUludGVydmFsOiB7XHJcbiAgICAgICAgICAgIHN0YXJ0OiBzdGFydERhdGUsXHJcbiAgICAgICAgICAgIGVuZDogZW5kRGF0ZSxcclxuICAgICAgICAgICAgZHVyYXRpb246ICdQVDhIME0nXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYmlsbGFibGU6IHRydWUsXHJcbiAgICAgICAgICB1c2VySWQ6ICdtb2NrLXVzZXItaWQnLFxyXG4gICAgICAgICAgdXNlck5hbWU6ICdNb2NrIFVzZXInLFxyXG4gICAgICAgICAgcHJvamVjdElkOiAnbW9jay1wcm9qZWN0LTEnLFxyXG4gICAgICAgICAgcHJvamVjdE5hbWU6ICdNb2NrIFByb2plY3QgMSdcclxuICAgICAgICB9XHJcbiAgICAgIF07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBNZXRob2QgdG8gZ2V0IHRpbWUgZW50cmllcyB2aWEgUmVwb3J0cyBBUEkgKHByZWZlcnJlZCBtZXRob2QpXHJcbiAgcHJpdmF0ZSBhc3luYyBnZXRUaW1lRW50cmllc1ZpYVJlcG9ydHMoc3RhcnREYXRlOiBzdHJpbmcsIGVuZERhdGU6IHN0cmluZyk6IFByb21pc2U8YW55W10+IHtcclxuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7dGhpcy5yZXBvcnRzQmFzZVVybH0vd29ya3NwYWNlcy8ke3RoaXMud29ya3NwYWNlSWR9L3JlcG9ydHMvZGV0YWlsZWRgKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5pbmZvKGDwn5SNIENsb2NraWZ5IFJlcG9ydHMgQVBJIFJlcXVlc3Q6ICR7dXJsLnRvU3RyaW5nKCl9YCk7XHJcbiAgICBjb25zb2xlLmluZm8oYCAgIE1ldGhvZDogUE9TVCAoUmVwb3J0cyBBUEkpYCk7XHJcbiAgICBjb25zb2xlLmluZm8oYCAgIEhlYWRlcnM6ICR7SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRIZWFkZXJzKCkpfWApO1xyXG4gICAgY29uc29sZS5pbmZvKGAgICBCb2R5OiAke0pTT04uc3RyaW5naWZ5KHsgXHJcbiAgICAgIGRhdGVSYW5nZVN0YXJ0OiBzdGFydERhdGUsIFxyXG4gICAgICBkYXRlUmFuZ2VFbmQ6IGVuZERhdGUsXHJcbiAgICAgIGRldGFpbGVkRmlsdGVyOiB7XHJcbiAgICAgICAgcGFnZVNpemU6IDEwMDAsXHJcbiAgICAgICAgc29ydENvbHVtbjogXCJEQVRFXCJcclxuICAgICAgfVxyXG4gICAgfSl9YCk7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwudG9TdHJpbmcoKSwge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIC4uLnRoaXMuZ2V0SGVhZGVycygpLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBkYXRlUmFuZ2VTdGFydDogc3RhcnREYXRlLFxyXG4gICAgICAgIGRhdGVSYW5nZUVuZDogZW5kRGF0ZSxcclxuICAgICAgICBkZXRhaWxlZEZpbHRlcjoge1xyXG4gICAgICAgICAgcGFnZVNpemU6IDEwMDAsXHJcbiAgICAgICAgICBzb3J0Q29sdW1uOiBcIkRBVEVcIlxyXG4gICAgICAgIH1cclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmluZm8oYPCfk6EgQ2xvY2tpZnkgUmVwb3J0cyBBUEkgUmVzcG9uc2U6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcblxyXG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2xvY2tpZnkgQVBJIGF1dGhlbnRpY2F0aW9uIGZhaWxlZCAtIGNoZWNrIHlvdXIgQVBJIGtleScpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDbG9ja2lmeSBBUEkgYWNjZXNzIGZvcmJpZGRlbiAtIGNoZWNrIHlvdXIgd29ya3NwYWNlIElEIGFuZCBwZXJtaXNzaW9ucy4gTm90ZTogRGV0YWlsZWQgcmVwb3J0cyByZXF1aXJlIFBybyBwbGFuIG9yIGhpZ2hlci4nKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgIGNvbnN0IGVycm9yRGV0YWlscyA9IGBSZXBvcnRzIGVuZHBvaW50IG5vdCBmb3VuZDogL3dvcmtzcGFjZXMvJHt0aGlzLndvcmtzcGFjZUlkfS9yZXBvcnRzL2RldGFpbGVkYDtcclxuICAgICAgY29uc29sZS5lcnJvcihg4p2MIDQwNCBFcnJvciBEZXRhaWxzOiAke2Vycm9yRGV0YWlsc31gKTtcclxuICAgICAgY29uc29sZS5lcnJvcihgICAgRnVsbCBVUkw6ICR7dXJsLnRvU3RyaW5nKCl9YCk7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYCAgIFdvcmtzcGFjZSBJRDogJHt0aGlzLndvcmtzcGFjZUlkfWApO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGAgICBBUEkgS2V5IGNvbmZpZ3VyZWQ6ICR7ISF0aGlzLmFwaUtleX1gKTtcclxuICAgICAgY29uc29sZS5lcnJvcihgICAgTm90ZTogVGhpcyBlbmRwb2ludCByZXF1aXJlcyBDbG9ja2lmeSBQcm8gcGxhbiBvciBoaWdoZXIgZm9yIGRldGFpbGVkIHJlcG9ydHNgKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBBUEkgZXJyb3I6IDQwNCBOb3QgRm91bmQgLSAke2Vycm9yRGV0YWlsc30uIFRoaXMgZW5kcG9pbnQgcmVxdWlyZXMgUHJvIHBsYW4gb3IgaGlnaGVyLmApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDUpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDbG9ja2lmeSBBUEkgbWV0aG9kIG5vdCBhbGxvd2VkIC0gdGhpcyBlbmRwb2ludCByZXF1aXJlcyBQT1NUIG1ldGhvZCcpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MjkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDbG9ja2lmeSBBUEkgcmF0ZSBsaW1pdCBleGNlZWRlZCAtIHRyeSBhZ2FpbiBsYXRlcicpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKS5jYXRjaCgoKSA9PiAnVW5rbm93biBlcnJvcicpO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBDbG9ja2lmeSBSZXBvcnRzIEFQSSBlcnJvciByZXNwb25zZSBib2R5OiAke2Vycm9yVGV4dH1gKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9IC0gJHtlcnJvclRleHR9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgIGNvbnNvbGUuaW5mbyhg4pyFIENsb2NraWZ5IFJlcG9ydHMgQVBJIFN1Y2Nlc3M6IC93b3Jrc3BhY2VzLyR7dGhpcy53b3Jrc3BhY2VJZH0vcmVwb3J0cy9kZXRhaWxlZGApO1xyXG4gICAgXHJcbiAgICAvLyBUcmFuc2Zvcm0gdGhlIHJlcG9ydHMgZGF0YSB0byBtYXRjaCBvdXIgZXhwZWN0ZWQgdGltZSBlbnRyeSBmb3JtYXRcclxuICAgIGlmIChkYXRhLnRpbWVlbnRyaWVzICYmIEFycmF5LmlzQXJyYXkoZGF0YS50aW1lZW50cmllcykpIHtcclxuICAgICAgY29uc29sZS5pbmZvKGDwn5OKIFByb2Nlc3NpbmcgJHtkYXRhLnRpbWVlbnRyaWVzLmxlbmd0aH0gdGltZSBlbnRyaWVzIGZyb20gUmVwb3J0cyBBUElgKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiBkYXRhLnRpbWVlbnRyaWVzLm1hcCgoZW50cnk6IGFueSwgaW5kZXg6IG51bWJlcikgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBIYW5kbGUgZHVyYXRpb24gY29udmVyc2lvbiAtIFJlcG9ydHMgQVBJIHJldHVybnMgZHVyYXRpb24gaW4gc2Vjb25kcyBhcyBudW1iZXJcclxuICAgICAgICAgIGxldCBkdXJhdGlvbiA9ICdQVDBIME0nO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBGaXJzdCB0cnkgdG8gdXNlIHRoZSBkdXJhdGlvbiBmaWVsZCBpZiBpdCdzIHZhbGlkXHJcbiAgICAgICAgICBpZiAoZW50cnkuZHVyYXRpb24gIT09IHVuZGVmaW5lZCAmJiBlbnRyeS5kdXJhdGlvbiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGVudHJ5LmR1cmF0aW9uID09PSAnbnVtYmVyJyAmJiBlbnRyeS5kdXJhdGlvbiA+IDApIHtcclxuICAgICAgICAgICAgICAvLyBDb252ZXJ0IHNlY29uZHMgdG8gSVNPIDg2MDEgZHVyYXRpb24gZm9ybWF0XHJcbiAgICAgICAgICAgICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKGVudHJ5LmR1cmF0aW9uIC8gMzYwMCk7XHJcbiAgICAgICAgICAgICAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3IoKGVudHJ5LmR1cmF0aW9uICUgMzYwMCkgLyA2MCk7XHJcbiAgICAgICAgICAgICAgZHVyYXRpb24gPSBgUFQke2hvdXJzfUgke21pbnV0ZXN9TWA7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGVudHJ5LmR1cmF0aW9uID09PSAnc3RyaW5nJyAmJiBlbnRyeS5kdXJhdGlvbiAhPT0gJ1BUMEgwTScpIHtcclxuICAgICAgICAgICAgICAvLyBJZiBpdCdzIGFscmVhZHkgYSBzdHJpbmcgYW5kIG5vdCB6ZXJvLCB1c2UgaXQgZGlyZWN0bHlcclxuICAgICAgICAgICAgICBkdXJhdGlvbiA9IGVudHJ5LmR1cmF0aW9uO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIElmIGR1cmF0aW9uIGlzIHN0aWxsIHplcm8sIGNhbGN1bGF0ZSBpdCBmcm9tIHN0YXJ0IGFuZCBlbmQgdGltZXNcclxuICAgICAgICAgIGlmIChkdXJhdGlvbiA9PT0gJ1BUMEgwTScgJiYgZW50cnkudGltZUludGVydmFsPy5zdGFydCAmJiBlbnRyeS50aW1lSW50ZXJ2YWw/LmVuZCkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKGVudHJ5LnRpbWVJbnRlcnZhbC5zdGFydCk7XHJcbiAgICAgICAgICAgICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKGVudHJ5LnRpbWVJbnRlcnZhbC5lbmQpO1xyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIGlmICghaXNOYU4oc3RhcnRUaW1lLmdldFRpbWUoKSkgJiYgIWlzTmFOKGVuZFRpbWUuZ2V0VGltZSgpKSAmJiBlbmRUaW1lID4gc3RhcnRUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkaWZmTXMgPSBlbmRUaW1lLmdldFRpbWUoKSAtIHN0YXJ0VGltZS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkaWZmSG91cnMgPSBkaWZmTXMgLyAoMTAwMCAqIDYwICogNjApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKGRpZmZIb3Vycyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcigoZGlmZkhvdXJzIC0gaG91cnMpICogNjApO1xyXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSBgUFQke2hvdXJzfUgke21pbnV0ZXN9TWA7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGNhdGNoICh0aW1lRXJyb3IpIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYOKaoO+4jyBFcnJvciBjYWxjdWxhdGluZyBkdXJhdGlvbiBmcm9tIHN0YXJ0L2VuZCB0aW1lcyBmb3IgZW50cnkgJHtpbmRleH06YCwgdGltZUVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIEhhbmRsZSB1bmRlZmluZWQgSURzIC0gZ2VuZXJhdGUgYSBmYWxsYmFjayBJRCBpZiBuZWVkZWRcclxuICAgICAgICAgIGNvbnN0IGVudHJ5SWQgPSBlbnRyeS5pZCB8fCBgcmVwb3J0cy1lbnRyeS0ke2luZGV4fS0ke0RhdGUubm93KCl9YDtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gTG9nIHNhbXBsZSBlbnRyeSBmb3IgZGVidWdnaW5nIChmaXJzdCBmZXcgZW50cmllcylcclxuICAgICAgICAgIGlmIChpbmRleCA8IDMpIHtcclxuICAgICAgICAgICAgY29uc29sZS5pbmZvKGDwn5OdIFNhbXBsZSBlbnRyeSAke2luZGV4fTpgLCB7XHJcbiAgICAgICAgICAgICAgaWQ6IGVudHJ5SWQsXHJcbiAgICAgICAgICAgICAgZHVyYXRpb246IGVudHJ5LmR1cmF0aW9uLFxyXG4gICAgICAgICAgICAgIGNvbnZlcnRlZER1cmF0aW9uOiBkdXJhdGlvbixcclxuICAgICAgICAgICAgICBwcm9qZWN0SWQ6IGVudHJ5LnByb2plY3RJZCxcclxuICAgICAgICAgICAgICB1c2VySWQ6IGVudHJ5LnVzZXJJZFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZDogZW50cnlJZCxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGVudHJ5LmRlc2NyaXB0aW9uIHx8ICdObyBkZXNjcmlwdGlvbicsXHJcbiAgICAgICAgICAgIHRpbWVJbnRlcnZhbDoge1xyXG4gICAgICAgICAgICAgIHN0YXJ0OiBlbnRyeS50aW1lSW50ZXJ2YWw/LnN0YXJ0IHx8IGVudHJ5LnN0YXJ0LFxyXG4gICAgICAgICAgICAgIGVuZDogZW50cnkudGltZUludGVydmFsPy5lbmQgfHwgZW50cnkuZW5kLFxyXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBiaWxsYWJsZTogZW50cnkuYmlsbGFibGUgfHwgZmFsc2UsXHJcbiAgICAgICAgICAgIHVzZXJJZDogZW50cnkudXNlcklkIHx8ICd1bmtub3duLXVzZXInLFxyXG4gICAgICAgICAgICB1c2VyTmFtZTogZW50cnkudXNlck5hbWUgfHwgJ1Vua25vd24gVXNlcicsXHJcbiAgICAgICAgICAgIHByb2plY3RJZDogZW50cnkucHJvamVjdElkIHx8ICd1bmtub3duLXByb2plY3QnLFxyXG4gICAgICAgICAgICBwcm9qZWN0TmFtZTogZW50cnkucHJvamVjdE5hbWUgfHwgJ1Vua25vd24gUHJvamVjdCcsXHJcbiAgICAgICAgICAgIGhvdXJseVJhdGU6IGVudHJ5LmhvdXJseVJhdGUgfHwgMFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9IGNhdGNoIChlbnRyeUVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgRXJyb3IgcHJvY2Vzc2luZyB0aW1lIGVudHJ5ICR7aW5kZXh9OmAsIGVudHJ5RXJyb3IpO1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgICAgUmF3IGVudHJ5IGRhdGE6YCwgZW50cnkpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBSZXR1cm4gYSBzYWZlIGZhbGxiYWNrIGVudHJ5XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZDogYGVycm9yLWVudHJ5LSR7aW5kZXh9LSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0Vycm9yIHByb2Nlc3NpbmcgZW50cnknLFxyXG4gICAgICAgICAgICB0aW1lSW50ZXJ2YWw6IHtcclxuICAgICAgICAgICAgICBzdGFydDogc3RhcnREYXRlLFxyXG4gICAgICAgICAgICAgIGVuZDogZW5kRGF0ZSxcclxuICAgICAgICAgICAgICBkdXJhdGlvbjogJ1BUMEgwTSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYmlsbGFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICB1c2VySWQ6ICdlcnJvci11c2VyJyxcclxuICAgICAgICAgICAgdXNlck5hbWU6ICdFcnJvciBVc2VyJyxcclxuICAgICAgICAgICAgcHJvamVjdElkOiAnZXJyb3ItcHJvamVjdCcsXHJcbiAgICAgICAgICAgIHByb2plY3ROYW1lOiAnRXJyb3IgUHJvamVjdCcsXHJcbiAgICAgICAgICAgIGhvdXJseVJhdGU6IDBcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5maWx0ZXIoKGVudHJ5OiBhbnkpID0+IGVudHJ5ICE9PSBudWxsKTsgLy8gUmVtb3ZlIGFueSBudWxsIGVudHJpZXNcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS53YXJuKCfimqDvuI8gTm8gdGltZSBlbnRyaWVzIGZvdW5kIGluIFJlcG9ydHMgQVBJIHJlc3BvbnNlJyk7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG5cclxuICAvLyBGYWxsYmFjayBtZXRob2QgdG8gZ2V0IHRpbWUgZW50cmllcyB2aWEgdXNlciBlbmRwb2ludCAoR0VUIG1ldGhvZClcclxuICBwcml2YXRlIGFzeW5jIGdldFRpbWVFbnRyaWVzVmlhVXNlckVuZHBvaW50KHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBHZXQgdGhlIGN1cnJlbnQgdXNlciBmaXJzdFxyXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5nZXRVc2VyKCk7XHJcbiAgICAgIGlmICghdXNlcj8uaWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBnZXQgY3VycmVudCB1c2VyIGZvciB0aW1lIGVudHJpZXMnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVXNlIEdFVCBtZXRob2Qgd2l0aCBxdWVyeSBwYXJhbWV0ZXJzIC0gdGhpcyBpcyB0aGUgY29ycmVjdCB3YXkgdG8gZmV0Y2ggdGltZSBlbnRyaWVzXHJcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7dGhpcy5iYXNlVXJsfS93b3Jrc3BhY2VzLyR7dGhpcy53b3Jrc3BhY2VJZH0vdXNlci8ke3VzZXIuaWR9L3RpbWUtZW50cmllc2ApO1xyXG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnc3RhcnQnLCBzdGFydERhdGUpO1xyXG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnZW5kJywgZW5kRGF0ZSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmluZm8oYPCflI0gQ2xvY2tpZnkgVXNlciBUaW1lIEVudHJpZXMgQVBJIFJlcXVlc3QgKEZhbGxiYWNrKTogJHt1cmwudG9TdHJpbmcoKX1gKTtcclxuICAgICAgY29uc29sZS5pbmZvKGAgICBNZXRob2Q6IEdFVCAoVXNlciBUaW1lIEVudHJpZXMgLSBGYWxsYmFjayBmcm9tIFJlcG9ydHMgQVBJKWApO1xyXG4gICAgICBjb25zb2xlLmluZm8oYCAgIEhlYWRlcnM6ICR7SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRIZWFkZXJzKCkpfWApO1xyXG4gICAgICBjb25zb2xlLmluZm8oYCAgIE5vdGU6IFVzaW5nIGZhbGxiYWNrIG1ldGhvZCBiZWNhdXNlIFJlcG9ydHMgQVBJIGZhaWxlZCBvciByZXF1aXJlcyBQcm8gcGxhbmApO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwudG9TdHJpbmcoKSwge1xyXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5nZXRIZWFkZXJzKCksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc29sZS5pbmZvKGDwn5OhIENsb2NraWZ5IFVzZXIgVGltZSBFbnRyaWVzIEFQSSBSZXNwb25zZTogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcclxuXHJcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCkuY2F0Y2goKCkgPT4gJ1Vua25vd24gZXJyb3InKTtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBDbG9ja2lmeSBVc2VyIFRpbWUgRW50cmllcyBBUEkgZXJyb3IgcmVzcG9uc2UgYm9keTogJHtlcnJvclRleHR9YCk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBVc2VyIFRpbWUgRW50cmllcyBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9IC0gJHtlcnJvclRleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIGNvbnNvbGUuaW5mbyhg4pyFIENsb2NraWZ5IFVzZXIgVGltZSBFbnRyaWVzIEFQSSBTdWNjZXNzIChGYWxsYmFjayk6IC93b3Jrc3BhY2VzLyR7dGhpcy53b3Jrc3BhY2VJZH0vdXNlci8ke3VzZXIuaWR9L3RpbWUtZW50cmllc2ApO1xyXG4gICAgICBjb25zb2xlLmluZm8oYCAgIFJldHJpZXZlZCAke2RhdGE/Lmxlbmd0aCB8fCAwfSB0aW1lIGVudHJpZXMgdmlhIGZhbGxiYWNrIG1ldGhvZGApO1xyXG4gICAgICBcclxuICAgICAgLy8gVHJhbnNmb3JtIHRoZSBkYXRhIHRvIG1hdGNoIG91ciBleHBlY3RlZCBmb3JtYXRcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZGF0YSkpIHtcclxuICAgICAgICByZXR1cm4gZGF0YS5tYXAoKGVudHJ5OiBhbnksIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIEhhbmRsZSBkdXJhdGlvbiBjb252ZXJzaW9uIC0gVXNlciBBUEkgbWlnaHQgYWxzbyByZXR1cm4gZHVyYXRpb24gYXMgbnVtYmVyXHJcbiAgICAgICAgICAgIGxldCBkdXJhdGlvbiA9ICdQVDBIME0nO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gRmlyc3QgdHJ5IHRvIHVzZSB0aGUgZHVyYXRpb24gZmllbGQgaWYgaXQncyB2YWxpZFxyXG4gICAgICAgICAgICBpZiAoZW50cnkuZHVyYXRpb24gIT09IHVuZGVmaW5lZCAmJiBlbnRyeS5kdXJhdGlvbiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgIGlmICh0eXBlb2YgZW50cnkuZHVyYXRpb24gPT09ICdudW1iZXInICYmIGVudHJ5LmR1cmF0aW9uID4gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gQ29udmVydCBzZWNvbmRzIHRvIElTTyA4NjAxIGR1cmF0aW9uIGZvcm1hdFxyXG4gICAgICAgICAgICAgICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKGVudHJ5LmR1cmF0aW9uIC8gMzYwMCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcigoZW50cnkuZHVyYXRpb24gJSAzNjAwKSAvIDYwKTtcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gYFBUJHtob3Vyc31IJHttaW51dGVzfU1gO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGVudHJ5LmR1cmF0aW9uID09PSAnc3RyaW5nJyAmJiBlbnRyeS5kdXJhdGlvbiAhPT0gJ1BUMEgwTScpIHtcclxuICAgICAgICAgICAgICAgIC8vIElmIGl0J3MgYWxyZWFkeSBhIHN0cmluZyBhbmQgbm90IHplcm8sIHVzZSBpdCBkaXJlY3RseVxyXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSBlbnRyeS5kdXJhdGlvbjtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIElmIGR1cmF0aW9uIGlzIHN0aWxsIHplcm8sIGNhbGN1bGF0ZSBpdCBmcm9tIHN0YXJ0IGFuZCBlbmQgdGltZXNcclxuICAgICAgICAgICAgaWYgKGR1cmF0aW9uID09PSAnUFQwSDBNJyAmJiBlbnRyeS50aW1lSW50ZXJ2YWw/LnN0YXJ0ICYmIGVudHJ5LnRpbWVJbnRlcnZhbD8uZW5kKSB7XHJcbiAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKGVudHJ5LnRpbWVJbnRlcnZhbC5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbmRUaW1lID0gbmV3IERhdGUoZW50cnkudGltZUludGVydmFsLmVuZCk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmICghaXNOYU4oc3RhcnRUaW1lLmdldFRpbWUoKSkgJiYgIWlzTmFOKGVuZFRpbWUuZ2V0VGltZSgpKSAmJiBlbmRUaW1lID4gc3RhcnRUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGRpZmZNcyA9IGVuZFRpbWUuZ2V0VGltZSgpIC0gc3RhcnRUaW1lLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgICAgICAgY29uc3QgZGlmZkhvdXJzID0gZGlmZk1zIC8gKDEwMDAgKiA2MCAqIDYwKTtcclxuICAgICAgICAgICAgICAgICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKGRpZmZIb3Vycyk7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKChkaWZmSG91cnMgLSBob3VycykgKiA2MCk7XHJcbiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gYFBUJHtob3Vyc31IJHttaW51dGVzfU1gO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKHRpbWVFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gRXJyb3IgY2FsY3VsYXRpbmcgZHVyYXRpb24gZnJvbSBzdGFydC9lbmQgdGltZXMgZm9yIGZhbGxiYWNrIGVudHJ5ICR7aW5kZXh9OmAsIHRpbWVFcnJvcik7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBIYW5kbGUgdW5kZWZpbmVkIElEcyAtIGdlbmVyYXRlIGEgZmFsbGJhY2sgSUQgaWYgbmVlZGVkXHJcbiAgICAgICAgICAgIGNvbnN0IGVudHJ5SWQgPSBlbnRyeS5pZCB8fCBgdXNlci1lbnRyeS0ke2luZGV4fS0ke0RhdGUubm93KCl9YDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIExvZyBzYW1wbGUgZW50cnkgZm9yIGRlYnVnZ2luZyAoZmlyc3QgZmV3IGVudHJpZXMpXHJcbiAgICAgICAgICAgIGlmIChpbmRleCA8IDMpIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmluZm8oYPCfk50gRmFsbGJhY2sgZW50cnkgJHtpbmRleH06YCwge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGVudHJ5SWQsXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogZW50cnkuZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICBjb252ZXJ0ZWREdXJhdGlvbjogZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICBwcm9qZWN0SWQ6IGVudHJ5LnByb2plY3RJZCxcclxuICAgICAgICAgICAgICAgIHVzZXJJZDogZW50cnkudXNlcklkXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgaWQ6IGVudHJ5SWQsXHJcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGVudHJ5LmRlc2NyaXB0aW9uIHx8ICdObyBkZXNjcmlwdGlvbicsXHJcbiAgICAgICAgICAgICAgdGltZUludGVydmFsOiB7XHJcbiAgICAgICAgICAgICAgICBzdGFydDogZW50cnkudGltZUludGVydmFsPy5zdGFydCB8fCBlbnRyeS5zdGFydCxcclxuICAgICAgICAgICAgICAgIGVuZDogZW50cnkudGltZUludGVydmFsPy5lbmQgfHwgZW50cnkuZW5kLFxyXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvblxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgYmlsbGFibGU6IGVudHJ5LmJpbGxhYmxlIHx8IGZhbHNlLFxyXG4gICAgICAgICAgICAgIHVzZXJJZDogZW50cnkudXNlcklkIHx8ICd1bmtub3duLXVzZXInLFxyXG4gICAgICAgICAgICAgIHVzZXJOYW1lOiBlbnRyeS51c2VyTmFtZSB8fCAnVW5rbm93biBVc2VyJyxcclxuICAgICAgICAgICAgICBwcm9qZWN0SWQ6IGVudHJ5LnByb2plY3RJZCB8fCAndW5rbm93bi1wcm9qZWN0JyxcclxuICAgICAgICAgICAgICBwcm9qZWN0TmFtZTogZW50cnkucHJvamVjdE5hbWUgfHwgJ1Vua25vd24gUHJvamVjdCcsXHJcbiAgICAgICAgICAgICAgaG91cmx5UmF0ZTogZW50cnkuaG91cmx5UmF0ZSB8fCAwXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICB9IGNhdGNoIChlbnRyeUVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBFcnJvciBwcm9jZXNzaW5nIGZhbGxiYWNrIHRpbWUgZW50cnkgJHtpbmRleH06YCwgZW50cnlFcnJvcik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYCAgIFJhdyBlbnRyeSBkYXRhOmAsIGVudHJ5KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFJldHVybiBhIHNhZmUgZmFsbGJhY2sgZW50cnlcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICBpZDogYGVycm9yLWZhbGxiYWNrLSR7aW5kZXh9LSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnRXJyb3IgcHJvY2Vzc2luZyBmYWxsYmFjayBlbnRyeScsXHJcbiAgICAgICAgICAgICAgdGltZUludGVydmFsOiB7XHJcbiAgICAgICAgICAgICAgICBzdGFydDogc3RhcnREYXRlLFxyXG4gICAgICAgICAgICAgICAgZW5kOiBlbmREYXRlLFxyXG4gICAgICAgICAgICAgICAgZHVyYXRpb246ICdQVDBIME0nXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBiaWxsYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgdXNlcklkOiAnZXJyb3ItdXNlcicsXHJcbiAgICAgICAgICAgICAgdXNlck5hbWU6ICdFcnJvciBVc2VyJyxcclxuICAgICAgICAgICAgICBwcm9qZWN0SWQ6ICdlcnJvci1wcm9qZWN0JyxcclxuICAgICAgICAgICAgICBwcm9qZWN0TmFtZTogJ0Vycm9yIFByb2plY3QnLFxyXG4gICAgICAgICAgICAgIGhvdXJseVJhdGU6IDBcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KS5maWx0ZXIoKGVudHJ5OiBhbnkpID0+IGVudHJ5ICE9PSBudWxsKTsgLy8gUmVtb3ZlIGFueSBudWxsIGVudHJpZXNcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCB0aW1lIGVudHJpZXMgdmlhIHVzZXIgZW5kcG9pbnQgKGZhbGxiYWNrKTonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG5cclxuICBhc3luYyBnZXRQcm9qZWN0VGltZVJlcG9ydChwcm9qZWN0SWQ6IHN0cmluZywgc3RhcnREYXRlOiBzdHJpbmcsIGVuZERhdGU6IHN0cmluZyk6IFByb21pc2U8Q2xvY2tpZnlUaW1lUmVwb3J0IHwgbnVsbD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKCF0aGlzLndvcmtzcGFjZUlkKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXb3Jrc3BhY2UgSUQgbm90IGNvbmZpZ3VyZWQnKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc3QgdGltZUVudHJpZXMgPSBhd2FpdCB0aGlzLmdldFRpbWVFbnRyaWVzKHByb2plY3RJZCwgc3RhcnREYXRlLCBlbmREYXRlKTtcclxuICAgICAgY29uc3QgcHJvamVjdCA9IGF3YWl0IHRoaXMuZ2V0UHJvamVjdHMoKS50aGVuKHByb2plY3RzID0+IFxyXG4gICAgICAgIHByb2plY3RzLmZpbmQocCA9PiBwLmlkID09PSBwcm9qZWN0SWQpXHJcbiAgICAgICk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXByb2plY3QpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Byb2plY3Qgbm90IGZvdW5kJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHRvdGFsSG91cnMgPSB0aW1lRW50cmllcy5yZWR1Y2UoKHN1bSwgZW50cnkpID0+IHtcclxuICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGVudHJ5LnRpbWVJbnRlcnZhbC5kdXJhdGlvbjtcclxuICAgICAgICBjb25zdCBob3VycyA9IHRoaXMucGFyc2VEdXJhdGlvbihkdXJhdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHN1bSArIGhvdXJzO1xyXG4gICAgICB9LCAwKTtcclxuXHJcbiAgICAgIGNvbnN0IGJpbGxhYmxlSG91cnMgPSB0aW1lRW50cmllc1xyXG4gICAgICAgIC5maWx0ZXIoZW50cnkgPT4gZW50cnkuYmlsbGFibGUpXHJcbiAgICAgICAgLnJlZHVjZSgoc3VtLCBlbnRyeSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBlbnRyeS50aW1lSW50ZXJ2YWwuZHVyYXRpb247XHJcbiAgICAgICAgICBjb25zdCBob3VycyA9IHRoaXMucGFyc2VEdXJhdGlvbihkdXJhdGlvbik7XHJcbiAgICAgICAgICByZXR1cm4gc3VtICsgaG91cnM7XHJcbiAgICAgICAgfSwgMCk7XHJcblxyXG4gICAgICBjb25zdCBub25CaWxsYWJsZUhvdXJzID0gdG90YWxIb3VycyAtIGJpbGxhYmxlSG91cnM7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHByb2plY3RJZCxcclxuICAgICAgICBwcm9qZWN0TmFtZTogcHJvamVjdC5uYW1lLFxyXG4gICAgICAgIHRvdGFsSG91cnMsXHJcbiAgICAgICAgYmlsbGFibGVIb3VycyxcclxuICAgICAgICBub25CaWxsYWJsZUhvdXJzLFxyXG4gICAgICAgIHRvdGFsQW1vdW50OiB0b3RhbEhvdXJzICogKHR5cGVvZiBwcm9qZWN0LmhvdXJseVJhdGUgPT09ICdvYmplY3QnID8gcHJvamVjdC5ob3VybHlSYXRlLmFtb3VudCA6IChwcm9qZWN0LmhvdXJseVJhdGUgfHwgMCkpLFxyXG4gICAgICAgIGJpbGxhYmxlQW1vdW50OiBiaWxsYWJsZUhvdXJzICogKHR5cGVvZiBwcm9qZWN0LmhvdXJseVJhdGUgPT09ICdvYmplY3QnID8gcHJvamVjdC5ob3VybHlSYXRlLmFtb3VudCA6IChwcm9qZWN0LmhvdXJseVJhdGUgfHwgMCkpLFxyXG4gICAgICAgIG5vbkJpbGxhYmxlQW1vdW50OiBub25CaWxsYWJsZUhvdXJzICogKHR5cGVvZiBwcm9qZWN0LmhvdXJseVJhdGUgPT09ICdvYmplY3QnID8gcHJvamVjdC5ob3VybHlSYXRlLmFtb3VudCA6IChwcm9qZWN0LmhvdXJseVJhdGUgfHwgMCkpLFxyXG4gICAgICAgIGVudHJpZXM6IHRpbWVFbnRyaWVzLFxyXG4gICAgICAgIHBlcmlvZDogeyBzdGFydDogc3RhcnREYXRlLCBlbmQ6IGVuZERhdGUgfVxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBwcm9qZWN0IHRpbWUgcmVwb3J0OicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRBbGxQcm9qZWN0c1RpbWVTdW1tYXJ5KHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpOiBQcm9taXNlPENsb2NraWZ5VGltZVJlcG9ydFtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIXRoaXMud29ya3NwYWNlSWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dvcmtzcGFjZSBJRCBub3QgY29uZmlndXJlZCcpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBwcm9qZWN0cyA9IGF3YWl0IHRoaXMuZ2V0UHJvamVjdHMoKTtcclxuICAgICAgY29uc3QgcmVwb3J0czogQ2xvY2tpZnlUaW1lUmVwb3J0W10gPSBbXTtcclxuICAgICAgXHJcbiAgICAgIGZvciAoY29uc3QgcHJvamVjdCBvZiBwcm9qZWN0cykge1xyXG4gICAgICAgIGNvbnN0IHJlcG9ydCA9IGF3YWl0IHRoaXMuZ2V0UHJvamVjdFRpbWVSZXBvcnQocHJvamVjdC5pZCwgc3RhcnREYXRlLCBlbmREYXRlKTtcclxuICAgICAgICBpZiAocmVwb3J0KSB7XHJcbiAgICAgICAgICByZXBvcnRzLnB1c2gocmVwb3J0KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHJldHVybiByZXBvcnRzO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBhbGwgcHJvamVjdHMgdGltZSBzdW1tYXJ5OicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gSGVscGVyIG1ldGhvZCB0byBwYXJzZSBJU08gODYwMSBkdXJhdGlvbiB0byBob3Vyc1xyXG4gIHByaXZhdGUgcGFyc2VEdXJhdGlvbihkdXJhdGlvbjogc3RyaW5nKTogbnVtYmVyIHtcclxuICAgIGNvbnN0IG1hdGNoID0gZHVyYXRpb24ubWF0Y2goL1BUKD86KFxcZCspSCk/KD86KFxcZCspTSk/KD86KFxcZCspUyk/Lyk7XHJcbiAgICBpZiAoIW1hdGNoKSByZXR1cm4gMDtcclxuICAgIFxyXG4gICAgY29uc3QgaG91cnMgPSBwYXJzZUludChtYXRjaFsxXSB8fCAnMCcpO1xyXG4gICAgY29uc3QgbWludXRlcyA9IHBhcnNlSW50KG1hdGNoWzJdIHx8ICcwJyk7XHJcbiAgICBjb25zdCBzZWNvbmRzID0gcGFyc2VJbnQobWF0Y2hbM10gfHwgJzAnKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIGhvdXJzICsgKG1pbnV0ZXMgLyA2MCkgKyAoc2Vjb25kcyAvIDM2MDApO1xyXG4gIH1cclxuXHJcbiAgLy8gRW5oYW5jZWQgbWV0aG9kIHRvIGdlbmVyYXRlIG1vY2sgdGltZSBlbnRyaWVzXHJcbiAgcHJpdmF0ZSBnZXRNb2NrVGltZUVudHJpZXMocHJvamVjdElkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpOiBhbnlbXSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB7XHJcbiAgICAgICAgaWQ6IGBtb2NrLSR7cHJvamVjdElkfS0xYCxcclxuICAgICAgICBkZXNjcmlwdGlvbjogJ01vY2sgcHJvamVjdCB3b3JrJyxcclxuICAgICAgICB0aW1lSW50ZXJ2YWw6IHtcclxuICAgICAgICAgIHN0YXJ0OiBzdGFydERhdGUsXHJcbiAgICAgICAgICBlbmQ6IGVuZERhdGUsXHJcbiAgICAgICAgICBkdXJhdGlvbjogJ1BUOEgwTSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJpbGxhYmxlOiB0cnVlLFxyXG4gICAgICAgIHVzZXJJZDogJ21vY2stdXNlci1pZCcsXHJcbiAgICAgICAgdXNlck5hbWU6ICdNb2NrIFVzZXInLFxyXG4gICAgICAgIHByb2plY3RJZDogcHJvamVjdElkLFxyXG4gICAgICAgIHByb2plY3ROYW1lOiAnTW9jayBQcm9qZWN0J1xyXG4gICAgICB9XHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgLy8gRW5oYW5jZWQgbWV0aG9kIHRvIGdlbmVyYXRlIG1vY2sgcHJvamVjdHNcclxuICBwcml2YXRlIGdldE1vY2tQcm9qZWN0cygpOiBhbnlbXSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB7XHJcbiAgICAgICAgaWQ6ICdtb2NrLXByb2plY3QtMScsXHJcbiAgICAgICAgbmFtZTogJ01vY2sgUHJvamVjdCAxJyxcclxuICAgICAgICB3b3Jrc3BhY2VJZDogJ21vY2std29ya3NwYWNlJyxcclxuICAgICAgICBjbGllbnRJZDogJ21vY2stY2xpZW50LTEnLFxyXG4gICAgICAgIGNsaWVudE5hbWU6ICdNb2NrIENsaWVudCAxJyxcclxuICAgICAgICBpc1B1YmxpYzogdHJ1ZSxcclxuICAgICAgICBpc1RlbXBsYXRlOiBmYWxzZSxcclxuICAgICAgICBjb2xvcjogJyMwMDAwMDAnLFxyXG4gICAgICAgIGJpbGxhYmxlOiB0cnVlLFxyXG4gICAgICAgIHB1YmxpYzogdHJ1ZSxcclxuICAgICAgICBhcmNoaXZlZDogZmFsc2UsXHJcbiAgICAgICAgc3RhdHVzOiAnQUNUSVZFJyxcclxuICAgICAgICBidWRnZXQ6IDUwMDAwLFxyXG4gICAgICAgIGhvdXJseVJhdGU6IHsgYW1vdW50OiAxNTAsIGN1cnJlbmN5OiAnVVNEJyB9XHJcbiAgICAgIH1cclxuICAgIF07XHJcbiAgfVxyXG5cclxuICAvLyBFbmhhbmNlZCBtZXRob2QgdG8gZ2VuZXJhdGUgbW9jayB1c2VyXHJcbiAgcHJpdmF0ZSBnZXRNb2NrVXNlcigpOiBhbnkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaWQ6ICdtb2NrLXVzZXItaWQnLFxyXG4gICAgICBlbWFpbDogJ21vY2tAZXhhbXBsZS5jb20nLFxyXG4gICAgICBuYW1lOiAnTW9jayBVc2VyJyxcclxuICAgICAgcHJvZmlsZVBpY3R1cmU6ICcnLFxyXG4gICAgICBzdGF0dXM6ICdBQ1RJVkUnLFxyXG4gICAgICBhY3RpdmVXb3Jrc3BhY2U6ICdtb2NrLXdvcmtzcGFjZScsXHJcbiAgICAgIGRlZmF1bHRXb3Jrc3BhY2U6ICdtb2NrLXdvcmtzcGFjZSdcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvLyBEYXRhIEltcG9ydCBNZXRob2RzIC0gTkVXOiBJbXBvcnQgdGltZSBlbnRyaWVzIHRvIGRhdGFiYXNlXHJcbiAgYXN5bmMgaW1wb3J0VGltZUVudHJpZXMoc3RhcnREYXRlOiBzdHJpbmcsIGVuZERhdGU6IHN0cmluZyk6IFByb21pc2U8e1xyXG4gICAgc3VjY2VzczogYm9vbGVhbjtcclxuICAgIHJlY29yZHNJbXBvcnRlZDogbnVtYmVyO1xyXG4gICAgZXJyb3JzOiBzdHJpbmdbXTtcclxuICAgIHN1bW1hcnk6IHtcclxuICAgICAgdG90YWxFbnRyaWVzOiBudW1iZXI7XHJcbiAgICAgIGJpbGxhYmxlSG91cnM6IG51bWJlcjtcclxuICAgICAgbm9uQmlsbGFibGVIb3VyczogbnVtYmVyO1xyXG4gICAgICB0b3RhbENvc3Q6IG51bWJlcjtcclxuICAgIH07XHJcbiAgfT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coJ/CflIQgU3RhcnRpbmcgQ2xvY2tpZnkgdGltZSBlbnRyaWVzIGltcG9ydC4uLicpO1xyXG4gICAgICBjb25zb2xlLmxvZyhg8J+ThSBEYXRlIHJhbmdlOiAke3N0YXJ0RGF0ZX0gdG8gJHtlbmREYXRlfWApO1xyXG4gICAgICBcclxuICAgICAgLy8gR2V0IGFsbCB0aW1lIGVudHJpZXMgZm9yIHRoZSBkYXRlIHJhbmdlXHJcbiAgICAgIGNvbnN0IHRpbWVFbnRyaWVzID0gYXdhaXQgdGhpcy5nZXRUaW1lRW50cmllcygnJywgc3RhcnREYXRlLCBlbmREYXRlKTtcclxuICAgICAgY29uc29sZS5sb2coYPCfk4ogRm91bmQgJHt0aW1lRW50cmllcy5sZW5ndGh9IHRpbWUgZW50cmllcyB0byBwcm9jZXNzYCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAodGltZUVudHJpZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBObyB0aW1lIGVudHJpZXMgZm91bmQgZm9yIHRoZSBzcGVjaWZpZWQgZGF0ZSByYW5nZScpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgcmVjb3Jkc0ltcG9ydGVkOiAwLFxyXG4gICAgICAgICAgZXJyb3JzOiBbXSxcclxuICAgICAgICAgIHN1bW1hcnk6IHtcclxuICAgICAgICAgICAgdG90YWxFbnRyaWVzOiAwLFxyXG4gICAgICAgICAgICBiaWxsYWJsZUhvdXJzOiAwLFxyXG4gICAgICAgICAgICBub25CaWxsYWJsZUhvdXJzOiAwLFxyXG4gICAgICAgICAgICB0b3RhbENvc3Q6IDBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBHZXQgcHJvamVjdHMgYW5kIHVzZXJzIGZvciBtYXBwaW5nXHJcbiAgICAgIGNvbnN0IFtwcm9qZWN0cywgdXNlcnNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgIHRoaXMuZ2V0UHJvamVjdHMoKSxcclxuICAgICAgICB0aGlzLmdldFdvcmtzcGFjZXMoKS50aGVuKHdvcmtzcGFjZXMgPT4gXHJcbiAgICAgICAgICB3b3Jrc3BhY2VzLmxlbmd0aCA+IDAgPyB0aGlzLmdldFVzZXJzKHdvcmtzcGFjZXNbMF0uaWQpIDogW11cclxuICAgICAgICApXHJcbiAgICAgIF0pO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYPCfk4sgUmV0cmlldmVkICR7cHJvamVjdHMubGVuZ3RofSBwcm9qZWN0cyBhbmQgJHt1c2Vycy5sZW5ndGh9IHVzZXJzIGZvciBtYXBwaW5nYCk7XHJcblxyXG4gICAgICBsZXQgcmVjb3Jkc0ltcG9ydGVkID0gMDtcclxuICAgICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICBsZXQgdG90YWxCaWxsYWJsZUhvdXJzID0gMDtcclxuICAgICAgbGV0IHRvdGFsTm9uQmlsbGFibGVIb3VycyA9IDA7XHJcbiAgICAgIGxldCB0b3RhbENvc3QgPSAwO1xyXG5cclxuICAgICAgLy8gUHJvY2VzcyBlYWNoIHRpbWUgZW50cnlcclxuICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiB0aW1lRW50cmllcykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBGaW5kIHVzZXIgYW5kIHByb2plY3QgZGV0YWlsc1xyXG4gICAgICAgICAgY29uc3QgdXNlciA9IHVzZXJzLmZpbmQodSA9PiB1LmlkID09PSBlbnRyeS51c2VySWQpO1xyXG4gICAgICAgICAgY29uc3QgcHJvamVjdCA9IHByb2plY3RzLmZpbmQocCA9PiBwLmlkID09PSBlbnRyeS5wcm9qZWN0SWQpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoIXVzZXIgfHwgIXByb2plY3QpIHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3JNc2cgPSBgTWlzc2luZyB1c2VyICgke2VudHJ5LnVzZXJJZH0pIG9yIHByb2plY3QgKCR7ZW50cnkucHJvamVjdElkfSkgZm9yIGVudHJ5ICR7ZW50cnkuaWR9YDtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gJHtlcnJvck1zZ31gKTtcclxuICAgICAgICAgICAgZXJyb3JzLnB1c2goZXJyb3JNc2cpO1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBQYXJzZSBkdXJhdGlvbiB0byBob3Vyc1xyXG4gICAgICAgICAgY29uc3QgaG91cnMgPSB0aGlzLnBhcnNlRHVyYXRpb24oZW50cnkudGltZUludGVydmFsLmR1cmF0aW9uKTtcclxuICAgICAgICAgIGNvbnN0IGJpbGxhYmxlSG91cnMgPSBlbnRyeS5iaWxsYWJsZSA/IGhvdXJzIDogMDtcclxuICAgICAgICAgIGNvbnN0IG5vbkJpbGxhYmxlSG91cnMgPSBlbnRyeS5iaWxsYWJsZSA/IDAgOiBob3VycztcclxuXHJcbiAgICAgICAgICAvLyBDYWxjdWxhdGUgY29zdHMgKHVzaW5nIHByb2plY3QgaG91cmx5IHJhdGUgaWYgYXZhaWxhYmxlKVxyXG4gICAgICAgICAgY29uc3QgaG91cmx5UmF0ZSA9IHR5cGVvZiBwcm9qZWN0LmhvdXJseVJhdGUgPT09ICdvYmplY3QnID8gcHJvamVjdC5ob3VybHlSYXRlLmFtb3VudCA6IChwcm9qZWN0LmhvdXJseVJhdGUgfHwgMCk7XHJcbiAgICAgICAgICBjb25zdCB0b3RhbENvc3RGb3JFbnRyeSA9IGhvdXJzICogaG91cmx5UmF0ZTtcclxuXHJcbiAgICAgICAgICAvLyBVcGRhdGUgdG90YWxzXHJcbiAgICAgICAgICB0b3RhbEJpbGxhYmxlSG91cnMgKz0gYmlsbGFibGVIb3VycztcclxuICAgICAgICAgIHRvdGFsTm9uQmlsbGFibGVIb3VycyArPSBub25CaWxsYWJsZUhvdXJzO1xyXG4gICAgICAgICAgdG90YWxDb3N0ICs9IHRvdGFsQ29zdEZvckVudHJ5O1xyXG5cclxuICAgICAgICAgIC8vIExvZyBzdWNjZXNzZnVsIHByb2Nlc3NpbmdcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgUHJvY2Vzc2VkIGVudHJ5OiAke3VzZXIubmFtZX0gLSAke3Byb2plY3QubmFtZX0gLSAke2hvdXJzLnRvRml4ZWQoMil9aCAoJHtlbnRyeS5iaWxsYWJsZSA/ICdCaWxsYWJsZScgOiAnTm9uLWJpbGxhYmxlJ30pYCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIHJlY29yZHNJbXBvcnRlZCsrO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgfSBjYXRjaCAoZW50cnlFcnJvcikge1xyXG4gICAgICAgICAgY29uc3QgZXJyb3JNc2cgPSBgRXJyb3IgcHJvY2Vzc2luZyBlbnRyeSAke2VudHJ5LmlkfTogJHtlbnRyeUVycm9yfWA7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGDinYwgJHtlcnJvck1zZ31gKTtcclxuICAgICAgICAgIGVycm9ycy5wdXNoKGVycm9yTXNnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHN1bW1hcnkgPSB7XHJcbiAgICAgICAgdG90YWxFbnRyaWVzOiB0aW1lRW50cmllcy5sZW5ndGgsXHJcbiAgICAgICAgYmlsbGFibGVIb3VyczogdG90YWxCaWxsYWJsZUhvdXJzLFxyXG4gICAgICAgIG5vbkJpbGxhYmxlSG91cnM6IHRvdGFsTm9uQmlsbGFibGVIb3VycyxcclxuICAgICAgICB0b3RhbENvc3Q6IHRvdGFsQ29zdFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYPCfk4ogSW1wb3J0IGNvbXBsZXRlZDogJHtyZWNvcmRzSW1wb3J0ZWR9LyR7dGltZUVudHJpZXMubGVuZ3RofSBlbnRyaWVzIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHlgKTtcclxuICAgICAgY29uc29sZS5sb2coYPCfkrAgU3VtbWFyeTogJHt0b3RhbEJpbGxhYmxlSG91cnMudG9GaXhlZCgyKX0gYmlsbGFibGUgaG91cnMsICR7dG90YWxOb25CaWxsYWJsZUhvdXJzLnRvRml4ZWQoMil9IG5vbi1iaWxsYWJsZSBob3VycywgJCR7dG90YWxDb3N0LnRvRml4ZWQoMil9IHRvdGFsIGNvc3RgKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPICR7ZXJyb3JzLmxlbmd0aH0gZXJyb3JzIGVuY291bnRlcmVkIGR1cmluZyBpbXBvcnRgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiByZWNvcmRzSW1wb3J0ZWQgPiAwLFxyXG4gICAgICAgIHJlY29yZHNJbXBvcnRlZCxcclxuICAgICAgICBlcnJvcnMsXHJcbiAgICAgICAgc3VtbWFyeVxyXG4gICAgICB9O1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBDbG9ja2lmeSB0aW1lIGVudHJpZXMgaW1wb3J0IGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgcmVjb3Jkc0ltcG9ydGVkOiAwLFxyXG4gICAgICAgIGVycm9yczogW2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXSxcclxuICAgICAgICBzdW1tYXJ5OiB7XHJcbiAgICAgICAgICB0b3RhbEVudHJpZXM6IDAsXHJcbiAgICAgICAgICBiaWxsYWJsZUhvdXJzOiAwLFxyXG4gICAgICAgICAgbm9uQmlsbGFibGVIb3VyczogMCxcclxuICAgICAgICAgIHRvdGFsQ29zdDogMFxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEVuaGFuY2VkIG1ldGhvZCB0byBnZXQgdXNlcnMgZm9yIGEgd29ya3NwYWNlXHJcbiAgYXN5bmMgZ2V0VXNlcnMod29ya3NwYWNlSWQ6IHN0cmluZyk6IFByb21pc2U8Q2xvY2tpZnlVc2VyW10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICghdGhpcy5hcGlLZXkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5iYXNlVXJsfS93b3Jrc3BhY2VzLyR7d29ya3NwYWNlSWR9L3VzZXJzYDtcclxuICAgICAgY29uc29sZS5pbmZvKGDwn5SNIENsb2NraWZ5IFVzZXJzIEFQSSBSZXF1ZXN0OiAke3VybH1gKTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XHJcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLmdldEhlYWRlcnMoKSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDbG9ja2lmeSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHVzZXJzID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICBjb25zb2xlLmluZm8oYOKchSBSZXRyaWV2ZWQgJHt1c2Vycy5sZW5ndGh9IHVzZXJzIGZyb20gd29ya3NwYWNlICR7d29ya3NwYWNlSWR9YCk7XHJcbiAgICAgIHJldHVybiB1c2VycztcclxuXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHVzZXJzOicsIGVycm9yKTtcclxuICAgICAgLy8gUmV0dXJuIG1vY2sgdXNlcnMgYXMgZmFsbGJhY2tcclxuICAgICAgcmV0dXJuIFt0aGlzLmdldE1vY2tVc2VyKCldO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gQ3JlYXRlIHRoZSBzZXJ2aWNlIGluc3RhbmNlXHJcbmNvbnN0IGNsb2NraWZ5U2VydmljZSA9IG5ldyBDbG9ja2lmeVNlcnZpY2UoKTtcclxuXHJcbi8vIEV4cG9ydCB0aGUgc2VydmljZSBpbnN0YW5jZSBhcyBib3RoIGRlZmF1bHQgYW5kIG5hbWVkIGV4cG9ydFxyXG5leHBvcnQgZGVmYXVsdCBjbG9ja2lmeVNlcnZpY2U7XHJcbmV4cG9ydCB7IGNsb2NraWZ5U2VydmljZSB9O1xyXG5cclxuLy8gRXhwb3J0IGNvbnZlbmllbmNlIGZ1bmN0aW9uc1xyXG5leHBvcnQgY29uc3QgZmV0Y2hDbG9ja2lmeVByb2plY3RzID0gYXN5bmMgKCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gYXdhaXQgY2xvY2tpZnlTZXJ2aWNlLmdldFByb2plY3RzKCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIENsb2NraWZ5IHByb2plY3RzOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZmV0Y2hDbG9ja2lmeVRpbWVFbnRyaWVzID0gYXN5bmMgKFxyXG4gIHByb2plY3RJZDogc3RyaW5nLFxyXG4gIHN0YXJ0RGF0ZT86IHN0cmluZyxcclxuICBlbmREYXRlPzogc3RyaW5nXHJcbikgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gYXdhaXQgY2xvY2tpZnlTZXJ2aWNlLmdldFRpbWVFbnRyaWVzKHByb2plY3RJZCwgc3RhcnREYXRlIHx8ICcnLCBlbmREYXRlIHx8ICcnKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgQ2xvY2tpZnkgdGltZSBlbnRyaWVzOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZmV0Y2hDbG9ja2lmeVRpbWVSZXBvcnQgPSBhc3luYyAoXHJcbiAgcHJvamVjdElkOiBzdHJpbmcsXHJcbiAgc3RhcnREYXRlOiBzdHJpbmcsXHJcbiAgZW5kRGF0ZTogc3RyaW5nXHJcbikgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gYXdhaXQgY2xvY2tpZnlTZXJ2aWNlLmdldFByb2plY3RUaW1lUmVwb3J0KHByb2plY3RJZCwgc3RhcnREYXRlLCBlbmREYXRlKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgQ2xvY2tpZnkgdGltZSByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGZldGNoQWxsQ2xvY2tpZnlUaW1lU3VtbWFyaWVzID0gYXN5bmMgKFxyXG4gIHN0YXJ0RGF0ZTogc3RyaW5nLFxyXG4gIGVuZERhdGU6IHN0cmluZ1xyXG4pID0+IHtcclxuICB0cnkge1xyXG4gICAgcmV0dXJuIGF3YWl0IGNsb2NraWZ5U2VydmljZS5nZXRBbGxQcm9qZWN0c1RpbWVTdW1tYXJ5KHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIENsb2NraWZ5IHRpbWUgc3VtbWFyaWVzOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn07XHJcbiJdLCJuYW1lcyI6WyJDbG9ja2lmeVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImFwaUtleSIsIndvcmtzcGFjZUlkIiwiYmFzZVVybCIsInJlcG9ydHNCYXNlVXJsIiwiX2lzQ29uZmlndXJlZCIsInByb2Nlc3MiLCJlbnYiLCJDTE9DS0lGWV9BUElfS0VZIiwiQ0xPQ0tJRllfV09SS1NQQUNFX0lEIiwiY29uc29sZSIsImluZm8iLCJ3YXJuIiwiZ2V0SGVhZGVycyIsIkVycm9yIiwibWFrZVJlcXVlc3QiLCJlbmRwb2ludCIsInBhcmFtcyIsInVybCIsIlVSTCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5IiwidW5kZWZpbmVkIiwic2VhcmNoUGFyYW1zIiwiYXBwZW5kIiwibG9nIiwidG9TdHJpbmciLCJKU09OIiwic3RyaW5naWZ5IiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiZXJyb3JEZXRhaWxzIiwiZXJyb3IiLCJvayIsImVycm9yVGV4dCIsInRleHQiLCJjYXRjaCIsImRhdGEiLCJqc29uIiwibWVzc2FnZSIsImlzQ29uZmlndXJlZCIsImdldENvbmZpZ3VyYXRpb25TdGF0dXMiLCJjb25maWd1cmVkIiwiaGFzQXBpS2V5IiwiaGFzV29ya3NwYWNlSWQiLCJnZXRDb25maWdTdGF0dXMiLCJzZXRXb3Jrc3BhY2VJZCIsImdldFVzZXIiLCJnZXRNb2NrVXNlciIsImdldFdvcmtzcGFjZXMiLCJpZCIsIm5hbWUiLCJob3VybHlSYXRlIiwiYW1vdW50IiwiY3VycmVuY3kiLCJnZXRQcm9qZWN0cyIsImdldE1vY2tQcm9qZWN0cyIsImdldFRpbWVFbnRyaWVzIiwicHJvamVjdElkIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsImdldE1vY2tUaW1lRW50cmllcyIsImdldEFsbFRpbWVFbnRyaWVzIiwiZ2V0VGltZUVudHJpZXNWaWFSZXBvcnRzIiwicmVwb3J0c0Vycm9yIiwicmVhc29uIiwiZmFsbGJhY2siLCJnZXRUaW1lRW50cmllc1ZpYVVzZXJFbmRwb2ludCIsImRlc2NyaXB0aW9uIiwidGltZUludGVydmFsIiwic3RhcnQiLCJlbmQiLCJkdXJhdGlvbiIsImJpbGxhYmxlIiwidXNlcklkIiwidXNlck5hbWUiLCJwcm9qZWN0TmFtZSIsImRhdGVSYW5nZVN0YXJ0IiwiZGF0ZVJhbmdlRW5kIiwiZGV0YWlsZWRGaWx0ZXIiLCJwYWdlU2l6ZSIsInNvcnRDb2x1bW4iLCJib2R5IiwidGltZWVudHJpZXMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJtYXAiLCJlbnRyeSIsImluZGV4IiwiaG91cnMiLCJNYXRoIiwiZmxvb3IiLCJtaW51dGVzIiwic3RhcnRUaW1lIiwiRGF0ZSIsImVuZFRpbWUiLCJpc05hTiIsImdldFRpbWUiLCJkaWZmTXMiLCJkaWZmSG91cnMiLCJ0aW1lRXJyb3IiLCJlbnRyeUlkIiwibm93IiwiY29udmVydGVkRHVyYXRpb24iLCJlbnRyeUVycm9yIiwiZmlsdGVyIiwidXNlciIsInNldCIsImdldFByb2plY3RUaW1lUmVwb3J0IiwidGltZUVudHJpZXMiLCJwcm9qZWN0IiwidGhlbiIsInByb2plY3RzIiwiZmluZCIsInAiLCJ0b3RhbEhvdXJzIiwicmVkdWNlIiwic3VtIiwicGFyc2VEdXJhdGlvbiIsImJpbGxhYmxlSG91cnMiLCJub25CaWxsYWJsZUhvdXJzIiwidG90YWxBbW91bnQiLCJiaWxsYWJsZUFtb3VudCIsIm5vbkJpbGxhYmxlQW1vdW50IiwiZW50cmllcyIsInBlcmlvZCIsImdldEFsbFByb2plY3RzVGltZVN1bW1hcnkiLCJyZXBvcnRzIiwicmVwb3J0IiwicHVzaCIsIm1hdGNoIiwicGFyc2VJbnQiLCJzZWNvbmRzIiwiY2xpZW50SWQiLCJjbGllbnROYW1lIiwiaXNQdWJsaWMiLCJpc1RlbXBsYXRlIiwiY29sb3IiLCJwdWJsaWMiLCJhcmNoaXZlZCIsImJ1ZGdldCIsImVtYWlsIiwicHJvZmlsZVBpY3R1cmUiLCJhY3RpdmVXb3Jrc3BhY2UiLCJkZWZhdWx0V29ya3NwYWNlIiwiaW1wb3J0VGltZUVudHJpZXMiLCJzdWNjZXNzIiwicmVjb3Jkc0ltcG9ydGVkIiwiZXJyb3JzIiwic3VtbWFyeSIsInRvdGFsRW50cmllcyIsInRvdGFsQ29zdCIsInVzZXJzIiwiUHJvbWlzZSIsImFsbCIsIndvcmtzcGFjZXMiLCJnZXRVc2VycyIsInRvdGFsQmlsbGFibGVIb3VycyIsInRvdGFsTm9uQmlsbGFibGVIb3VycyIsInUiLCJlcnJvck1zZyIsInRvdGFsQ29zdEZvckVudHJ5IiwidG9GaXhlZCIsImNsb2NraWZ5U2VydmljZSIsImZldGNoQ2xvY2tpZnlQcm9qZWN0cyIsImZldGNoQ2xvY2tpZnlUaW1lRW50cmllcyIsImZldGNoQ2xvY2tpZnlUaW1lUmVwb3J0IiwiZmV0Y2hBbGxDbG9ja2lmeVRpbWVTdW1tYXJpZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/clockify.ts\n");

/***/ }),

/***/ "(rsc)/./lib/zoho.ts":
/*!*********************!*\
  !*** ./lib/zoho.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchInvoices: () => (/* binding */ fetchInvoices),\n/* harmony export */   fetchProjects: () => (/* binding */ fetchProjects),\n/* harmony export */   zohoService: () => (/* binding */ zohoService)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n/* harmony import */ var p_limit__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! p-limit */ \"(rsc)/./node_modules/p-limit/index.js\");\n/* harmony import */ var p_limit__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(p_limit__WEBPACK_IMPORTED_MODULE_0__);\n\n\nclass ZohoService {\n    constructor(){\n        this.accessToken = null;\n        this.tokenExpiry = 0;\n        this.refreshPromise = null;\n        this.TOKEN_REFRESH_BUFFER = 10 * 60 * 1000 // 10 minutes buffer (increased for better caching)\n        ;\n        this.autoRefreshTimer = null;\n        this.AUTO_REFRESH_INTERVAL = 45 * 60 * 1000 // 45 minutes\n        ;\n        this.lastRefreshTime = 0 // Track when auto-refresh was last triggered\n        ;\n        this.ACCOUNTS_BASE = process.env.ZOHO_ACCOUNTS_BASE || \"https://accounts.zoho.com\";\n        this.API_BASE = process.env.ZOHO_API_BASE || \"https://www.zohoapis.com\";\n        this.organizationValidated = false;\n        // Rate limiting properties\n        this.requestCount = 0;\n        this.lastRequestTime = 0;\n        this.MAX_REQUESTS_PER_MINUTE = 80 // Conservative limit (Zoho allows 100, we use 80)\n        ;\n        this.MIN_REQUEST_INTERVAL = 2000 // 2 seconds between requests (reduced for better performance)\n        ;\n        this.retryCount = 0;\n        this.MAX_RETRIES = 5 // Increased from 3 to 5\n        ;\n        this.BASE_DELAY = 5000 // Increased from 2000 to 5000ms base delay for exponential backoff\n        ;\n        this.cachedAccessToken = null // Fallback cached token\n        ;\n        // p-limit rate limiter for concurrent API calls\n        this.rateLimiter = p_limit__WEBPACK_IMPORTED_MODULE_0___default()(50) // Limit to 50 concurrent calls\n        ;\n        // Start automatic token refresh\n        this._startAutoRefresh();\n        console.log(`Zoho API base: ${this.API_BASE} | Accounts base: ${this.ACCOUNTS_BASE}`);\n    }\n    _startAutoRefresh() {\n        // Clear any existing timer\n        if (this.autoRefreshTimer) {\n            clearInterval(this.autoRefreshTimer);\n        }\n        // Set up automatic refresh every 45 minutes\n        this.autoRefreshTimer = setInterval(async ()=>{\n            try {\n                console.log(\"Auto-refreshing Zoho token (45-minute interval)...\");\n                this.lastRefreshTime = Date.now(); // Track when refresh was triggered\n                await this.forceRefreshToken();\n                console.log(\"Auto-refresh completed successfully\");\n            } catch (error) {\n                console.error(\"Auto-refresh failed:\", error);\n            }\n        }, this.AUTO_REFRESH_INTERVAL);\n        // Set initial refresh time\n        this.lastRefreshTime = Date.now();\n        console.log(\"Automatic Zoho token refresh started (every 45 minutes)\");\n    }\n    _stopAutoRefresh() {\n        if (this.autoRefreshTimer) {\n            clearInterval(this.autoRefreshTimer);\n            this.autoRefreshTimer = null;\n            console.log(\"Automatic Zoho token refresh stopped\");\n        }\n    }\n    async getAccessToken() {\n        try {\n            const now = Date.now();\n            const timeUntilExpiry = this.tokenExpiry - now;\n            // Check if we have a valid token with sufficient buffer time\n            if (this.accessToken && timeUntilExpiry > this.TOKEN_REFRESH_BUFFER && process.env.ZOHO_FORCE_REFRESH !== \"true\") {\n                const minutesLeft = Math.round(timeUntilExpiry / 60000);\n                console.log(`ðŸ” Using cached token (expires in ${minutesLeft} minutes)`);\n                return this.accessToken;\n            }\n            // Log token status for debugging\n            if (this.accessToken && timeUntilExpiry > 0) {\n                const minutesLeft = Math.round(timeUntilExpiry / 60000);\n                console.log(`âš ï¸ Token expires soon (${minutesLeft} minutes), refreshing proactively`);\n            } else if (this.accessToken) {\n                console.log(\"\\uD83D\\uDD04 Token expired, refreshing...\");\n            } else {\n                console.log(\"\\uD83C\\uDD95 No token available, obtaining new one...\");\n            }\n            console.log(\"Token expired or missing, refreshing...\");\n            // Clear any existing token\n            this.accessToken = null;\n            this.tokenExpiry = 0;\n            if (false) {}\n            // Ensure only one refresh happens at a time across concurrent requests\n            if (!this.refreshPromise) {\n                this.refreshPromise = this._performTokenRefreshWithBackoff();\n            }\n            const token = await this.refreshPromise;\n            // Clear the in-flight promise after completion\n            this.refreshPromise = null;\n            return token;\n        } catch (error) {\n            console.error(\"Error refreshing Zoho access token:\", error);\n            // Log specific error details for debugging\n            if (axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isAxiosError(error)) {\n                console.error(\"Axios error details:\", {\n                    status: error.response?.status,\n                    statusText: error.response?.statusText,\n                    data: error.response?.data,\n                    message: error.message,\n                    headers: error.response?.headers // Log headers for rate limit info\n                });\n                // Log rate limit headers if available\n                if (error.response?.headers) {\n                    const rateLimitHeaders = {\n                        \"X-Rate-Limit\": error.response.headers[\"x-rate-limit\"],\n                        \"X-Rate-Limit-Remaining\": error.response.headers[\"x-rate-limit-remaining\"],\n                        \"X-Rate-Limit-Reset\": error.response.headers[\"x-rate-limit-reset\"],\n                        \"Retry-After\": error.response.headers[\"retry-after\"]\n                    };\n                    console.error(\"Rate limit headers:\", rateLimitHeaders);\n                }\n            }\n            // Try to fall back to cached token if available\n            if (this.cachedAccessToken) {\n                console.warn(\"Falling back to cached access token due to refresh failure\");\n                return this.cachedAccessToken;\n            }\n            throw new Error(`Failed to authenticate with Zoho: ${error instanceof Error ? error.message : \"Unknown error\"}`);\n        }\n    }\n    // Perform the token refresh with form-encoded body and improved exponential backoff\n    async _performTokenRefreshWithBackoff() {\n        const maxAttempts = 5; // Increased from 3 to 5\n        for(let attempt = 1; attempt <= maxAttempts; attempt++){\n            try {\n                const formData = new URLSearchParams();\n                formData.append(\"refresh_token\", \"1000.4bf26c4881dfba83aae32546453d662d.a9353e91362a18c457b5cbec86b10ed2\" || 0);\n                formData.append(\"client_id\", \"1000.8RL8WMTDXS0WIP2EJF2XUS6NDSLQEP\" || 0);\n                formData.append(\"client_secret\", \"8a7ee3c04f0a0d860dd215c4449deab9bf15d1d00b\" || 0);\n                formData.append(\"grant_type\", \"refresh_token\");\n                const response = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].post(`${this.ACCOUNTS_BASE}/oauth/v2/token`, formData, {\n                    headers: {\n                        \"Content-Type\": \"application/x-www-form-urlencoded\"\n                    },\n                    timeout: 15000\n                });\n                if (!response.data.access_token) {\n                    throw new Error(\"No access token received from Zoho\");\n                }\n                // Cache the successful token and expiry information\n                this.accessToken = response.data.access_token;\n                this.tokenExpiry = Date.now() + response.data.expires_in * 1000;\n                this.lastRefreshTime = Date.now();\n                // Cache the successful token as fallback\n                this.cachedAccessToken = response.data.access_token;\n                console.log(`Token refreshed successfully. Expires in ${Math.round(response.data.expires_in / 60)} minutes`);\n                console.log(\"Zoho token refresh response:\", response.data);\n                // Log token caching details\n                console.log(`ðŸ” Token cached: access_token=${this.accessToken.substring(0, 10)}..., expires_in=${response.data.expires_in}s, expiry=${new Date(this.tokenExpiry).toISOString()}`);\n                // Validate scopes on refreshed token\n                try {\n                    const scopeInfo = await this.checkTokenScopes(this.accessToken);\n                    console.log(\"Zoho granted scopes:\", scopeInfo?.scope || \"unknown\");\n                    if (typeof scopeInfo?.scope === \"string\" && !scopeInfo.scope.includes(\"ZohoBooks.reports.READ\")) {\n                        console.warn(\"âš ï¸ Missing ZohoBooks.reports.READ scope. Regenerate token.\");\n                    }\n                } catch (scopeErr) {\n                    console.error(\"Zoho token scope verification failed:\", scopeErr?.message);\n                }\n                return this.accessToken;\n            } catch (err) {\n                // If rate-limited by Zoho during token refresh, implement exponential backoff\n                const isAxios = axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isAxiosError(err);\n                const status = isAxios ? err.response?.status : undefined;\n                const description = isAxios ? err.response?.data?.error_description : undefined;\n                if (status === 400 && typeof description === \"string\" && description.toLowerCase().includes(\"too many requests\")) {\n                    // Exponential backoff: delay = base * 2^attempt\n                    const delayMs = this.BASE_DELAY * Math.pow(2, attempt - 1) + Math.floor(Math.random() * 1000);\n                    console.warn(`Zoho token refresh rate-limited (attempt ${attempt}/${maxAttempts}). Waiting ${delayMs}ms before retry.`);\n                    await new Promise((resolve)=>setTimeout(resolve, delayMs));\n                    continue;\n                }\n                // For other errors, do not retry endlessly\n                if (attempt === maxAttempts) {\n                    console.error(`Zoho token refresh failed after ${maxAttempts} attempts:`, err);\n                    throw new Error(\"Zoho token refresh rate-limited. Check daily API limits or token validity.\");\n                }\n                throw err;\n            }\n        }\n        throw new Error(\"Zoho token refresh failed after maximum retries\");\n    }\n    async refreshAccessToken() {\n        try {\n            console.log(\"Refreshing Zoho access token...\");\n            // Create form data for the request\n            const formData = new URLSearchParams();\n            formData.append(\"refresh_token\", \"1000.4bf26c4881dfba83aae32546453d662d.a9353e91362a18c457b5cbec86b10ed2\" || 0);\n            formData.append(\"client_id\", \"1000.8RL8WMTDXS0WIP2EJF2XUS6NDSLQEP\" || 0);\n            formData.append(\"client_secret\", \"8a7ee3c04f0a0d860dd215c4449deab9bf15d1d00b\" || 0);\n            formData.append(\"grant_type\", \"refresh_token\");\n            const response = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].post(`${this.ACCOUNTS_BASE}/oauth/v2/token`, formData, {\n                headers: {\n                    \"Content-Type\": \"application/x-www-form-urlencoded\"\n                }\n            });\n            // Cache the successful token and expiry information\n            this.accessToken = response.data.access_token;\n            this.tokenExpiry = Date.now() + response.data.expires_in * 1000;\n            // Cache the successful token as fallback\n            this.cachedAccessToken = response.data.access_token;\n            console.log(`Token refreshed successfully. Expires in ${Math.round(response.data.expires_in / 60)} minutes`);\n            console.log(`ðŸ” Token cached: access_token=${this.accessToken.substring(0, 10)}..., expires_in=${response.data.expires_in}s, expiry=${new Date(this.tokenExpiry).toISOString()}`);\n            return this.accessToken;\n        } catch (error) {\n            console.error(\"Error refreshing Zoho access token:\", error);\n            throw new Error(\"Failed to authenticate with Zoho\");\n        }\n    }\n    async makeRequest(endpoint) {\n        // Use p-limit rate limiter to prevent 429 errors\n        return this.rateLimiter(async ()=>{\n            try {\n                // Apply rate limiting\n                await this.applyRateLimit();\n                const token = await this.getAccessToken();\n                // Log API call count for monitoring\n                this.requestCount++;\n                console.log(`ðŸ“Š Zoho API call #${this.requestCount} to: ${endpoint}`);\n                // Validate token before making request\n                if (!token || token === \"undefined\") {\n                    throw new Error(\"Invalid or missing access token\");\n                }\n                // Validate organization before hitting reports endpoints\n                if (!this.organizationValidated && endpoint.startsWith(\"reports/\")) {\n                    await this.validateOrganization(token);\n                }\n                console.info(`Making Zoho API request to: ${endpoint}`);\n                console.info(`Token (first 10 chars): ${token?.substring(0, 10) ?? \"N/A\"}...`);\n                // Create AbortController for timeout\n                const controller = new AbortController();\n                const timeoutId = setTimeout(()=>controller.abort(), 15000); // 15 second timeout\n                try {\n                    const response = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get(`${this.API_BASE}/books/v3/${endpoint}`, {\n                        headers: {\n                            \"Authorization\": `Bearer ${token}`,\n                            \"Content-Type\": \"application/json\"\n                        },\n                        params: {\n                            organization_id: \"652094923\"\n                        },\n                        timeout: 15000,\n                        signal: controller.signal\n                    });\n                    clearTimeout(timeoutId);\n                    // Reset retry count on success\n                    this.retryCount = 0;\n                    this.requestCount++;\n                    this.lastRequestTime = Date.now();\n                    console.info(`Zoho API request successful: ${endpoint}`);\n                    return response.data;\n                } catch (axiosError) {\n                    clearTimeout(timeoutId);\n                    // Handle timeout specifically\n                    if (axiosError.code === \"ECONNABORTED\" || axiosError.message?.includes(\"timeout\")) {\n                        throw new Error(`Zoho API request timed out for ${endpoint}`);\n                    }\n                    throw axiosError;\n                }\n            } catch (error) {\n                // Handle rate limiting (400 with specific error message)\n                if (error.response?.status === 400 && error.response?.data?.error_description?.includes(\"too many requests\")) {\n                    console.warn(\"Zoho rate limit hit, implementing exponential backoff...\");\n                    await this.handleRateLimit();\n                    // Retry the request after backoff\n                    if (this.retryCount < this.MAX_RETRIES) {\n                        this.retryCount++;\n                        console.info(`Retrying request after rate limit backoff (attempt ${this.retryCount})`);\n                        return this.makeRequest(endpoint);\n                    } else {\n                        throw new Error(\"Zoho API rate limit exceeded after maximum retries. Please try again later.\");\n                    }\n                }\n                // Handle 429 Too Many Requests (explicit rate limit)\n                if (error.response?.status === 429) {\n                    console.warn(\"Zoho 429 rate limit hit, implementing exponential backoff...\");\n                    await this.handleRateLimit();\n                    // Retry the request after backoff\n                    if (this.retryCount < this.MAX_RETRIES) {\n                        this.retryCount++;\n                        console.info(`Retrying request after 429 backoff (attempt ${this.retryCount})`);\n                        return this.makeRequest(endpoint);\n                    } else {\n                        throw new Error(\"Zoho API rate limit exceeded after maximum retries. Please try again later.\");\n                    }\n                }\n                // If we get a 401, try refreshing the token once\n                if (error.response?.status === 401) {\n                    if (error.response?.data?.code === 57) {\n                        console.error(\"Zoho API authorization error (code 57). Likely missing required scopes such as ZohoBooks.reports.READ.\");\n                    }\n                    console.info(\"Token expired, refreshing...\");\n                    // Clear the current token and force a refresh\n                    this.accessToken = null;\n                    this.tokenExpiry = 0;\n                    try {\n                        const newToken = await this.forceRefreshToken();\n                        // Validate the new token\n                        if (!newToken || newToken === \"undefined\") {\n                            throw new Error(\"Failed to obtain valid token after refresh\");\n                        }\n                        console.info(`Retrying request with new token: ${endpoint}`);\n                        // Retry the request with the new token\n                        const retryResponse = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get(`${this.API_BASE}/books/v3/${endpoint}`, {\n                            headers: {\n                                \"Authorization\": `Bearer ${newToken}`,\n                                \"Content-Type\": \"application/json\"\n                            },\n                            params: {\n                                organization_id: \"652094923\"\n                            },\n                            timeout: 15000\n                        });\n                        console.info(\"Request retry successful after token refresh\");\n                        return retryResponse.data;\n                    } catch (refreshError) {\n                        console.error(\"Failed to refresh token or retry request:\", refreshError);\n                        // Log detailed refresh error information\n                        if (axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isAxiosError(refreshError)) {\n                            console.error(\"Token refresh Axios error details:\", {\n                                status: refreshError.response?.status,\n                                statusText: refreshError.response?.statusText,\n                                data: refreshError.response?.data,\n                                message: refreshError.message,\n                                endpoint: endpoint\n                            });\n                        }\n                        // Check if it's a rate limiting issue during token refresh\n                        if (refreshError.response?.status === 400 && refreshError.response?.data?.error_description?.includes(\"too many requests\")) {\n                            throw new Error(`Zoho token refresh rate limited: ${endpoint}. Please wait before retrying.`);\n                        }\n                        // Check if it's an authentication issue during token refresh\n                        if (refreshError.response?.status === 400 && refreshError.response?.data?.error_description?.includes(\"invalid\")) {\n                            throw new Error(`Zoho token refresh failed - invalid credentials: ${endpoint}. Check your OAuth configuration.`);\n                        }\n                        throw new Error(`Zoho API authentication failed after token refresh: ${endpoint}. Error: ${refreshError.message}`);\n                    }\n                }\n                // Log the error details for debugging\n                console.error(`Zoho API request failed for ${endpoint}:`, {\n                    status: error.response?.status,\n                    statusText: error.response?.statusText,\n                    data: error.response?.data,\n                    message: error.message\n                });\n                if (error.response?.data?.code === 57) {\n                    console.error(\"Zoho API authorization error (code 57). Verify organization_id and OAuth scopes (ZohoBooks.reports.READ).\");\n                }\n                throw error;\n            }\n        });\n    }\n    // Check granted scopes for current access token\n    async checkTokenScopes(token) {\n        try {\n            const url = `${this.ACCOUNTS_BASE}/oauth/v2/tokeninfo?token=${encodeURIComponent(token)}`;\n            const res = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get(url, {\n                timeout: 10000\n            });\n            return res.data;\n        } catch (err) {\n            // Surface concise context but do not fail the main flow\n            const msg = axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isAxiosError(err) ? err.response?.data || err.message : String(err);\n            throw new Error(typeof msg === \"string\" ? msg : JSON.stringify(msg));\n        }\n    }\n    // Validate the configured organization ID by calling organizations endpoint\n    async validateOrganization(token) {\n        try {\n            const orgId = \"652094923\";\n            if (!orgId) {\n                console.warn(\"ZOHO_ORGANIZATION_ID not set. Reports calls may fail.\");\n                return;\n            }\n            const url = `${this.API_BASE}/books/v3/organizations`;\n            const res = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get(url, {\n                headers: {\n                    \"Authorization\": `Bearer ${token}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                timeout: 15000\n            });\n            const orgs = res.data?.organizations || [];\n            const found = orgs.some((o)=>String(o.organization_id) === String(orgId));\n            if (!found) {\n                console.error(`Provided organization_id=${orgId} not found in Zoho account. Fetched organizations: ${JSON.stringify(orgs)}`);\n            } else {\n                this.organizationValidated = true;\n                console.log(`Validated Zoho organization_id=${orgId}`);\n            }\n        } catch (err) {\n            const status = axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isAxiosError(err) ? err.response?.status : undefined;\n            const data = axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isAxiosError(err) ? err.response?.data : undefined;\n            console.error(\"Failed to validate Zoho organization:\", {\n                status,\n                data,\n                message: err.message\n            });\n        // Do not throw; allow request to proceed but logs will help diagnose\n        }\n    }\n    async applyRateLimit() {\n        const now = Date.now();\n        // Check if we need to wait between requests\n        if (this.lastRequestTime > 0) {\n            const timeSinceLastRequest = now - this.lastRequestTime;\n            if (timeSinceLastRequest < this.MIN_REQUEST_INTERVAL) {\n                const waitTime = this.MIN_REQUEST_INTERVAL - timeSinceLastRequest;\n                console.info(`Rate limiting: waiting ${waitTime}ms before next request`);\n                await new Promise((resolve)=>setTimeout(resolve, waitTime));\n            }\n        }\n        // Check if we've exceeded the per-minute limit\n        if (this.requestCount >= this.MAX_REQUESTS_PER_MINUTE) {\n            const timeSinceFirstRequest = now - this.lastRequestTime;\n            if (timeSinceFirstRequest < 60000) {\n                const waitTime = 60000 - timeSinceFirstRequest;\n                console.warn(`Rate limiting: exceeded ${this.MAX_REQUESTS_PER_MINUTE} requests per minute, waiting ${waitTime}ms`);\n                await new Promise((resolve)=>setTimeout(resolve, waitTime));\n                this.requestCount = 0;\n            } else {\n                // Reset counter if more than 1 minute has passed\n                this.requestCount = 0;\n            }\n        }\n    }\n    async handleRateLimit() {\n        const delay = this.BASE_DELAY * Math.pow(2, this.retryCount);\n        const jitter = Math.random() * 1000; // Add up to 1 second of jitter\n        const totalDelay = delay + jitter;\n        console.warn(`Rate limit backoff: waiting ${totalDelay}ms before retry (attempt ${this.retryCount + 1})`);\n        await new Promise((resolve)=>setTimeout(resolve, totalDelay));\n        // Reset request counters to allow fresh start\n        this.requestCount = 0;\n        this.lastRequestTime = 0;\n    }\n    async getProjects() {\n        try {\n            let allProjects = [];\n            let page = 1;\n            const perPage = 200;\n            while(true){\n                const data = await this.makeRequest(`projects?page=${page}&per_page=${perPage}`);\n                const projects = data.projects?.map((project)=>{\n                    // Log the first project to see available fields\n                    if (page === 1 && allProjects.length === 0) {\n                        console.log(\"Sample Zoho project data:\", JSON.stringify(project, null, 2));\n                    }\n                    return {\n                        project_id: project.project_id,\n                        project_name: project.project_name || project.name || \"\",\n                        description: project.description || \"\",\n                        status: project.status || \"active\",\n                        start_date: project.start_date || \"\",\n                        end_date: project.end_date || \"\",\n                        budget_amount: project.budget_amount || 0,\n                        rate_per_hour: project.rate_per_hour || 0,\n                        customer_id: project.customer_id || \"\",\n                        customer_name: project.customer_name || \"\",\n                        signed_fee: undefined\n                    };\n                }) || [];\n                allProjects = allProjects.concat(projects);\n                // Check if we've reached the end\n                if (projects.length < perPage) {\n                    break;\n                }\n                page++;\n            }\n            console.log(`Fetched ${allProjects.length} projects from Zoho`);\n            return allProjects;\n        } catch (error) {\n            console.error(\"Error fetching projects:\", error);\n            return [];\n        }\n    }\n    async getProjectsWithRevenueBudget() {\n        try {\n            console.log(\"Fetching projects with revenue budget data...\");\n            const projects = await this.getProjects();\n            // Log projects that have revenue_budget data\n            const projectsWithRevenueBudget = projects.filter((project)=>{\n                const hasRevenueBudget = project.signed_fee && project.signed_fee > 0;\n                if (hasRevenueBudget) {\n                    console.log(`Project ${project.project_name} has revenue budget: $${project.signed_fee}`);\n                }\n                return hasRevenueBudget;\n            });\n            console.log(`Found ${projectsWithRevenueBudget.length} projects with revenue budget data`);\n            return projects;\n        } catch (error) {\n            console.error(\"Error fetching projects with revenue budget:\", error);\n            return [];\n        }\n    }\n    async debugProjectFields() {\n        try {\n            console.log(\"Debugging Zoho project fields...\");\n            const data = await this.makeRequest(\"projects?page=1&per_page=5\");\n            if (data.projects && data.projects.length > 0) {\n                console.log(\"Available fields in Zoho project response:\");\n                const sampleProject = data.projects[0];\n                Object.keys(sampleProject).forEach((key)=>{\n                    console.log(`  ${key}: ${sampleProject[key]} (${typeof sampleProject[key]})`);\n                });\n                // Check specifically for revenue_budget\n                if (sampleProject.revenue_budget !== undefined) {\n                    console.log(`âœ… Found revenue_budget field: ${sampleProject.revenue_budget}`);\n                } else {\n                    console.log(\"âŒ revenue_budget field not found in Zoho response\");\n                    console.log(\"Available budget-related fields:\");\n                    Object.keys(sampleProject).forEach((key)=>{\n                        if (key.toLowerCase().includes(\"budget\") || key.toLowerCase().includes(\"revenue\")) {\n                            console.log(`  ${key}: ${sampleProject[key]}`);\n                        }\n                    });\n                }\n            } else {\n                console.log(\"No projects found in Zoho response\");\n            }\n        } catch (error) {\n            console.error(\"Error debugging project fields:\", error);\n        }\n    }\n    async getProjectsWithEstimates() {\n        try {\n            const projects = await this.getProjects();\n            // For the first few projects, try to get estimates to see if that contains the signed fee\n            const projectsWithEstimates = await Promise.all(projects.slice(0, 5).map(async (project)=>{\n                try {\n                    const estimates = await this.getProjectEstimates(project.project_id);\n                    const totalEstimateAmount = estimates.reduce((sum, estimate)=>sum + (estimate.total || 0), 0);\n                    console.log(`Project ${project.project_name} estimates:`, estimates.length, \"total amount:\", totalEstimateAmount);\n                    return {\n                        ...project,\n                        signed_fee: project.signed_fee || totalEstimateAmount || 0\n                    };\n                } catch (error) {\n                    console.error(`Error fetching estimates for project ${project.project_id}:`, error);\n                    return project;\n                }\n            }));\n            // Return all projects, with the first 5 having updated signed fees from estimates\n            return [\n                ...projectsWithEstimates,\n                ...projects.slice(5)\n            ];\n        } catch (error) {\n            console.error(\"Error fetching projects with estimates:\", error);\n            return [];\n        }\n    }\n    async getProjectsWithInvoiceTotals() {\n        try {\n            const [projects, invoices] = await Promise.all([\n                this.getProjects(),\n                this.getInvoices()\n            ]);\n            // Calculate signed fee as total of all invoices for each project\n            const projectsWithInvoiceTotals = projects.map((project)=>{\n                const projectInvoices = invoices.filter((invoice)=>invoice.project_id === project.project_id);\n                const totalInvoiceAmount = projectInvoices.reduce((sum, invoice)=>sum + invoice.amount, 0);\n                console.log(`Project ${project.project_name} invoices:`, projectInvoices.length, \"total amount:\", totalInvoiceAmount);\n                return {\n                    ...project,\n                    signed_fee: project.signed_fee || totalInvoiceAmount || 0\n                };\n            });\n            return projectsWithInvoiceTotals;\n        } catch (error) {\n            console.error(\"Error fetching projects with invoice totals:\", error);\n            return [];\n        }\n    }\n    async getInvoices() {\n        try {\n            console.log(\"\\uD83D\\uDCC4 Fetching invoices from Zoho...\");\n            const data = await this.makeRequest(\"invoices\");\n            const invoices = data.invoices?.map((invoice)=>({\n                    invoice_id: invoice.invoice_id,\n                    project_id: invoice.project_id,\n                    invoice_number: invoice.invoice_number,\n                    date: invoice.date,\n                    amount: invoice.total,\n                    status: invoice.status,\n                    billed_amount: invoice.billed_amount || 0,\n                    unbilled_amount: invoice.unbilled_amount || 0\n                })) || [];\n            // Log invoice counts and details\n            console.log(`ðŸ“Š Zoho invoices fetched: ${invoices.length} total invoices`);\n            if (invoices.length > 0) {\n                const statusCounts = invoices.reduce((acc, inv)=>{\n                    acc[inv.status] = (acc[inv.status] || 0) + 1;\n                    return acc;\n                }, {});\n                console.log(\"\\uD83D\\uDCCB Invoice status breakdown:\", statusCounts);\n                // Log sample invoice data for debugging\n                const sampleInvoice = invoices[0];\n                console.log(\"\\uD83D\\uDCC4 Sample invoice data:\", {\n                    id: sampleInvoice.invoice_id,\n                    number: sampleInvoice.invoice_number,\n                    project: sampleInvoice.project_id,\n                    amount: sampleInvoice.amount,\n                    status: sampleInvoice.status\n                });\n            }\n            return invoices;\n        } catch (error) {\n            console.error(\"Error fetching invoices:\", error);\n            return [];\n        }\n    }\n    async getProjectInvoices(projectId) {\n        try {\n            const data = await this.makeRequest(`projects/${projectId}/invoices`);\n            return data.invoices?.map((invoice)=>({\n                    invoice_id: invoice.invoice_id,\n                    project_id: invoice.project_id,\n                    invoice_number: invoice.invoice_number,\n                    date: invoice.date,\n                    amount: invoice.total,\n                    status: invoice.status,\n                    billed_amount: invoice.billed_amount || 0,\n                    unbilled_amount: invoice.unbilled_amount || 0\n                })) || [];\n        } catch (error) {\n            console.error(\"Error fetching project invoices:\", error);\n            return [];\n        }\n    }\n    async getProjectDetails(projectId) {\n        try {\n            const data = await this.makeRequest(`projects/${projectId}`);\n            console.log(`Project ${projectId} details:`, JSON.stringify(data, null, 2));\n            return data;\n        } catch (error) {\n            console.error(\"Error fetching project details:\", error);\n            return null;\n        }\n    }\n    async getProjectEstimates(projectId) {\n        try {\n            const data = await this.makeRequest(`projects/${projectId}/estimates`);\n            console.log(`Project ${projectId} estimates:`, JSON.stringify(data, null, 2));\n            return data.estimates || [];\n        } catch (error) {\n            console.error(\"Error fetching project estimates:\", error);\n            return [];\n        }\n    }\n    async getProjectContracts(projectId) {\n        try {\n            const data = await this.makeRequest(`projects/${projectId}/contracts`);\n            console.log(`Project ${projectId} contracts:`, JSON.stringify(data, null, 2));\n            return data.contracts || [];\n        } catch (error) {\n            console.error(\"Error fetching project contracts:\", error);\n            return [];\n        }\n    }\n    // New method to get Profit & Loss statement\n    async getProfitAndLoss(startDate, endDate) {\n        try {\n            console.info(`ðŸ“Š Fetching Zoho Profit & Loss for ${startDate} to ${endDate}`);\n            const data = await this.makeRequest(`reports/profitandloss?from_date=${startDate}&to_date=${endDate}`);\n            const sizeBytes = JSON.stringify(data || {}).length;\n            const keys = Object.keys(data || {}).length;\n            console.info(`âœ… Profit & Loss data fetched successfully (keys: ${keys}, bytes: ${sizeBytes})`);\n            if (!data || keys === 0) {\n                console.warn(\"No data for reports/profitandloss. Verify organization ID, date range (2025-01-01 to 2025-08-13), or data in Zoho dashboard.\");\n            }\n            return data;\n        } catch (error) {\n            console.error(\"âŒ Error fetching Profit & Loss:\", error);\n            console.warn(\"\\uD83C\\uDFAD Profit & Loss data unavailable, will use defaults\");\n            return null;\n        }\n    }\n    // New method to get Cash Flow statement\n    async getCashFlow(startDate, endDate) {\n        try {\n            console.info(`ðŸ’° Fetching Zoho Cash Flow for ${startDate} to ${endDate}`);\n            const data = await this.makeRequest(`reports/cashflow?from_date=${startDate}&to_date=${endDate}`);\n            const sizeBytes = JSON.stringify(data || {}).length;\n            const keys = Object.keys(data || {}).length;\n            console.info(`âœ… Cash Flow data fetched successfully (keys: ${keys}, bytes: ${sizeBytes})`);\n            if (!data || keys === 0) {\n                console.warn(\"No data for reports/cashflow. Verify organization ID, date range (2025-01-01 to 2025-08-13), or data in Zoho dashboard.\");\n            }\n            return data;\n        } catch (error) {\n            console.error(\"âŒ Error fetching Cash Flow:\", error);\n            console.warn(\"\\uD83C\\uDFAD Cash Flow data unavailable, will use defaults\");\n            return null;\n        }\n    }\n    // New method to get Balance Sheet\n    async getBalanceSheet(date) {\n        try {\n            console.info(`ðŸ“ˆ Fetching Zoho Balance Sheet for ${date}`);\n            const data = await this.makeRequest(`reports/balancesheet?date=${date}`);\n            const sizeBytes = JSON.stringify(data || {}).length;\n            const keys = Object.keys(data || {}).length;\n            console.info(`âœ… Balance Sheet data fetched successfully (keys: ${keys}, bytes: ${sizeBytes})`);\n            if (!data || keys === 0) {\n                console.warn(\"No data for reports/balancesheet. Verify organization ID, date range (2025-01-01 to 2025-08-13), or data in Zoho dashboard.\");\n            }\n            return data;\n        } catch (error) {\n            console.error(\"âŒ Error fetching Balance Sheet:\", error);\n            console.warn(\"\\uD83C\\uDFAD Balance Sheet data unavailable, will use defaults\");\n            return null;\n        }\n    }\n    // New method to get Chart of Accounts\n    async getChartOfAccounts() {\n        try {\n            const data = await this.makeRequest(\"chartofaccounts\");\n            console.log(\"Chart of Accounts data:\", JSON.stringify(data, null, 2));\n            return data.chartofaccounts || [];\n        } catch (error) {\n            console.error(\"Error fetching Chart of Accounts:\", error);\n            return [];\n        }\n    }\n    // New method to get Journal Entries for a date range\n    async getJournalEntries(startDate, endDate) {\n        try {\n            const data = await this.makeRequest(`journalentries?from_date=${startDate}&to_date=${endDate}`);\n            console.log(\"Journal Entries data:\", JSON.stringify(data, null, 2));\n            return data.journalentries || [];\n        } catch (error) {\n            console.error(\"Error fetching Journal Entries:\", error);\n            return [];\n        }\n    }\n    // New method to get comprehensive financial metrics\n    async getFinancialMetrics(startDate, endDate) {\n        try {\n            console.info(`ðŸ’° Fetching Zoho financial metrics for ${startDate} to ${endDate}`);\n            const [plData, cfData, bsData] = await Promise.allSettled([\n                this.getProfitAndLoss(startDate, endDate),\n                this.getCashFlow(startDate, endDate),\n                this.getBalanceSheet(endDate)\n            ]);\n            // Log raw response status and body length for each report\n            console.info(\"\\uD83D\\uDCCA Financial reports raw response details:\", {\n                profitLoss: {\n                    status: plData.status,\n                    bodyLength: plData.status === \"fulfilled\" ? JSON.stringify(plData.value || {}).length : \"N/A\",\n                    hasData: plData.status === \"fulfilled\" && plData.value && Object.keys(plData.value || {}).length > 0\n                },\n                cashFlow: {\n                    status: cfData.status,\n                    bodyLength: cfData.status === \"fulfilled\" ? JSON.stringify(cfData.value || {}).length : \"N/A\",\n                    hasData: cfData.status === \"fulfilled\" && cfData.value && Object.keys(cfData.value || {}).length > 0\n                },\n                balanceSheet: {\n                    status: bsData.status,\n                    bodyLength: bsData.status === \"fulfilled\" ? JSON.stringify(bsData.value || {}).length : \"N/A\",\n                    hasData: bsData.status === \"fulfilled\" && bsData.value && Object.keys(bsData.value || {}).length > 0\n                }\n            });\n            // Check for 404 errors and log specific warnings\n            if (plData.status === \"rejected\") {\n                const error = plData.reason;\n                if (error?.response?.status === 404) {\n                    console.warn(\"âš ï¸ Profit & Loss returned 404 - Invalid endpoint - check Zoho API docs\");\n                } else {\n                    console.warn(\"âš ï¸ Profit & Loss data failed:\", plData.reason);\n                }\n            }\n            if (cfData.status === \"rejected\") {\n                const error = cfData.reason;\n                if (error?.response?.status === 404) {\n                    console.warn(\"âš ï¸ Cash Flow returned 404 - Invalid endpoint - check Zoho API docs\");\n                } else {\n                    console.warn(\"âš ï¸ Cash Flow data failed:\", cfData.reason);\n                }\n            }\n            if (bsData.status === \"rejected\") {\n                const error = bsData.reason;\n                if (error?.response?.status === 404) {\n                    console.warn(\"âš ï¸ Balance Sheet returned 404 - Invalid endpoint - check Zoho API docs\");\n                } else {\n                    console.warn(\"âš ï¸ Balance Sheet data failed:\", bsData.reason);\n                }\n            }\n            // Extract financial metrics from the responses with fallbacks\n            const revenue = plData.status === \"fulfilled\" ? plData.value?.revenue?.total || 0 : 0;\n            const expenses = plData.status === \"fulfilled\" ? plData.value?.expenses?.total || 0 : 0;\n            const grossProfit = revenue - expenses;\n            // Calculate net profit (may need adjustment based on actual Zoho response structure)\n            const operatingExpenses = plData.status === \"fulfilled\" ? plData.value?.operating_expenses?.total || 0 : 0;\n            const netProfit = grossProfit - operatingExpenses;\n            const operatingIncome = grossProfit - operatingExpenses;\n            // Extract cash flow data\n            const cashFlow = cfData.status === \"fulfilled\" ? cfData.value?.net_cash_flow || 0 : 0;\n            const accountsReceivable = bsData.status === \"fulfilled\" ? bsData.value?.current_assets?.accounts_receivable || 0 : 0;\n            const accountsPayable = bsData.status === \"fulfilled\" ? bsData.value?.current_liabilities?.accounts_payable || 0 : 0;\n            const cashBalance = bsData.status === \"fulfilled\" ? bsData.value?.current_assets?.cash_and_bank || 0 : 0;\n            // Log which data sources succeeded/failed\n            console.info(\"\\uD83D\\uDCCA Financial metrics data sources:\", {\n                profitLoss: plData.status === \"fulfilled\" ? \"âœ…\" : \"âŒ\",\n                cashFlow: cfData.status === \"fulfilled\" ? \"âœ…\" : \"âŒ\",\n                balanceSheet: bsData.status === \"fulfilled\" ? \"âœ…\" : \"âŒ\"\n            });\n            return {\n                revenue,\n                expenses,\n                grossProfit,\n                netProfit,\n                operatingIncome,\n                cashFlow,\n                accountsReceivable,\n                accountsPayable,\n                cashBalance\n            };\n        } catch (error) {\n            console.error(\"âŒ Error fetching financial metrics:\", error);\n            console.warn(\"\\uD83C\\uDFAD Returning default financial metrics due to API failure\");\n            // Return default values if API calls fail\n            return {\n                revenue: 0,\n                expenses: 0,\n                grossProfit: 0,\n                netProfit: 0,\n                operatingIncome: 0,\n                cashFlow: 0,\n                accountsReceivable: 0,\n                accountsPayable: 0,\n                cashBalance: 0\n            };\n        }\n    }\n    // Method to manually refresh token (for testing)\n    async forceRefreshToken() {\n        this.accessToken = null;\n        this.tokenExpiry = 0;\n        this.lastRefreshTime = Date.now(); // Track manual refresh time\n        return await this.getAccessToken();\n    }\n    // Get token status for debugging\n    getTokenStatus() {\n        const now = Date.now();\n        return {\n            hasToken: !!this.accessToken,\n            expiresIn: this.tokenExpiry - now,\n            isExpired: now >= this.tokenExpiry\n        };\n    }\n    // Method to get auto-refresh status\n    getAutoRefreshStatus() {\n        const now = Date.now();\n        const timeSinceLastRefresh = now - this.lastRefreshTime;\n        const nextRefreshIn = Math.max(0, this.AUTO_REFRESH_INTERVAL - timeSinceLastRefresh);\n        return {\n            isActive: !!this.autoRefreshTimer,\n            nextRefreshIn\n        };\n    }\n    // Public method to start auto-refresh\n    enableAutoRefresh() {\n        this._startAutoRefresh();\n    }\n    // Public method to stop auto-refresh\n    disableAutoRefresh() {\n        this._stopAutoRefresh();\n    }\n    // Public method to get comprehensive status\n    getStatus() {\n        return {\n            ...this.getTokenStatus(),\n            autoRefresh: this.getAutoRefreshStatus()\n        };\n    }\n}\nconst zohoService = new ZohoService();\n// Export the functions that are being imported in page.tsx\nconst fetchProjects = async ()=>{\n    try {\n        console.log(\"Client: Fetching projects from API\");\n        const response = await fetch(\"/api/projects\");\n        const result = await response.json();\n        if (result.success) {\n            console.log(\"Client: Successfully fetched\", result.count, \"projects\");\n            return result.data;\n        } else {\n            console.error(\"Client: API returned error:\", result.error);\n            throw new Error(result.error);\n        }\n    } catch (error) {\n        console.error(\"Client: Error fetching projects:\", error);\n        throw error;\n    }\n};\nconst fetchInvoices = async ()=>{\n    try {\n        console.log(\"Client: Fetching invoices from API\");\n        const response = await fetch(\"/api/invoices\");\n        const result = await response.json();\n        if (result.success) {\n            console.log(\"Client: Successfully fetched\", result.count, \"invoices\");\n            return result.data;\n        } else {\n            console.error(\"Client: API returned error:\", result.error);\n            throw new Error(result.error);\n        }\n    } catch (error) {\n        console.error(\"Client: Error fetching invoices:\", error);\n        throw error;\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0Y3TixRQUFRQyxHQUFHLENBQUM7UUFDWixNQUFNeUIsV0FBVyxNQUFNb00sTUFBTTtRQUM3QixNQUFNQyxTQUFTLE1BQU1yTSxTQUFTc00sSUFBSTtRQUVsQyxJQUFJRCxPQUFPRSxPQUFPLEVBQUU7WUFDbEJqTyxRQUFRQyxHQUFHLENBQUMsZ0NBQWdDOE4sT0FBT0csS0FBSyxFQUFFO1lBQzFELE9BQU9ILE9BQU9uTSxJQUFJO1FBQ3BCLE9BQU87WUFDTDVCLFFBQVFPLEtBQUssQ0FBQywrQkFBK0J3TixPQUFPeE4sS0FBSztZQUN6RCxNQUFNLElBQUlhLE1BQU0yTSxPQUFPeE4sS0FBSztRQUM5QjtJQUNGLEVBQUUsT0FBT0EsT0FBTztRQUNkUCxRQUFRTyxLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxNQUFNQTtJQUNSO0FBQ0YsRUFBRTtBQUVLLE1BQU00TixnQkFBZ0I7SUFDM0IsSUFBSTtRQUNGbk8sUUFBUUMsR0FBRyxDQUFDO1FBQ1osTUFBTXlCLFdBQVcsTUFBTW9NLE1BQU07UUFDN0IsTUFBTUMsU0FBUyxNQUFNck0sU0FBU3NNLElBQUk7UUFFbEMsSUFBSUQsT0FBT0UsT0FBTyxFQUFFO1lBQ2xCak8sUUFBUUMsR0FBRyxDQUFDLGdDQUFnQzhOLE9BQU9HLEtBQUssRUFBRTtZQUMxRCxPQUFPSCxPQUFPbk0sSUFBSTtRQUNwQixPQUFPO1lBQ0w1QixRQUFRTyxLQUFLLENBQUMsK0JBQStCd04sT0FBT3hOLEtBQUs7WUFDekQsTUFBTSxJQUFJYSxNQUFNMk0sT0FBT3hOLEtBQUs7UUFDOUI7SUFDRixFQUFFLE9BQU9BLE9BQU87UUFDZFAsUUFBUU8sS0FBSyxDQUFDLG9DQUFvQ0E7UUFDbEQsTUFBTUE7SUFDUjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly96b2hvLWJpbGxpbmctcGxhdGZvcm0vLi9saWIvem9oby50cz9lNzBjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XHJcbmltcG9ydCBwTGltaXQgZnJvbSAncC1saW1pdCc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFpvaG9Qcm9qZWN0IHtcclxuICBwcm9qZWN0X2lkOiBzdHJpbmc7XHJcbiAgcHJvamVjdF9uYW1lOiBzdHJpbmc7IC8vIENoYW5nZWQgZnJvbSBuYW1lIHRvIHByb2plY3RfbmFtZVxyXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG4gIHN0YXR1czogc3RyaW5nO1xyXG4gIHN0YXJ0X2RhdGU6IHN0cmluZztcclxuICBlbmRfZGF0ZT86IHN0cmluZztcclxuICBidWRnZXRfYW1vdW50PzogbnVtYmVyO1xyXG4gIHJhdGVfcGVyX2hvdXI/OiBudW1iZXI7XHJcbiAgY3VzdG9tZXJfaWQ6IHN0cmluZztcclxuICBjdXN0b21lcl9uYW1lOiBzdHJpbmc7XHJcbiAgc2lnbmVkX2ZlZT86IG51bWJlcjsgLy8gQWRkZWQgZm9yIFNpZ25lZCBGZWUgZnJvbSBab2hvXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgWm9ob0ludm9pY2Uge1xyXG4gIGludm9pY2VfaWQ6IHN0cmluZztcclxuICBwcm9qZWN0X2lkOiBzdHJpbmc7XHJcbiAgaW52b2ljZV9udW1iZXI6IHN0cmluZztcclxuICBkYXRlOiBzdHJpbmc7XHJcbiAgYW1vdW50OiBudW1iZXI7XHJcbiAgc3RhdHVzOiBzdHJpbmc7XHJcbiAgYmlsbGVkX2Ftb3VudDogbnVtYmVyO1xyXG4gIHVuYmlsbGVkX2Ftb3VudDogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVG9rZW5SZXNwb25zZSB7XHJcbiAgYWNjZXNzX3Rva2VuOiBzdHJpbmc7XHJcbiAgZXhwaXJlc19pbjogbnVtYmVyO1xyXG4gIGFwaV9kb21haW46IHN0cmluZztcclxuICB0b2tlbl90eXBlOiBzdHJpbmc7XHJcbiAgcmVmcmVzaF90b2tlbj86IHN0cmluZztcclxufVxyXG5cclxuY2xhc3MgWm9ob1NlcnZpY2Uge1xyXG4gIHByaXZhdGUgYWNjZXNzVG9rZW46IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gIHByaXZhdGUgdG9rZW5FeHBpcnk6IG51bWJlciA9IDA7XHJcbiAgcHJpdmF0ZSByZWZyZXNoUHJvbWlzZTogUHJvbWlzZTxzdHJpbmc+IHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBUT0tFTl9SRUZSRVNIX0JVRkZFUiA9IDEwICogNjAgKiAxMDAwOyAvLyAxMCBtaW51dGVzIGJ1ZmZlciAoaW5jcmVhc2VkIGZvciBiZXR0ZXIgY2FjaGluZylcclxuICBwcml2YXRlIGF1dG9SZWZyZXNoVGltZXI6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBBVVRPX1JFRlJFU0hfSU5URVJWQUwgPSA0NSAqIDYwICogMTAwMDsgLy8gNDUgbWludXRlc1xyXG4gIHByaXZhdGUgbGFzdFJlZnJlc2hUaW1lOiBudW1iZXIgPSAwOyAvLyBUcmFjayB3aGVuIGF1dG8tcmVmcmVzaCB3YXMgbGFzdCB0cmlnZ2VyZWRcclxuICBwcml2YXRlIHJlYWRvbmx5IEFDQ09VTlRTX0JBU0UgPSBwcm9jZXNzLmVudi5aT0hPX0FDQ09VTlRTX0JBU0UgfHwgJ2h0dHBzOi8vYWNjb3VudHMuem9oby5jb20nO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgQVBJX0JBU0UgPSBwcm9jZXNzLmVudi5aT0hPX0FQSV9CQVNFIHx8ICdodHRwczovL3d3dy56b2hvYXBpcy5jb20nO1xyXG4gIHByaXZhdGUgb3JnYW5pemF0aW9uVmFsaWRhdGVkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgXHJcbiAgLy8gUmF0ZSBsaW1pdGluZyBwcm9wZXJ0aWVzXHJcbiAgcHJpdmF0ZSByZXF1ZXN0Q291bnQ6IG51bWJlciA9IDA7XHJcbiAgcHJpdmF0ZSBsYXN0UmVxdWVzdFRpbWU6IG51bWJlciA9IDA7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBNQVhfUkVRVUVTVFNfUEVSX01JTlVURSA9IDgwOyAvLyBDb25zZXJ2YXRpdmUgbGltaXQgKFpvaG8gYWxsb3dzIDEwMCwgd2UgdXNlIDgwKVxyXG4gIHByaXZhdGUgcmVhZG9ubHkgTUlOX1JFUVVFU1RfSU5URVJWQUwgPSAyMDAwOyAvLyAyIHNlY29uZHMgYmV0d2VlbiByZXF1ZXN0cyAocmVkdWNlZCBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlKVxyXG4gIHByaXZhdGUgcmV0cnlDb3VudDogbnVtYmVyID0gMDtcclxuICBwcml2YXRlIHJlYWRvbmx5IE1BWF9SRVRSSUVTID0gNTsgLy8gSW5jcmVhc2VkIGZyb20gMyB0byA1XHJcbiAgcHJpdmF0ZSByZWFkb25seSBCQVNFX0RFTEFZID0gNTAwMDsgLy8gSW5jcmVhc2VkIGZyb20gMjAwMCB0byA1MDAwbXMgYmFzZSBkZWxheSBmb3IgZXhwb25lbnRpYWwgYmFja29mZlxyXG4gIHByaXZhdGUgY2FjaGVkQWNjZXNzVG9rZW46IHN0cmluZyB8IG51bGwgPSBudWxsOyAvLyBGYWxsYmFjayBjYWNoZWQgdG9rZW5cclxuICBcclxuICAvLyBwLWxpbWl0IHJhdGUgbGltaXRlciBmb3IgY29uY3VycmVudCBBUEkgY2FsbHNcclxuICBwcml2YXRlIHJlYWRvbmx5IHJhdGVMaW1pdGVyID0gcExpbWl0KDUwKTsgLy8gTGltaXQgdG8gNTAgY29uY3VycmVudCBjYWxsc1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIC8vIFN0YXJ0IGF1dG9tYXRpYyB0b2tlbiByZWZyZXNoXHJcbiAgICB0aGlzLl9zdGFydEF1dG9SZWZyZXNoKCk7XHJcbiAgICBjb25zb2xlLmxvZyhgWm9obyBBUEkgYmFzZTogJHt0aGlzLkFQSV9CQVNFfSB8IEFjY291bnRzIGJhc2U6ICR7dGhpcy5BQ0NPVU5UU19CQVNFfWApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfc3RhcnRBdXRvUmVmcmVzaCgpOiB2b2lkIHtcclxuICAgIC8vIENsZWFyIGFueSBleGlzdGluZyB0aW1lclxyXG4gICAgaWYgKHRoaXMuYXV0b1JlZnJlc2hUaW1lcikge1xyXG4gICAgICBjbGVhckludGVydmFsKHRoaXMuYXV0b1JlZnJlc2hUaW1lcik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2V0IHVwIGF1dG9tYXRpYyByZWZyZXNoIGV2ZXJ5IDQ1IG1pbnV0ZXNcclxuICAgIHRoaXMuYXV0b1JlZnJlc2hUaW1lciA9IHNldEludGVydmFsKGFzeW5jICgpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnQXV0by1yZWZyZXNoaW5nIFpvaG8gdG9rZW4gKDQ1LW1pbnV0ZSBpbnRlcnZhbCkuLi4nKTtcclxuICAgICAgICB0aGlzLmxhc3RSZWZyZXNoVGltZSA9IERhdGUubm93KCk7IC8vIFRyYWNrIHdoZW4gcmVmcmVzaCB3YXMgdHJpZ2dlcmVkXHJcbiAgICAgICAgYXdhaXQgdGhpcy5mb3JjZVJlZnJlc2hUb2tlbigpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRvLXJlZnJlc2ggY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0F1dG8tcmVmcmVzaCBmYWlsZWQ6JywgZXJyb3IpO1xyXG4gICAgICB9XHJcbiAgICB9LCB0aGlzLkFVVE9fUkVGUkVTSF9JTlRFUlZBTCk7XHJcblxyXG4gICAgLy8gU2V0IGluaXRpYWwgcmVmcmVzaCB0aW1lXHJcbiAgICB0aGlzLmxhc3RSZWZyZXNoVGltZSA9IERhdGUubm93KCk7XHJcbiAgICBjb25zb2xlLmxvZygnQXV0b21hdGljIFpvaG8gdG9rZW4gcmVmcmVzaCBzdGFydGVkIChldmVyeSA0NSBtaW51dGVzKScpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfc3RvcEF1dG9SZWZyZXNoKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuYXV0b1JlZnJlc2hUaW1lcikge1xyXG4gICAgICBjbGVhckludGVydmFsKHRoaXMuYXV0b1JlZnJlc2hUaW1lcik7XHJcbiAgICAgIHRoaXMuYXV0b1JlZnJlc2hUaW1lciA9IG51bGw7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRvbWF0aWMgWm9obyB0b2tlbiByZWZyZXNoIHN0b3BwZWQnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2V0QWNjZXNzVG9rZW4oKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICAgIGNvbnN0IHRpbWVVbnRpbEV4cGlyeSA9IHRoaXMudG9rZW5FeHBpcnkgLSBub3c7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGEgdmFsaWQgdG9rZW4gd2l0aCBzdWZmaWNpZW50IGJ1ZmZlciB0aW1lXHJcbiAgICAgIGlmICh0aGlzLmFjY2Vzc1Rva2VuICYmIHRpbWVVbnRpbEV4cGlyeSA+IHRoaXMuVE9LRU5fUkVGUkVTSF9CVUZGRVIgJiYgcHJvY2Vzcy5lbnYuWk9IT19GT1JDRV9SRUZSRVNIICE9PSAndHJ1ZScpIHtcclxuICAgICAgICBjb25zdCBtaW51dGVzTGVmdCA9IE1hdGgucm91bmQodGltZVVudGlsRXhwaXJ5IC8gNjAwMDApO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5SQIFVzaW5nIGNhY2hlZCB0b2tlbiAoZXhwaXJlcyBpbiAke21pbnV0ZXNMZWZ0fSBtaW51dGVzKWApO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBMb2cgdG9rZW4gc3RhdHVzIGZvciBkZWJ1Z2dpbmdcclxuICAgICAgaWYgKHRoaXMuYWNjZXNzVG9rZW4gJiYgdGltZVVudGlsRXhwaXJ5ID4gMCkge1xyXG4gICAgICAgIGNvbnN0IG1pbnV0ZXNMZWZ0ID0gTWF0aC5yb3VuZCh0aW1lVW50aWxFeHBpcnkgLyA2MDAwMCk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBUb2tlbiBleHBpcmVzIHNvb24gKCR7bWludXRlc0xlZnR9IG1pbnV0ZXMpLCByZWZyZXNoaW5nIHByb2FjdGl2ZWx5YCk7XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5hY2Nlc3NUb2tlbikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIFRva2VuIGV4cGlyZWQsIHJlZnJlc2hpbmcuLi4nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZygn8J+GlSBObyB0b2tlbiBhdmFpbGFibGUsIG9idGFpbmluZyBuZXcgb25lLi4uJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCdUb2tlbiBleHBpcmVkIG9yIG1pc3NpbmcsIHJlZnJlc2hpbmcuLi4nKTtcclxuICAgICAgXHJcbiAgICAgIC8vIENsZWFyIGFueSBleGlzdGluZyB0b2tlblxyXG4gICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gbnVsbDtcclxuICAgICAgdGhpcy50b2tlbkV4cGlyeSA9IDA7XHJcblxyXG4gICAgICBpZiAoIXByb2Nlc3MuZW52LlpPSE9fQ0xJRU5UX0lEIHx8ICFwcm9jZXNzLmVudi5aT0hPX0NMSUVOVF9TRUNSRVQgfHwgIXByb2Nlc3MuZW52LlpPSE9fUkVGUkVTSF9UT0tFTikge1xyXG4gICAgICAgIGNvbnN0IG1pc3NpbmdWYXJzID0gW107XHJcbiAgICAgICAgaWYgKCFwcm9jZXNzLmVudi5aT0hPX0NMSUVOVF9JRCkgbWlzc2luZ1ZhcnMucHVzaCgnWk9IT19DTElFTlRfSUQnKTtcclxuICAgICAgICBpZiAoIXByb2Nlc3MuZW52LlpPSE9fQ0xJRU5UX1NFQ1JFVCkgbWlzc2luZ1ZhcnMucHVzaCgnWk9IT19DTElFTlRfU0VDUkVUJyk7XHJcbiAgICAgICAgaWYgKCFwcm9jZXNzLmVudi5aT0hPX1JFRlJFU0hfVE9LRU4pIG1pc3NpbmdWYXJzLnB1c2goJ1pPSE9fUkVGUkVTSF9UT0tFTicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyByZXF1aXJlZCBab2hvIGVudmlyb25tZW50IHZhcmlhYmxlczogJHttaXNzaW5nVmFycy5qb2luKCcsICcpfWApO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIEVuc3VyZSBvbmx5IG9uZSByZWZyZXNoIGhhcHBlbnMgYXQgYSB0aW1lIGFjcm9zcyBjb25jdXJyZW50IHJlcXVlc3RzXHJcbiAgICAgIGlmICghdGhpcy5yZWZyZXNoUHJvbWlzZSkge1xyXG4gICAgICAgIHRoaXMucmVmcmVzaFByb21pc2UgPSB0aGlzLl9wZXJmb3JtVG9rZW5SZWZyZXNoV2l0aEJhY2tvZmYoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCB0aGlzLnJlZnJlc2hQcm9taXNlO1xyXG4gICAgICAvLyBDbGVhciB0aGUgaW4tZmxpZ2h0IHByb21pc2UgYWZ0ZXIgY29tcGxldGlvblxyXG4gICAgICB0aGlzLnJlZnJlc2hQcm9taXNlID0gbnVsbDtcclxuICAgICAgcmV0dXJuIHRva2VuO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVmcmVzaGluZyBab2hvIGFjY2VzcyB0b2tlbjonLCBlcnJvcik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBMb2cgc3BlY2lmaWMgZXJyb3IgZGV0YWlscyBmb3IgZGVidWdnaW5nXHJcbiAgICAgIGlmIChheGlvcy5pc0F4aW9zRXJyb3IoZXJyb3IpKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignQXhpb3MgZXJyb3IgZGV0YWlsczonLCB7XHJcbiAgICAgICAgICBzdGF0dXM6IGVycm9yLnJlc3BvbnNlPy5zdGF0dXMsXHJcbiAgICAgICAgICBzdGF0dXNUZXh0OiBlcnJvci5yZXNwb25zZT8uc3RhdHVzVGV4dCxcclxuICAgICAgICAgIGRhdGE6IGVycm9yLnJlc3BvbnNlPy5kYXRhLFxyXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcclxuICAgICAgICAgIGhlYWRlcnM6IGVycm9yLnJlc3BvbnNlPy5oZWFkZXJzIC8vIExvZyBoZWFkZXJzIGZvciByYXRlIGxpbWl0IGluZm9cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2cgcmF0ZSBsaW1pdCBoZWFkZXJzIGlmIGF2YWlsYWJsZVxyXG4gICAgICAgIGlmIChlcnJvci5yZXNwb25zZT8uaGVhZGVycykge1xyXG4gICAgICAgICAgY29uc3QgcmF0ZUxpbWl0SGVhZGVycyA9IHtcclxuICAgICAgICAgICAgJ1gtUmF0ZS1MaW1pdCc6IGVycm9yLnJlc3BvbnNlLmhlYWRlcnNbJ3gtcmF0ZS1saW1pdCddLFxyXG4gICAgICAgICAgICAnWC1SYXRlLUxpbWl0LVJlbWFpbmluZyc6IGVycm9yLnJlc3BvbnNlLmhlYWRlcnNbJ3gtcmF0ZS1saW1pdC1yZW1haW5pbmcnXSxcclxuICAgICAgICAgICAgJ1gtUmF0ZS1MaW1pdC1SZXNldCc6IGVycm9yLnJlc3BvbnNlLmhlYWRlcnNbJ3gtcmF0ZS1saW1pdC1yZXNldCddLFxyXG4gICAgICAgICAgICAnUmV0cnktQWZ0ZXInOiBlcnJvci5yZXNwb25zZS5oZWFkZXJzWydyZXRyeS1hZnRlciddXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignUmF0ZSBsaW1pdCBoZWFkZXJzOicsIHJhdGVMaW1pdEhlYWRlcnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gVHJ5IHRvIGZhbGwgYmFjayB0byBjYWNoZWQgdG9rZW4gaWYgYXZhaWxhYmxlXHJcbiAgICAgIGlmICh0aGlzLmNhY2hlZEFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdGYWxsaW5nIGJhY2sgdG8gY2FjaGVkIGFjY2VzcyB0b2tlbiBkdWUgdG8gcmVmcmVzaCBmYWlsdXJlJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGVkQWNjZXNzVG9rZW47XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGF1dGhlbnRpY2F0ZSB3aXRoIFpvaG86ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQZXJmb3JtIHRoZSB0b2tlbiByZWZyZXNoIHdpdGggZm9ybS1lbmNvZGVkIGJvZHkgYW5kIGltcHJvdmVkIGV4cG9uZW50aWFsIGJhY2tvZmZcclxuICBwcml2YXRlIGFzeW5jIF9wZXJmb3JtVG9rZW5SZWZyZXNoV2l0aEJhY2tvZmYoKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGNvbnN0IG1heEF0dGVtcHRzID0gNTsgLy8gSW5jcmVhc2VkIGZyb20gMyB0byA1XHJcbiAgICBmb3IgKGxldCBhdHRlbXB0ID0gMTsgYXR0ZW1wdCA8PSBtYXhBdHRlbXB0czsgYXR0ZW1wdCsrKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XHJcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdyZWZyZXNoX3Rva2VuJywgcHJvY2Vzcy5lbnYuWk9IT19SRUZSRVNIX1RPS0VOIHx8ICcnKTtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NsaWVudF9pZCcsIHByb2Nlc3MuZW52LlpPSE9fQ0xJRU5UX0lEIHx8ICcnKTtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NsaWVudF9zZWNyZXQnLCBwcm9jZXNzLmVudi5aT0hPX0NMSUVOVF9TRUNSRVQgfHwgJycpO1xyXG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZ3JhbnRfdHlwZScsICdyZWZyZXNoX3Rva2VuJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdDxUb2tlblJlc3BvbnNlPihgJHt0aGlzLkFDQ09VTlRTX0JBU0V9L29hdXRoL3YyL3Rva2VuYCwgZm9ybURhdGEsIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnIH0sXHJcbiAgICAgICAgICB0aW1lb3V0OiAxNTAwMCxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5kYXRhLmFjY2Vzc190b2tlbikge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhY2Nlc3MgdG9rZW4gcmVjZWl2ZWQgZnJvbSBab2hvJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDYWNoZSB0aGUgc3VjY2Vzc2Z1bCB0b2tlbiBhbmQgZXhwaXJ5IGluZm9ybWF0aW9uXHJcbiAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IHJlc3BvbnNlLmRhdGEuYWNjZXNzX3Rva2VuO1xyXG4gICAgICAgIHRoaXMudG9rZW5FeHBpcnkgPSBEYXRlLm5vdygpICsgKHJlc3BvbnNlLmRhdGEuZXhwaXJlc19pbiAqIDEwMDApO1xyXG4gICAgICAgIHRoaXMubGFzdFJlZnJlc2hUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDYWNoZSB0aGUgc3VjY2Vzc2Z1bCB0b2tlbiBhcyBmYWxsYmFja1xyXG4gICAgICAgIHRoaXMuY2FjaGVkQWNjZXNzVG9rZW4gPSByZXNwb25zZS5kYXRhLmFjY2Vzc190b2tlbjtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coYFRva2VuIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHkuIEV4cGlyZXMgaW4gJHtNYXRoLnJvdW5kKHJlc3BvbnNlLmRhdGEuZXhwaXJlc19pbiAvIDYwKX0gbWludXRlc2ApO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdab2hvIHRva2VuIHJlZnJlc2ggcmVzcG9uc2U6JywgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTG9nIHRva2VuIGNhY2hpbmcgZGV0YWlsc1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5SQIFRva2VuIGNhY2hlZDogYWNjZXNzX3Rva2VuPSR7dGhpcy5hY2Nlc3NUb2tlbi5zdWJzdHJpbmcoMCwgMTApfS4uLiwgZXhwaXJlc19pbj0ke3Jlc3BvbnNlLmRhdGEuZXhwaXJlc19pbn1zLCBleHBpcnk9JHtuZXcgRGF0ZSh0aGlzLnRva2VuRXhwaXJ5KS50b0lTT1N0cmluZygpfWApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFZhbGlkYXRlIHNjb3BlcyBvbiByZWZyZXNoZWQgdG9rZW5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3Qgc2NvcGVJbmZvID0gYXdhaXQgdGhpcy5jaGVja1Rva2VuU2NvcGVzKHRoaXMuYWNjZXNzVG9rZW4pO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1pvaG8gZ3JhbnRlZCBzY29wZXM6Jywgc2NvcGVJbmZvPy5zY29wZSB8fCAndW5rbm93bicpO1xyXG4gICAgICAgICAgaWYgKHR5cGVvZiBzY29wZUluZm8/LnNjb3BlID09PSAnc3RyaW5nJyAmJiAhc2NvcGVJbmZvLnNjb3BlLmluY2x1ZGVzKCdab2hvQm9va3MucmVwb3J0cy5SRUFEJykpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTWlzc2luZyBab2hvQm9va3MucmVwb3J0cy5SRUFEIHNjb3BlLiBSZWdlbmVyYXRlIHRva2VuLicpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKHNjb3BlRXJyKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdab2hvIHRva2VuIHNjb3BlIHZlcmlmaWNhdGlvbiBmYWlsZWQ6JywgKHNjb3BlRXJyIGFzIEVycm9yKT8ubWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuO1xyXG4gICAgICB9IGNhdGNoIChlcnI6IGFueSkge1xyXG4gICAgICAgIC8vIElmIHJhdGUtbGltaXRlZCBieSBab2hvIGR1cmluZyB0b2tlbiByZWZyZXNoLCBpbXBsZW1lbnQgZXhwb25lbnRpYWwgYmFja29mZlxyXG4gICAgICAgIGNvbnN0IGlzQXhpb3MgPSBheGlvcy5pc0F4aW9zRXJyb3IoZXJyKTtcclxuICAgICAgICBjb25zdCBzdGF0dXMgPSBpc0F4aW9zID8gZXJyLnJlc3BvbnNlPy5zdGF0dXMgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBpc0F4aW9zID8gKGVyci5yZXNwb25zZT8uZGF0YSBhcyBhbnkpPy5lcnJvcl9kZXNjcmlwdGlvbiA6IHVuZGVmaW5lZDtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoc3RhdHVzID09PSA0MDAgJiYgdHlwZW9mIGRlc2NyaXB0aW9uID09PSAnc3RyaW5nJyAmJiBkZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0b28gbWFueSByZXF1ZXN0cycpKSB7XHJcbiAgICAgICAgICAvLyBFeHBvbmVudGlhbCBiYWNrb2ZmOiBkZWxheSA9IGJhc2UgKiAyXmF0dGVtcHRcclxuICAgICAgICAgIGNvbnN0IGRlbGF5TXMgPSB0aGlzLkJBU0VfREVMQVkgKiBNYXRoLnBvdygyLCBhdHRlbXB0IC0gMSkgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKTtcclxuICAgICAgICAgIGNvbnNvbGUud2FybihgWm9obyB0b2tlbiByZWZyZXNoIHJhdGUtbGltaXRlZCAoYXR0ZW1wdCAke2F0dGVtcHR9LyR7bWF4QXR0ZW1wdHN9KS4gV2FpdGluZyAke2RlbGF5TXN9bXMgYmVmb3JlIHJldHJ5LmApO1xyXG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5TXMpKTtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBGb3Igb3RoZXIgZXJyb3JzLCBkbyBub3QgcmV0cnkgZW5kbGVzc2x5XHJcbiAgICAgICAgaWYgKGF0dGVtcHQgPT09IG1heEF0dGVtcHRzKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBab2hvIHRva2VuIHJlZnJlc2ggZmFpbGVkIGFmdGVyICR7bWF4QXR0ZW1wdHN9IGF0dGVtcHRzOmAsIGVycik7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1pvaG8gdG9rZW4gcmVmcmVzaCByYXRlLWxpbWl0ZWQuIENoZWNrIGRhaWx5IEFQSSBsaW1pdHMgb3IgdG9rZW4gdmFsaWRpdHkuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IGVycjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdab2hvIHRva2VuIHJlZnJlc2ggZmFpbGVkIGFmdGVyIG1heGltdW0gcmV0cmllcycpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyByZWZyZXNoQWNjZXNzVG9rZW4oKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdSZWZyZXNoaW5nIFpvaG8gYWNjZXNzIHRva2VuLi4uJyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDcmVhdGUgZm9ybSBkYXRhIGZvciB0aGUgcmVxdWVzdFxyXG4gICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICAgICAgZm9ybURhdGEuYXBwZW5kKCdyZWZyZXNoX3Rva2VuJywgcHJvY2Vzcy5lbnYuWk9IT19SRUZSRVNIX1RPS0VOIHx8ICcnKTtcclxuICAgICAgZm9ybURhdGEuYXBwZW5kKCdjbGllbnRfaWQnLCBwcm9jZXNzLmVudi5aT0hPX0NMSUVOVF9JRCB8fCAnJyk7XHJcbiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnY2xpZW50X3NlY3JldCcsIHByb2Nlc3MuZW52LlpPSE9fQ0xJRU5UX1NFQ1JFVCB8fCAnJyk7XHJcbiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZ3JhbnRfdHlwZScsICdyZWZyZXNoX3Rva2VuJyk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3Q8VG9rZW5SZXNwb25zZT4oYCR7dGhpcy5BQ0NPVU5UU19CQVNFfS9vYXV0aC92Mi90b2tlbmAsIGZvcm1EYXRhLCB7XHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gQ2FjaGUgdGhlIHN1Y2Nlc3NmdWwgdG9rZW4gYW5kIGV4cGlyeSBpbmZvcm1hdGlvblxyXG4gICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gcmVzcG9uc2UuZGF0YS5hY2Nlc3NfdG9rZW47XHJcbiAgICAgIHRoaXMudG9rZW5FeHBpcnkgPSBEYXRlLm5vdygpICsgKHJlc3BvbnNlLmRhdGEuZXhwaXJlc19pbiAqIDEwMDApO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2FjaGUgdGhlIHN1Y2Nlc3NmdWwgdG9rZW4gYXMgZmFsbGJhY2tcclxuICAgICAgdGhpcy5jYWNoZWRBY2Nlc3NUb2tlbiA9IHJlc3BvbnNlLmRhdGEuYWNjZXNzX3Rva2VuO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYFRva2VuIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHkuIEV4cGlyZXMgaW4gJHtNYXRoLnJvdW5kKHJlc3BvbnNlLmRhdGEuZXhwaXJlc19pbiAvIDYwKX0gbWludXRlc2ApO1xyXG4gICAgICBjb25zb2xlLmxvZyhg8J+UkCBUb2tlbiBjYWNoZWQ6IGFjY2Vzc190b2tlbj0ke3RoaXMuYWNjZXNzVG9rZW4uc3Vic3RyaW5nKDAsIDEwKX0uLi4sIGV4cGlyZXNfaW49JHtyZXNwb25zZS5kYXRhLmV4cGlyZXNfaW59cywgZXhwaXJ5PSR7bmV3IERhdGUodGhpcy50b2tlbkV4cGlyeSkudG9JU09TdHJpbmcoKX1gKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVmcmVzaGluZyBab2hvIGFjY2VzcyB0b2tlbjonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGF1dGhlbnRpY2F0ZSB3aXRoIFpvaG8nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgbWFrZVJlcXVlc3QoZW5kcG9pbnQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAvLyBVc2UgcC1saW1pdCByYXRlIGxpbWl0ZXIgdG8gcHJldmVudCA0MjkgZXJyb3JzXHJcbiAgICByZXR1cm4gdGhpcy5yYXRlTGltaXRlcihhc3luYyAoKSA9PiB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gQXBwbHkgcmF0ZSBsaW1pdGluZ1xyXG4gICAgICAgIGF3YWl0IHRoaXMuYXBwbHlSYXRlTGltaXQoKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKTtcclxuICAgICAgXHJcbiAgICAgIC8vIExvZyBBUEkgY2FsbCBjb3VudCBmb3IgbW9uaXRvcmluZ1xyXG4gICAgICB0aGlzLnJlcXVlc3RDb3VudCsrO1xyXG4gICAgICBjb25zb2xlLmxvZyhg8J+TiiBab2hvIEFQSSBjYWxsICMke3RoaXMucmVxdWVzdENvdW50fSB0bzogJHtlbmRwb2ludH1gKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFZhbGlkYXRlIHRva2VuIGJlZm9yZSBtYWtpbmcgcmVxdWVzdFxyXG4gICAgICBpZiAoIXRva2VuIHx8IHRva2VuID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBvciBtaXNzaW5nIGFjY2VzcyB0b2tlbicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBWYWxpZGF0ZSBvcmdhbml6YXRpb24gYmVmb3JlIGhpdHRpbmcgcmVwb3J0cyBlbmRwb2ludHNcclxuICAgICAgaWYgKCF0aGlzLm9yZ2FuaXphdGlvblZhbGlkYXRlZCAmJiBlbmRwb2ludC5zdGFydHNXaXRoKCdyZXBvcnRzLycpKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy52YWxpZGF0ZU9yZ2FuaXphdGlvbih0b2tlbik7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUuaW5mbyhgTWFraW5nIFpvaG8gQVBJIHJlcXVlc3QgdG86ICR7ZW5kcG9pbnR9YCk7XHJcbiAgICAgIGNvbnNvbGUuaW5mbyhgVG9rZW4gKGZpcnN0IDEwIGNoYXJzKTogJHt0b2tlbj8uc3Vic3RyaW5nKDAsIDEwKSA/PyAnTi9BJ30uLi5gKTtcclxuICAgICAgXHJcbiAgICAgIC8vIENyZWF0ZSBBYm9ydENvbnRyb2xsZXIgZm9yIHRpbWVvdXRcclxuICAgICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcclxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDE1MDAwKTsgLy8gMTUgc2Vjb25kIHRpbWVvdXRcclxuICAgICAgXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoYCR7dGhpcy5BUElfQkFTRX0vYm9va3MvdjMvJHtlbmRwb2ludH1gLCB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Rva2VufWAsXHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgcGFyYW1zOiB7XHJcbiAgICAgICAgICAgIG9yZ2FuaXphdGlvbl9pZDogcHJvY2Vzcy5lbnYuWk9IT19PUkdBTklaQVRJT05fSUQsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdGltZW91dDogMTUwMDAsIC8vIDE1IHNlY29uZCB0aW1lb3V0XHJcbiAgICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBSZXNldCByZXRyeSBjb3VudCBvbiBzdWNjZXNzXHJcbiAgICAgICAgdGhpcy5yZXRyeUNvdW50ID0gMDtcclxuICAgICAgICB0aGlzLnJlcXVlc3RDb3VudCsrO1xyXG4gICAgICAgIHRoaXMubGFzdFJlcXVlc3RUaW1lID0gRGF0ZS5ub3coKTtcclxuXHJcbiAgICAgICAgY29uc29sZS5pbmZvKGBab2hvIEFQSSByZXF1ZXN0IHN1Y2Nlc3NmdWw6ICR7ZW5kcG9pbnR9YCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgIH0gY2F0Y2ggKGF4aW9zRXJyb3I6IGFueSkge1xyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEhhbmRsZSB0aW1lb3V0IHNwZWNpZmljYWxseVxyXG4gICAgICAgIGlmIChheGlvc0Vycm9yLmNvZGUgPT09ICdFQ09OTkFCT1JURUQnIHx8IGF4aW9zRXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ3RpbWVvdXQnKSkge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBab2hvIEFQSSByZXF1ZXN0IHRpbWVkIG91dCBmb3IgJHtlbmRwb2ludH1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhyb3cgYXhpb3NFcnJvcjtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAvLyBIYW5kbGUgcmF0ZSBsaW1pdGluZyAoNDAwIHdpdGggc3BlY2lmaWMgZXJyb3IgbWVzc2FnZSlcclxuICAgICAgaWYgKGVycm9yLnJlc3BvbnNlPy5zdGF0dXMgPT09IDQwMCAmJiBcclxuICAgICAgICAgIGVycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvcl9kZXNjcmlwdGlvbj8uaW5jbHVkZXMoJ3RvbyBtYW55IHJlcXVlc3RzJykpIHtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLndhcm4oJ1pvaG8gcmF0ZSBsaW1pdCBoaXQsIGltcGxlbWVudGluZyBleHBvbmVudGlhbCBiYWNrb2ZmLi4uJyk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVSYXRlTGltaXQoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBSZXRyeSB0aGUgcmVxdWVzdCBhZnRlciBiYWNrb2ZmXHJcbiAgICAgICAgaWYgKHRoaXMucmV0cnlDb3VudCA8IHRoaXMuTUFYX1JFVFJJRVMpIHtcclxuICAgICAgICAgIHRoaXMucmV0cnlDb3VudCsrO1xyXG4gICAgICAgICAgY29uc29sZS5pbmZvKGBSZXRyeWluZyByZXF1ZXN0IGFmdGVyIHJhdGUgbGltaXQgYmFja29mZiAoYXR0ZW1wdCAke3RoaXMucmV0cnlDb3VudH0pYCk7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5tYWtlUmVxdWVzdChlbmRwb2ludCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignWm9obyBBUEkgcmF0ZSBsaW1pdCBleGNlZWRlZCBhZnRlciBtYXhpbXVtIHJldHJpZXMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBIYW5kbGUgNDI5IFRvbyBNYW55IFJlcXVlc3RzIChleHBsaWNpdCByYXRlIGxpbWl0KVxyXG4gICAgICBpZiAoZXJyb3IucmVzcG9uc2U/LnN0YXR1cyA9PT0gNDI5KSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdab2hvIDQyOSByYXRlIGxpbWl0IGhpdCwgaW1wbGVtZW50aW5nIGV4cG9uZW50aWFsIGJhY2tvZmYuLi4nKTtcclxuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVJhdGVMaW1pdCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJldHJ5IHRoZSByZXF1ZXN0IGFmdGVyIGJhY2tvZmZcclxuICAgICAgICBpZiAodGhpcy5yZXRyeUNvdW50IDwgdGhpcy5NQVhfUkVUUklFUykge1xyXG4gICAgICAgICAgdGhpcy5yZXRyeUNvdW50Kys7XHJcbiAgICAgICAgICBjb25zb2xlLmluZm8oYFJldHJ5aW5nIHJlcXVlc3QgYWZ0ZXIgNDI5IGJhY2tvZmYgKGF0dGVtcHQgJHt0aGlzLnJldHJ5Q291bnR9KWApO1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMubWFrZVJlcXVlc3QoZW5kcG9pbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1pvaG8gQVBJIHJhdGUgbGltaXQgZXhjZWVkZWQgYWZ0ZXIgbWF4aW11bSByZXRyaWVzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gSWYgd2UgZ2V0IGEgNDAxLCB0cnkgcmVmcmVzaGluZyB0aGUgdG9rZW4gb25jZVxyXG4gICAgICBpZiAoZXJyb3IucmVzcG9uc2U/LnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlPy5kYXRhPy5jb2RlID09PSA1Nykge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignWm9obyBBUEkgYXV0aG9yaXphdGlvbiBlcnJvciAoY29kZSA1NykuIExpa2VseSBtaXNzaW5nIHJlcXVpcmVkIHNjb3BlcyBzdWNoIGFzIFpvaG9Cb29rcy5yZXBvcnRzLlJFQUQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUuaW5mbygnVG9rZW4gZXhwaXJlZCwgcmVmcmVzaGluZy4uLicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENsZWFyIHRoZSBjdXJyZW50IHRva2VuIGFuZCBmb3JjZSBhIHJlZnJlc2hcclxuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRva2VuRXhwaXJ5ID0gMDtcclxuICAgICAgICBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgbmV3VG9rZW4gPSBhd2FpdCB0aGlzLmZvcmNlUmVmcmVzaFRva2VuKCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIFZhbGlkYXRlIHRoZSBuZXcgdG9rZW5cclxuICAgICAgICAgIGlmICghbmV3VG9rZW4gfHwgbmV3VG9rZW4gPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIG9idGFpbiB2YWxpZCB0b2tlbiBhZnRlciByZWZyZXNoJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnNvbGUuaW5mbyhgUmV0cnlpbmcgcmVxdWVzdCB3aXRoIG5ldyB0b2tlbjogJHtlbmRwb2ludH1gKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gUmV0cnkgdGhlIHJlcXVlc3Qgd2l0aCB0aGUgbmV3IHRva2VuXHJcbiAgICAgICAgICBjb25zdCByZXRyeVJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KGAke3RoaXMuQVBJX0JBU0V9L2Jvb2tzL3YzLyR7ZW5kcG9pbnR9YCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7bmV3VG9rZW59YCxcclxuICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICBvcmdhbml6YXRpb25faWQ6IHByb2Nlc3MuZW52LlpPSE9fT1JHQU5JWkFUSU9OX0lELFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aW1lb3V0OiAxNTAwMCxcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBjb25zb2xlLmluZm8oJ1JlcXVlc3QgcmV0cnkgc3VjY2Vzc2Z1bCBhZnRlciB0b2tlbiByZWZyZXNoJyk7XHJcbiAgICAgICAgICByZXR1cm4gcmV0cnlSZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIH0gY2F0Y2ggKHJlZnJlc2hFcnJvcjogYW55KSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVmcmVzaCB0b2tlbiBvciByZXRyeSByZXF1ZXN0OicsIHJlZnJlc2hFcnJvcik7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIExvZyBkZXRhaWxlZCByZWZyZXNoIGVycm9yIGluZm9ybWF0aW9uXHJcbiAgICAgICAgICBpZiAoYXhpb3MuaXNBeGlvc0Vycm9yKHJlZnJlc2hFcnJvcikpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVG9rZW4gcmVmcmVzaCBBeGlvcyBlcnJvciBkZXRhaWxzOicsIHtcclxuICAgICAgICAgICAgICBzdGF0dXM6IHJlZnJlc2hFcnJvci5yZXNwb25zZT8uc3RhdHVzLFxyXG4gICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHJlZnJlc2hFcnJvci5yZXNwb25zZT8uc3RhdHVzVGV4dCxcclxuICAgICAgICAgICAgICBkYXRhOiByZWZyZXNoRXJyb3IucmVzcG9uc2U/LmRhdGEsXHJcbiAgICAgICAgICAgICAgbWVzc2FnZTogcmVmcmVzaEVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgZW5kcG9pbnQ6IGVuZHBvaW50XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGEgcmF0ZSBsaW1pdGluZyBpc3N1ZSBkdXJpbmcgdG9rZW4gcmVmcmVzaFxyXG4gICAgICAgICAgaWYgKHJlZnJlc2hFcnJvci5yZXNwb25zZT8uc3RhdHVzID09PSA0MDAgJiYgXHJcbiAgICAgICAgICAgICAgcmVmcmVzaEVycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvcl9kZXNjcmlwdGlvbj8uaW5jbHVkZXMoJ3RvbyBtYW55IHJlcXVlc3RzJykpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBab2hvIHRva2VuIHJlZnJlc2ggcmF0ZSBsaW1pdGVkOiAke2VuZHBvaW50fS4gUGxlYXNlIHdhaXQgYmVmb3JlIHJldHJ5aW5nLmApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGFuIGF1dGhlbnRpY2F0aW9uIGlzc3VlIGR1cmluZyB0b2tlbiByZWZyZXNoXHJcbiAgICAgICAgICBpZiAocmVmcmVzaEVycm9yLnJlc3BvbnNlPy5zdGF0dXMgPT09IDQwMCAmJiBcclxuICAgICAgICAgICAgICByZWZyZXNoRXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yX2Rlc2NyaXB0aW9uPy5pbmNsdWRlcygnaW52YWxpZCcpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgWm9obyB0b2tlbiByZWZyZXNoIGZhaWxlZCAtIGludmFsaWQgY3JlZGVudGlhbHM6ICR7ZW5kcG9pbnR9LiBDaGVjayB5b3VyIE9BdXRoIGNvbmZpZ3VyYXRpb24uYCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgWm9obyBBUEkgYXV0aGVudGljYXRpb24gZmFpbGVkIGFmdGVyIHRva2VuIHJlZnJlc2g6ICR7ZW5kcG9pbnR9LiBFcnJvcjogJHtyZWZyZXNoRXJyb3IubWVzc2FnZX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIExvZyB0aGUgZXJyb3IgZGV0YWlscyBmb3IgZGVidWdnaW5nXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFpvaG8gQVBJIHJlcXVlc3QgZmFpbGVkIGZvciAke2VuZHBvaW50fTpgLCB7XHJcbiAgICAgICAgc3RhdHVzOiBlcnJvci5yZXNwb25zZT8uc3RhdHVzLFxyXG4gICAgICAgIHN0YXR1c1RleHQ6IGVycm9yLnJlc3BvbnNlPy5zdGF0dXNUZXh0LFxyXG4gICAgICAgIGRhdGE6IGVycm9yLnJlc3BvbnNlPy5kYXRhLFxyXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2VcclxuICAgICAgfSk7XHJcbiAgICAgIGlmIChlcnJvci5yZXNwb25zZT8uZGF0YT8uY29kZSA9PT0gNTcpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdab2hvIEFQSSBhdXRob3JpemF0aW9uIGVycm9yIChjb2RlIDU3KS4gVmVyaWZ5IG9yZ2FuaXphdGlvbl9pZCBhbmQgT0F1dGggc2NvcGVzIChab2hvQm9va3MucmVwb3J0cy5SRUFEKS4nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gQ2hlY2sgZ3JhbnRlZCBzY29wZXMgZm9yIGN1cnJlbnQgYWNjZXNzIHRva2VuXHJcbiAgcHJpdmF0ZSBhc3luYyBjaGVja1Rva2VuU2NvcGVzKHRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHsgc2NvcGU/OiBzdHJpbmcgfSB8IG51bGw+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMuQUNDT1VOVFNfQkFTRX0vb2F1dGgvdjIvdG9rZW5pbmZvP3Rva2VuPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHRva2VuKX1gO1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBheGlvcy5nZXQodXJsLCB7IHRpbWVvdXQ6IDEwMDAwIH0pO1xyXG4gICAgICByZXR1cm4gcmVzLmRhdGEgYXMgeyBzY29wZT86IHN0cmluZyB9O1xyXG4gICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcclxuICAgICAgLy8gU3VyZmFjZSBjb25jaXNlIGNvbnRleHQgYnV0IGRvIG5vdCBmYWlsIHRoZSBtYWluIGZsb3dcclxuICAgICAgY29uc3QgbXNnID0gYXhpb3MuaXNBeGlvc0Vycm9yKGVycikgPyBlcnIucmVzcG9uc2U/LmRhdGEgfHwgZXJyLm1lc3NhZ2UgOiBTdHJpbmcoZXJyKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKHR5cGVvZiBtc2cgPT09ICdzdHJpbmcnID8gbXNnIDogSlNPTi5zdHJpbmdpZnkobXNnKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBWYWxpZGF0ZSB0aGUgY29uZmlndXJlZCBvcmdhbml6YXRpb24gSUQgYnkgY2FsbGluZyBvcmdhbml6YXRpb25zIGVuZHBvaW50XHJcbiAgcHJpdmF0ZSBhc3luYyB2YWxpZGF0ZU9yZ2FuaXphdGlvbih0b2tlbjogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBvcmdJZCA9IHByb2Nlc3MuZW52LlpPSE9fT1JHQU5JWkFUSU9OX0lEO1xyXG4gICAgICBpZiAoIW9yZ0lkKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdaT0hPX09SR0FOSVpBVElPTl9JRCBub3Qgc2V0LiBSZXBvcnRzIGNhbGxzIG1heSBmYWlsLicpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLkFQSV9CQVNFfS9ib29rcy92My9vcmdhbml6YXRpb25zYDtcclxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYXhpb3MuZ2V0KHVybCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Rva2VufWAsXHJcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0aW1lb3V0OiAxNTAwMFxyXG4gICAgICB9KTtcclxuICAgICAgY29uc3Qgb3JncyA9IChyZXMuZGF0YT8ub3JnYW5pemF0aW9ucyB8fCBbXSkgYXMgQXJyYXk8eyBvcmdhbml6YXRpb25faWQ/OiBzdHJpbmcgfCBudW1iZXIgfT47XHJcbiAgICAgIGNvbnN0IGZvdW5kID0gb3Jncy5zb21lKG8gPT4gU3RyaW5nKG8ub3JnYW5pemF0aW9uX2lkKSA9PT0gU3RyaW5nKG9yZ0lkKSk7XHJcbiAgICAgIGlmICghZm91bmQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGBQcm92aWRlZCBvcmdhbml6YXRpb25faWQ9JHtvcmdJZH0gbm90IGZvdW5kIGluIFpvaG8gYWNjb3VudC4gRmV0Y2hlZCBvcmdhbml6YXRpb25zOiAke0pTT04uc3RyaW5naWZ5KG9yZ3MpfWApO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMub3JnYW5pemF0aW9uVmFsaWRhdGVkID0gdHJ1ZTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgVmFsaWRhdGVkIFpvaG8gb3JnYW5pemF0aW9uX2lkPSR7b3JnSWR9YCk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XHJcbiAgICAgIGNvbnN0IHN0YXR1cyA9IGF4aW9zLmlzQXhpb3NFcnJvcihlcnIpID8gZXJyLnJlc3BvbnNlPy5zdGF0dXMgOiB1bmRlZmluZWQ7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBheGlvcy5pc0F4aW9zRXJyb3IoZXJyKSA/IGVyci5yZXNwb25zZT8uZGF0YSA6IHVuZGVmaW5lZDtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHZhbGlkYXRlIFpvaG8gb3JnYW5pemF0aW9uOicsIHsgc3RhdHVzLCBkYXRhLCBtZXNzYWdlOiBlcnIubWVzc2FnZSB9KTtcclxuICAgICAgLy8gRG8gbm90IHRocm93OyBhbGxvdyByZXF1ZXN0IHRvIHByb2NlZWQgYnV0IGxvZ3Mgd2lsbCBoZWxwIGRpYWdub3NlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGFwcGx5UmF0ZUxpbWl0KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byB3YWl0IGJldHdlZW4gcmVxdWVzdHNcclxuICAgIGlmICh0aGlzLmxhc3RSZXF1ZXN0VGltZSA+IDApIHtcclxuICAgICAgY29uc3QgdGltZVNpbmNlTGFzdFJlcXVlc3QgPSBub3cgLSB0aGlzLmxhc3RSZXF1ZXN0VGltZTtcclxuICAgICAgaWYgKHRpbWVTaW5jZUxhc3RSZXF1ZXN0IDwgdGhpcy5NSU5fUkVRVUVTVF9JTlRFUlZBTCkge1xyXG4gICAgICAgIGNvbnN0IHdhaXRUaW1lID0gdGhpcy5NSU5fUkVRVUVTVF9JTlRFUlZBTCAtIHRpbWVTaW5jZUxhc3RSZXF1ZXN0O1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbyhgUmF0ZSBsaW1pdGluZzogd2FpdGluZyAke3dhaXRUaW1lfW1zIGJlZm9yZSBuZXh0IHJlcXVlc3RgKTtcclxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgd2FpdFRpbWUpKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBpZiB3ZSd2ZSBleGNlZWRlZCB0aGUgcGVyLW1pbnV0ZSBsaW1pdFxyXG4gICAgaWYgKHRoaXMucmVxdWVzdENvdW50ID49IHRoaXMuTUFYX1JFUVVFU1RTX1BFUl9NSU5VVEUpIHtcclxuICAgICAgY29uc3QgdGltZVNpbmNlRmlyc3RSZXF1ZXN0ID0gbm93IC0gdGhpcy5sYXN0UmVxdWVzdFRpbWU7XHJcbiAgICAgIGlmICh0aW1lU2luY2VGaXJzdFJlcXVlc3QgPCA2MDAwMCkgeyAvLyBMZXNzIHRoYW4gMSBtaW51dGVcclxuICAgICAgICBjb25zdCB3YWl0VGltZSA9IDYwMDAwIC0gdGltZVNpbmNlRmlyc3RSZXF1ZXN0O1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgUmF0ZSBsaW1pdGluZzogZXhjZWVkZWQgJHt0aGlzLk1BWF9SRVFVRVNUU19QRVJfTUlOVVRFfSByZXF1ZXN0cyBwZXIgbWludXRlLCB3YWl0aW5nICR7d2FpdFRpbWV9bXNgKTtcclxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgd2FpdFRpbWUpKTtcclxuICAgICAgICB0aGlzLnJlcXVlc3RDb3VudCA9IDA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gUmVzZXQgY291bnRlciBpZiBtb3JlIHRoYW4gMSBtaW51dGUgaGFzIHBhc3NlZFxyXG4gICAgICAgIHRoaXMucmVxdWVzdENvdW50ID0gMDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVSYXRlTGltaXQoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCBkZWxheSA9IHRoaXMuQkFTRV9ERUxBWSAqIE1hdGgucG93KDIsIHRoaXMucmV0cnlDb3VudCk7XHJcbiAgICBjb25zdCBqaXR0ZXIgPSBNYXRoLnJhbmRvbSgpICogMTAwMDsgLy8gQWRkIHVwIHRvIDEgc2Vjb25kIG9mIGppdHRlclxyXG4gICAgY29uc3QgdG90YWxEZWxheSA9IGRlbGF5ICsgaml0dGVyO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLndhcm4oYFJhdGUgbGltaXQgYmFja29mZjogd2FpdGluZyAke3RvdGFsRGVsYXl9bXMgYmVmb3JlIHJldHJ5IChhdHRlbXB0ICR7dGhpcy5yZXRyeUNvdW50ICsgMX0pYCk7XHJcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgdG90YWxEZWxheSkpO1xyXG4gICAgXHJcbiAgICAvLyBSZXNldCByZXF1ZXN0IGNvdW50ZXJzIHRvIGFsbG93IGZyZXNoIHN0YXJ0XHJcbiAgICB0aGlzLnJlcXVlc3RDb3VudCA9IDA7XHJcbiAgICB0aGlzLmxhc3RSZXF1ZXN0VGltZSA9IDA7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRQcm9qZWN0cygpOiBQcm9taXNlPFpvaG9Qcm9qZWN0W10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGxldCBhbGxQcm9qZWN0czogWm9ob1Byb2plY3RbXSA9IFtdO1xyXG4gICAgICBsZXQgcGFnZSA9IDE7XHJcbiAgICAgIGNvbnN0IHBlclBhZ2UgPSAyMDA7XHJcbiAgICAgIFxyXG4gICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGBwcm9qZWN0cz9wYWdlPSR7cGFnZX0mcGVyX3BhZ2U9JHtwZXJQYWdlfWApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHByb2plY3RzID0gZGF0YS5wcm9qZWN0cz8ubWFwKChwcm9qZWN0OiBhbnkpID0+IHtcclxuICAgICAgICAgIC8vIExvZyB0aGUgZmlyc3QgcHJvamVjdCB0byBzZWUgYXZhaWxhYmxlIGZpZWxkc1xyXG4gICAgICAgICAgaWYgKHBhZ2UgPT09IDEgJiYgYWxsUHJvamVjdHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTYW1wbGUgWm9obyBwcm9qZWN0IGRhdGE6JywgSlNPTi5zdHJpbmdpZnkocHJvamVjdCwgbnVsbCwgMikpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwcm9qZWN0X2lkOiBwcm9qZWN0LnByb2plY3RfaWQsXHJcbiAgICAgICAgICAgIHByb2plY3RfbmFtZTogcHJvamVjdC5wcm9qZWN0X25hbWUgfHwgcHJvamVjdC5uYW1lIHx8ICcnLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogcHJvamVjdC5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICAgICAgc3RhdHVzOiBwcm9qZWN0LnN0YXR1cyB8fCAnYWN0aXZlJyxcclxuICAgICAgICAgICAgc3RhcnRfZGF0ZTogcHJvamVjdC5zdGFydF9kYXRlIHx8ICcnLFxyXG4gICAgICAgICAgICBlbmRfZGF0ZTogcHJvamVjdC5lbmRfZGF0ZSB8fCAnJyxcclxuICAgICAgICAgICAgYnVkZ2V0X2Ftb3VudDogcHJvamVjdC5idWRnZXRfYW1vdW50IHx8IDAsXHJcbiAgICAgICAgICAgIHJhdGVfcGVyX2hvdXI6IHByb2plY3QucmF0ZV9wZXJfaG91ciB8fCAwLFxyXG4gICAgICAgICAgICBjdXN0b21lcl9pZDogcHJvamVjdC5jdXN0b21lcl9pZCB8fCAnJyxcclxuICAgICAgICAgICAgY3VzdG9tZXJfbmFtZTogcHJvamVjdC5jdXN0b21lcl9uYW1lIHx8ICcnLFxyXG4gICAgICAgICAgICBzaWduZWRfZmVlOiB1bmRlZmluZWQsIC8vIFJlbW92ZSBab2hvIHNpZ25lZCBmZWUsIG9ubHkgdXNlIHVzZXItZW50ZXJlZCBkYXRhXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0pIHx8IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGFsbFByb2plY3RzID0gYWxsUHJvamVjdHMuY29uY2F0KHByb2plY3RzKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDaGVjayBpZiB3ZSd2ZSByZWFjaGVkIHRoZSBlbmRcclxuICAgICAgICBpZiAocHJvamVjdHMubGVuZ3RoIDwgcGVyUGFnZSkge1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHBhZ2UrKztcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coYEZldGNoZWQgJHthbGxQcm9qZWN0cy5sZW5ndGh9IHByb2plY3RzIGZyb20gWm9ob2ApO1xyXG4gICAgICByZXR1cm4gYWxsUHJvamVjdHM7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwcm9qZWN0czonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFByb2plY3RzV2l0aFJldmVudWVCdWRnZXQoKTogUHJvbWlzZTxab2hvUHJvamVjdFtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZygnRmV0Y2hpbmcgcHJvamVjdHMgd2l0aCByZXZlbnVlIGJ1ZGdldCBkYXRhLi4uJyk7XHJcbiAgICAgIGNvbnN0IHByb2plY3RzID0gYXdhaXQgdGhpcy5nZXRQcm9qZWN0cygpO1xyXG4gICAgICBcclxuICAgICAgLy8gTG9nIHByb2plY3RzIHRoYXQgaGF2ZSByZXZlbnVlX2J1ZGdldCBkYXRhXHJcbiAgICAgIGNvbnN0IHByb2plY3RzV2l0aFJldmVudWVCdWRnZXQgPSBwcm9qZWN0cy5maWx0ZXIocHJvamVjdCA9PiB7XHJcbiAgICAgICAgY29uc3QgaGFzUmV2ZW51ZUJ1ZGdldCA9IHByb2plY3Quc2lnbmVkX2ZlZSAmJiBwcm9qZWN0LnNpZ25lZF9mZWUgPiAwO1xyXG4gICAgICAgIGlmIChoYXNSZXZlbnVlQnVkZ2V0KSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhgUHJvamVjdCAke3Byb2plY3QucHJvamVjdF9uYW1lfSBoYXMgcmV2ZW51ZSBidWRnZXQ6ICQke3Byb2plY3Quc2lnbmVkX2ZlZX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhhc1JldmVudWVCdWRnZXQ7XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coYEZvdW5kICR7cHJvamVjdHNXaXRoUmV2ZW51ZUJ1ZGdldC5sZW5ndGh9IHByb2plY3RzIHdpdGggcmV2ZW51ZSBidWRnZXQgZGF0YWApO1xyXG4gICAgICByZXR1cm4gcHJvamVjdHM7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwcm9qZWN0cyB3aXRoIHJldmVudWUgYnVkZ2V0OicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZGVidWdQcm9qZWN0RmllbGRzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coJ0RlYnVnZ2luZyBab2hvIHByb2plY3QgZmllbGRzLi4uJyk7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KCdwcm9qZWN0cz9wYWdlPTEmcGVyX3BhZ2U9NScpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGRhdGEucHJvamVjdHMgJiYgZGF0YS5wcm9qZWN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0F2YWlsYWJsZSBmaWVsZHMgaW4gWm9obyBwcm9qZWN0IHJlc3BvbnNlOicpO1xyXG4gICAgICAgIGNvbnN0IHNhbXBsZVByb2plY3QgPSBkYXRhLnByb2plY3RzWzBdO1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHNhbXBsZVByb2plY3QpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGAgICR7a2V5fTogJHtzYW1wbGVQcm9qZWN0W2tleV19ICgke3R5cGVvZiBzYW1wbGVQcm9qZWN0W2tleV19KWApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENoZWNrIHNwZWNpZmljYWxseSBmb3IgcmV2ZW51ZV9idWRnZXRcclxuICAgICAgICBpZiAoc2FtcGxlUHJvamVjdC5yZXZlbnVlX2J1ZGdldCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIEZvdW5kIHJldmVudWVfYnVkZ2V0IGZpZWxkOiAke3NhbXBsZVByb2plY3QucmV2ZW51ZV9idWRnZXR9YCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCfinYwgcmV2ZW51ZV9idWRnZXQgZmllbGQgbm90IGZvdW5kIGluIFpvaG8gcmVzcG9uc2UnKTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdBdmFpbGFibGUgYnVkZ2V0LXJlbGF0ZWQgZmllbGRzOicpO1xyXG4gICAgICAgICAgT2JqZWN0LmtleXMoc2FtcGxlUHJvamVjdCkuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoa2V5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2J1ZGdldCcpIHx8IGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdyZXZlbnVlJykpIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgICAke2tleX06ICR7c2FtcGxlUHJvamVjdFtrZXldfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ05vIHByb2plY3RzIGZvdW5kIGluIFpvaG8gcmVzcG9uc2UnKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVidWdnaW5nIHByb2plY3QgZmllbGRzOicsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFByb2plY3RzV2l0aEVzdGltYXRlcygpOiBQcm9taXNlPFpvaG9Qcm9qZWN0W10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHByb2plY3RzID0gYXdhaXQgdGhpcy5nZXRQcm9qZWN0cygpO1xyXG4gICAgICBcclxuICAgICAgLy8gRm9yIHRoZSBmaXJzdCBmZXcgcHJvamVjdHMsIHRyeSB0byBnZXQgZXN0aW1hdGVzIHRvIHNlZSBpZiB0aGF0IGNvbnRhaW5zIHRoZSBzaWduZWQgZmVlXHJcbiAgICAgIGNvbnN0IHByb2plY3RzV2l0aEVzdGltYXRlcyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgIHByb2plY3RzLnNsaWNlKDAsIDUpLm1hcChhc3luYyAocHJvamVjdCkgPT4ge1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgZXN0aW1hdGVzID0gYXdhaXQgdGhpcy5nZXRQcm9qZWN0RXN0aW1hdGVzKHByb2plY3QucHJvamVjdF9pZCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsRXN0aW1hdGVBbW91bnQgPSBlc3RpbWF0ZXMucmVkdWNlKChzdW0sIGVzdGltYXRlKSA9PiBzdW0gKyAoZXN0aW1hdGUudG90YWwgfHwgMCksIDApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYFByb2plY3QgJHtwcm9qZWN0LnByb2plY3RfbmFtZX0gZXN0aW1hdGVzOmAsIGVzdGltYXRlcy5sZW5ndGgsICd0b3RhbCBhbW91bnQ6JywgdG90YWxFc3RpbWF0ZUFtb3VudCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgIC4uLnByb2plY3QsXHJcbiAgICAgICAgICAgICAgc2lnbmVkX2ZlZTogcHJvamVjdC5zaWduZWRfZmVlIHx8IHRvdGFsRXN0aW1hdGVBbW91bnQgfHwgMCxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGZldGNoaW5nIGVzdGltYXRlcyBmb3IgcHJvamVjdCAke3Byb2plY3QucHJvamVjdF9pZH06YCwgZXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvamVjdDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgICBcclxuICAgICAgLy8gUmV0dXJuIGFsbCBwcm9qZWN0cywgd2l0aCB0aGUgZmlyc3QgNSBoYXZpbmcgdXBkYXRlZCBzaWduZWQgZmVlcyBmcm9tIGVzdGltYXRlc1xyXG4gICAgICByZXR1cm4gW1xyXG4gICAgICAgIC4uLnByb2plY3RzV2l0aEVzdGltYXRlcyxcclxuICAgICAgICAuLi5wcm9qZWN0cy5zbGljZSg1KVxyXG4gICAgICBdO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvamVjdHMgd2l0aCBlc3RpbWF0ZXM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRQcm9qZWN0c1dpdGhJbnZvaWNlVG90YWxzKCk6IFByb21pc2U8Wm9ob1Byb2plY3RbXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgW3Byb2plY3RzLCBpbnZvaWNlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgdGhpcy5nZXRQcm9qZWN0cygpLFxyXG4gICAgICAgIHRoaXMuZ2V0SW52b2ljZXMoKSxcclxuICAgICAgXSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDYWxjdWxhdGUgc2lnbmVkIGZlZSBhcyB0b3RhbCBvZiBhbGwgaW52b2ljZXMgZm9yIGVhY2ggcHJvamVjdFxyXG4gICAgICBjb25zdCBwcm9qZWN0c1dpdGhJbnZvaWNlVG90YWxzID0gcHJvamVjdHMubWFwKHByb2plY3QgPT4ge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RJbnZvaWNlcyA9IGludm9pY2VzLmZpbHRlcihpbnZvaWNlID0+IGludm9pY2UucHJvamVjdF9pZCA9PT0gcHJvamVjdC5wcm9qZWN0X2lkKTtcclxuICAgICAgICBjb25zdCB0b3RhbEludm9pY2VBbW91bnQgPSBwcm9qZWN0SW52b2ljZXMucmVkdWNlKChzdW0sIGludm9pY2UpID0+IHN1bSArIGludm9pY2UuYW1vdW50LCAwKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZyhgUHJvamVjdCAke3Byb2plY3QucHJvamVjdF9uYW1lfSBpbnZvaWNlczpgLCBwcm9qZWN0SW52b2ljZXMubGVuZ3RoLCAndG90YWwgYW1vdW50OicsIHRvdGFsSW52b2ljZUFtb3VudCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIC4uLnByb2plY3QsXHJcbiAgICAgICAgICBzaWduZWRfZmVlOiBwcm9qZWN0LnNpZ25lZF9mZWUgfHwgdG90YWxJbnZvaWNlQW1vdW50IHx8IDAsXHJcbiAgICAgICAgfTtcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gcHJvamVjdHNXaXRoSW52b2ljZVRvdGFscztcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2plY3RzIHdpdGggaW52b2ljZSB0b3RhbHM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRJbnZvaWNlcygpOiBQcm9taXNlPFpvaG9JbnZvaWNlW10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OEIEZldGNoaW5nIGludm9pY2VzIGZyb20gWm9oby4uLicpO1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCgnaW52b2ljZXMnKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGludm9pY2VzID0gZGF0YS5pbnZvaWNlcz8ubWFwKChpbnZvaWNlOiBhbnkpID0+ICh7XHJcbiAgICAgICAgaW52b2ljZV9pZDogaW52b2ljZS5pbnZvaWNlX2lkLFxyXG4gICAgICAgIHByb2plY3RfaWQ6IGludm9pY2UucHJvamVjdF9pZCxcclxuICAgICAgICBpbnZvaWNlX251bWJlcjogaW52b2ljZS5pbnZvaWNlX251bWJlcixcclxuICAgICAgICBkYXRlOiBpbnZvaWNlLmRhdGUsXHJcbiAgICAgICAgYW1vdW50OiBpbnZvaWNlLnRvdGFsLFxyXG4gICAgICAgIHN0YXR1czogaW52b2ljZS5zdGF0dXMsXHJcbiAgICAgICAgYmlsbGVkX2Ftb3VudDogaW52b2ljZS5iaWxsZWRfYW1vdW50IHx8IDAsXHJcbiAgICAgICAgdW5iaWxsZWRfYW1vdW50OiBpbnZvaWNlLnVuYmlsbGVkX2Ftb3VudCB8fCAwLFxyXG4gICAgICB9KSkgfHwgW107XHJcbiAgICAgIFxyXG4gICAgICAvLyBMb2cgaW52b2ljZSBjb3VudHMgYW5kIGRldGFpbHNcclxuICAgICAgY29uc29sZS5sb2coYPCfk4ogWm9obyBpbnZvaWNlcyBmZXRjaGVkOiAke2ludm9pY2VzLmxlbmd0aH0gdG90YWwgaW52b2ljZXNgKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChpbnZvaWNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhdHVzQ291bnRzID0gaW52b2ljZXMucmVkdWNlKChhY2M6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4sIGludjogWm9ob0ludm9pY2UpID0+IHtcclxuICAgICAgICAgIGFjY1tpbnYuc3RhdHVzXSA9IChhY2NbaW52LnN0YXR1c10gfHwgMCkgKyAxO1xyXG4gICAgICAgICAgcmV0dXJuIGFjYztcclxuICAgICAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+KTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZygn8J+TiyBJbnZvaWNlIHN0YXR1cyBicmVha2Rvd246Jywgc3RhdHVzQ291bnRzKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2cgc2FtcGxlIGludm9pY2UgZGF0YSBmb3IgZGVidWdnaW5nXHJcbiAgICAgICAgY29uc3Qgc2FtcGxlSW52b2ljZSA9IGludm9pY2VzWzBdO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5OEIFNhbXBsZSBpbnZvaWNlIGRhdGE6Jywge1xyXG4gICAgICAgICAgaWQ6IHNhbXBsZUludm9pY2UuaW52b2ljZV9pZCxcclxuICAgICAgICAgIG51bWJlcjogc2FtcGxlSW52b2ljZS5pbnZvaWNlX251bWJlcixcclxuICAgICAgICAgIHByb2plY3Q6IHNhbXBsZUludm9pY2UucHJvamVjdF9pZCxcclxuICAgICAgICAgIGFtb3VudDogc2FtcGxlSW52b2ljZS5hbW91bnQsXHJcbiAgICAgICAgICBzdGF0dXM6IHNhbXBsZUludm9pY2Uuc3RhdHVzXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHJldHVybiBpbnZvaWNlcztcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGludm9pY2VzOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0UHJvamVjdEludm9pY2VzKHByb2plY3RJZDogc3RyaW5nKTogUHJvbWlzZTxab2hvSW52b2ljZVtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdChgcHJvamVjdHMvJHtwcm9qZWN0SWR9L2ludm9pY2VzYCk7XHJcbiAgICAgIHJldHVybiBkYXRhLmludm9pY2VzPy5tYXAoKGludm9pY2U6IGFueSkgPT4gKHtcclxuICAgICAgICBpbnZvaWNlX2lkOiBpbnZvaWNlLmludm9pY2VfaWQsXHJcbiAgICAgICAgcHJvamVjdF9pZDogaW52b2ljZS5wcm9qZWN0X2lkLFxyXG4gICAgICAgIGludm9pY2VfbnVtYmVyOiBpbnZvaWNlLmludm9pY2VfbnVtYmVyLFxyXG4gICAgICAgIGRhdGU6IGludm9pY2UuZGF0ZSxcclxuICAgICAgICBhbW91bnQ6IGludm9pY2UudG90YWwsXHJcbiAgICAgICAgc3RhdHVzOiBpbnZvaWNlLnN0YXR1cyxcclxuICAgICAgICBiaWxsZWRfYW1vdW50OiBpbnZvaWNlLmJpbGxlZF9hbW91bnQgfHwgMCxcclxuICAgICAgICB1bmJpbGxlZF9hbW91bnQ6IGludm9pY2UudW5iaWxsZWRfYW1vdW50IHx8IDAsXHJcbiAgICAgIH0pKSB8fCBbXTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2plY3QgaW52b2ljZXM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRQcm9qZWN0RGV0YWlscyhwcm9qZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdChgcHJvamVjdHMvJHtwcm9qZWN0SWR9YCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBQcm9qZWN0ICR7cHJvamVjdElkfSBkZXRhaWxzOmAsIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcclxuICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwcm9qZWN0IGRldGFpbHM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFByb2plY3RFc3RpbWF0ZXMocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdChgcHJvamVjdHMvJHtwcm9qZWN0SWR9L2VzdGltYXRlc2ApO1xyXG4gICAgICBjb25zb2xlLmxvZyhgUHJvamVjdCAke3Byb2plY3RJZH0gZXN0aW1hdGVzOmAsIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcclxuICAgICAgcmV0dXJuIGRhdGEuZXN0aW1hdGVzIHx8IFtdO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcHJvamVjdCBlc3RpbWF0ZXM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRQcm9qZWN0Q29udHJhY3RzKHByb2plY3RJZDogc3RyaW5nKTogUHJvbWlzZTxhbnlbXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoYHByb2plY3RzLyR7cHJvamVjdElkfS9jb250cmFjdHNgKTtcclxuICAgICAgY29uc29sZS5sb2coYFByb2plY3QgJHtwcm9qZWN0SWR9IGNvbnRyYWN0czpgLCBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKSk7XHJcbiAgICAgIHJldHVybiBkYXRhLmNvbnRyYWN0cyB8fCBbXTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2plY3QgY29udHJhY3RzOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTmV3IG1ldGhvZCB0byBnZXQgUHJvZml0ICYgTG9zcyBzdGF0ZW1lbnRcclxuICBhc3luYyBnZXRQcm9maXRBbmRMb3NzKHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5pbmZvKGDwn5OKIEZldGNoaW5nIFpvaG8gUHJvZml0ICYgTG9zcyBmb3IgJHtzdGFydERhdGV9IHRvICR7ZW5kRGF0ZX1gKTtcclxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMubWFrZVJlcXVlc3QoYHJlcG9ydHMvcHJvZml0YW5kbG9zcz9mcm9tX2RhdGU9JHtzdGFydERhdGV9JnRvX2RhdGU9JHtlbmREYXRlfWApO1xyXG4gICAgICBjb25zdCBzaXplQnl0ZXMgPSBKU09OLnN0cmluZ2lmeShkYXRhIHx8IHt9KS5sZW5ndGg7XHJcbiAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhkYXRhIHx8IHt9KS5sZW5ndGg7XHJcbiAgICAgIGNvbnNvbGUuaW5mbyhg4pyFIFByb2ZpdCAmIExvc3MgZGF0YSBmZXRjaGVkIHN1Y2Nlc3NmdWxseSAoa2V5czogJHtrZXlzfSwgYnl0ZXM6ICR7c2l6ZUJ5dGVzfSlgKTtcclxuICAgICAgaWYgKCFkYXRhIHx8IGtleXMgPT09IDApIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ05vIGRhdGEgZm9yIHJlcG9ydHMvcHJvZml0YW5kbG9zcy4gVmVyaWZ5IG9yZ2FuaXphdGlvbiBJRCwgZGF0ZSByYW5nZSAoMjAyNS0wMS0wMSB0byAyMDI1LTA4LTEzKSwgb3IgZGF0YSBpbiBab2hvIGRhc2hib2FyZC4nKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZGF0YTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBmZXRjaGluZyBQcm9maXQgJiBMb3NzOicsIGVycm9yKTtcclxuICAgICAgY29uc29sZS53YXJuKCfwn46tIFByb2ZpdCAmIExvc3MgZGF0YSB1bmF2YWlsYWJsZSwgd2lsbCB1c2UgZGVmYXVsdHMnKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBOZXcgbWV0aG9kIHRvIGdldCBDYXNoIEZsb3cgc3RhdGVtZW50XHJcbiAgYXN5bmMgZ2V0Q2FzaEZsb3coc3RhcnREYXRlOiBzdHJpbmcsIGVuZERhdGU6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmluZm8oYPCfkrAgRmV0Y2hpbmcgWm9obyBDYXNoIEZsb3cgZm9yICR7c3RhcnREYXRlfSB0byAke2VuZERhdGV9YCk7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGByZXBvcnRzL2Nhc2hmbG93P2Zyb21fZGF0ZT0ke3N0YXJ0RGF0ZX0mdG9fZGF0ZT0ke2VuZERhdGV9YCk7XHJcbiAgICAgIGNvbnN0IHNpemVCeXRlcyA9IEpTT04uc3RyaW5naWZ5KGRhdGEgfHwge30pLmxlbmd0aDtcclxuICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGRhdGEgfHwge30pLmxlbmd0aDtcclxuICAgICAgY29uc29sZS5pbmZvKGDinIUgQ2FzaCBGbG93IGRhdGEgZmV0Y2hlZCBzdWNjZXNzZnVsbHkgKGtleXM6ICR7a2V5c30sIGJ5dGVzOiAke3NpemVCeXRlc30pYCk7XHJcbiAgICAgIGlmICghZGF0YSB8fCBrZXlzID09PSAwKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdObyBkYXRhIGZvciByZXBvcnRzL2Nhc2hmbG93LiBWZXJpZnkgb3JnYW5pemF0aW9uIElELCBkYXRlIHJhbmdlICgyMDI1LTAxLTAxIHRvIDIwMjUtMDgtMTMpLCBvciBkYXRhIGluIFpvaG8gZGFzaGJvYXJkLicpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGZldGNoaW5nIENhc2ggRmxvdzonLCBlcnJvcik7XHJcbiAgICAgIGNvbnNvbGUud2Fybign8J+OrSBDYXNoIEZsb3cgZGF0YSB1bmF2YWlsYWJsZSwgd2lsbCB1c2UgZGVmYXVsdHMnKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBOZXcgbWV0aG9kIHRvIGdldCBCYWxhbmNlIFNoZWV0XHJcbiAgYXN5bmMgZ2V0QmFsYW5jZVNoZWV0KGRhdGU6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmluZm8oYPCfk4ggRmV0Y2hpbmcgWm9obyBCYWxhbmNlIFNoZWV0IGZvciAke2RhdGV9YCk7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KGByZXBvcnRzL2JhbGFuY2VzaGVldD9kYXRlPSR7ZGF0ZX1gKTtcclxuICAgICAgY29uc3Qgc2l6ZUJ5dGVzID0gSlNPTi5zdHJpbmdpZnkoZGF0YSB8fCB7fSkubGVuZ3RoO1xyXG4gICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZGF0YSB8fCB7fSkubGVuZ3RoO1xyXG4gICAgICBjb25zb2xlLmluZm8oYOKchSBCYWxhbmNlIFNoZWV0IGRhdGEgZmV0Y2hlZCBzdWNjZXNzZnVsbHkgKGtleXM6ICR7a2V5c30sIGJ5dGVzOiAke3NpemVCeXRlc30pYCk7XHJcbiAgICAgIGlmICghZGF0YSB8fCBrZXlzID09PSAwKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdObyBkYXRhIGZvciByZXBvcnRzL2JhbGFuY2VzaGVldC4gVmVyaWZ5IG9yZ2FuaXphdGlvbiBJRCwgZGF0ZSByYW5nZSAoMjAyNS0wMS0wMSB0byAyMDI1LTA4LTEzKSwgb3IgZGF0YSBpbiBab2hvIGRhc2hib2FyZC4nKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZGF0YTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBmZXRjaGluZyBCYWxhbmNlIFNoZWV0OicsIGVycm9yKTtcclxuICAgICAgY29uc29sZS53YXJuKCfwn46tIEJhbGFuY2UgU2hlZXQgZGF0YSB1bmF2YWlsYWJsZSwgd2lsbCB1c2UgZGVmYXVsdHMnKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBOZXcgbWV0aG9kIHRvIGdldCBDaGFydCBvZiBBY2NvdW50c1xyXG4gIGFzeW5jIGdldENoYXJ0T2ZBY2NvdW50cygpOiBQcm9taXNlPGFueVtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCgnY2hhcnRvZmFjY291bnRzJyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDaGFydCBvZiBBY2NvdW50cyBkYXRhOicsIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcclxuICAgICAgcmV0dXJuIGRhdGEuY2hhcnRvZmFjY291bnRzIHx8IFtdO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgQ2hhcnQgb2YgQWNjb3VudHM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBOZXcgbWV0aG9kIHRvIGdldCBKb3VybmFsIEVudHJpZXMgZm9yIGEgZGF0ZSByYW5nZVxyXG4gIGFzeW5jIGdldEpvdXJuYWxFbnRyaWVzKHN0YXJ0RGF0ZTogc3RyaW5nLCBlbmREYXRlOiBzdHJpbmcpOiBQcm9taXNlPGFueVtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdChgam91cm5hbGVudHJpZXM/ZnJvbV9kYXRlPSR7c3RhcnREYXRlfSZ0b19kYXRlPSR7ZW5kRGF0ZX1gKTtcclxuICAgICAgY29uc29sZS5sb2coJ0pvdXJuYWwgRW50cmllcyBkYXRhOicsIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcclxuICAgICAgcmV0dXJuIGRhdGEuam91cm5hbGVudHJpZXMgfHwgW107XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBKb3VybmFsIEVudHJpZXM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBOZXcgbWV0aG9kIHRvIGdldCBjb21wcmVoZW5zaXZlIGZpbmFuY2lhbCBtZXRyaWNzXHJcbiAgYXN5bmMgZ2V0RmluYW5jaWFsTWV0cmljcyhzdGFydERhdGU6IHN0cmluZywgZW5kRGF0ZTogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgICByZXZlbnVlOiBudW1iZXI7XHJcbiAgICBleHBlbnNlczogbnVtYmVyO1xyXG4gICAgZ3Jvc3NQcm9maXQ6IG51bWJlcjtcclxuICAgIG5ldFByb2ZpdDogbnVtYmVyO1xyXG4gICAgb3BlcmF0aW5nSW5jb21lOiBudW1iZXI7XHJcbiAgICBjYXNoRmxvdzogbnVtYmVyO1xyXG4gICAgYWNjb3VudHNSZWNlaXZhYmxlOiBudW1iZXI7XHJcbiAgICBhY2NvdW50c1BheWFibGU6IG51bWJlcjtcclxuICAgIGNhc2hCYWxhbmNlOiBudW1iZXI7XHJcbiAgfT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5pbmZvKGDwn5KwIEZldGNoaW5nIFpvaG8gZmluYW5jaWFsIG1ldHJpY3MgZm9yICR7c3RhcnREYXRlfSB0byAke2VuZERhdGV9YCk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBbcGxEYXRhLCBjZkRhdGEsIGJzRGF0YV0gPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoW1xyXG4gICAgICAgIHRoaXMuZ2V0UHJvZml0QW5kTG9zcyhzdGFydERhdGUsIGVuZERhdGUpLFxyXG4gICAgICAgIHRoaXMuZ2V0Q2FzaEZsb3coc3RhcnREYXRlLCBlbmREYXRlKSxcclxuICAgICAgICB0aGlzLmdldEJhbGFuY2VTaGVldChlbmREYXRlKVxyXG4gICAgICBdKTtcclxuXHJcbiAgICAgIC8vIExvZyByYXcgcmVzcG9uc2Ugc3RhdHVzIGFuZCBib2R5IGxlbmd0aCBmb3IgZWFjaCByZXBvcnRcclxuICAgICAgY29uc29sZS5pbmZvKCfwn5OKIEZpbmFuY2lhbCByZXBvcnRzIHJhdyByZXNwb25zZSBkZXRhaWxzOicsIHtcclxuICAgICAgICBwcm9maXRMb3NzOiB7XHJcbiAgICAgICAgICBzdGF0dXM6IHBsRGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICBib2R5TGVuZ3RoOiBwbERhdGEuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IEpTT04uc3RyaW5naWZ5KHBsRGF0YS52YWx1ZSB8fCB7fSkubGVuZ3RoIDogJ04vQScsXHJcbiAgICAgICAgICBoYXNEYXRhOiBwbERhdGEuc3RhdHVzID09PSAnZnVsZmlsbGVkJyAmJiBwbERhdGEudmFsdWUgJiYgT2JqZWN0LmtleXMocGxEYXRhLnZhbHVlIHx8IHt9KS5sZW5ndGggPiAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjYXNoRmxvdzoge1xyXG4gICAgICAgICAgc3RhdHVzOiBjZkRhdGEuc3RhdHVzLFxyXG4gICAgICAgICAgYm9keUxlbmd0aDogY2ZEYXRhLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyBKU09OLnN0cmluZ2lmeShjZkRhdGEudmFsdWUgfHwge30pLmxlbmd0aCA6ICdOL0EnLFxyXG4gICAgICAgICAgaGFzRGF0YTogY2ZEYXRhLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgJiYgY2ZEYXRhLnZhbHVlICYmIE9iamVjdC5rZXlzKGNmRGF0YS52YWx1ZSB8fCB7fSkubGVuZ3RoID4gMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYmFsYW5jZVNoZWV0OiB7XHJcbiAgICAgICAgICBzdGF0dXM6IGJzRGF0YS5zdGF0dXMsXHJcbiAgICAgICAgICBib2R5TGVuZ3RoOiBic0RhdGEuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IEpTT04uc3RyaW5naWZ5KGJzRGF0YS52YWx1ZSB8fCB7fSkubGVuZ3RoIDogJ04vQScsXHJcbiAgICAgICAgICBoYXNEYXRhOiBic0RhdGEuc3RhdHVzID09PSAnZnVsZmlsbGVkJyAmJiBic0RhdGEudmFsdWUgJiYgT2JqZWN0LmtleXMoYnNEYXRhLnZhbHVlIHx8IHt9KS5sZW5ndGggPiAwXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIENoZWNrIGZvciA0MDQgZXJyb3JzIGFuZCBsb2cgc3BlY2lmaWMgd2FybmluZ3NcclxuICAgICAgaWYgKHBsRGF0YS5zdGF0dXMgPT09ICdyZWplY3RlZCcpIHtcclxuICAgICAgICBjb25zdCBlcnJvciA9IHBsRGF0YS5yZWFzb24gYXMgYW55O1xyXG4gICAgICAgIGlmIChlcnJvcj8ucmVzcG9uc2U/LnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBQcm9maXQgJiBMb3NzIHJldHVybmVkIDQwNCAtIEludmFsaWQgZW5kcG9pbnQgLSBjaGVjayBab2hvIEFQSSBkb2NzJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIFByb2ZpdCAmIExvc3MgZGF0YSBmYWlsZWQ6JywgcGxEYXRhLnJlYXNvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChjZkRhdGEuc3RhdHVzID09PSAncmVqZWN0ZWQnKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3IgPSBjZkRhdGEucmVhc29uIGFzIGFueTtcclxuICAgICAgICBpZiAoZXJyb3I/LnJlc3BvbnNlPy5zdGF0dXMgPT09IDQwNCkge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gQ2FzaCBGbG93IHJldHVybmVkIDQwNCAtIEludmFsaWQgZW5kcG9pbnQgLSBjaGVjayBab2hvIEFQSSBkb2NzJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIENhc2ggRmxvdyBkYXRhIGZhaWxlZDonLCBjZkRhdGEucmVhc29uKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGJzRGF0YS5zdGF0dXMgPT09ICdyZWplY3RlZCcpIHtcclxuICAgICAgICBjb25zdCBlcnJvciA9IGJzRGF0YS5yZWFzb24gYXMgYW55O1xyXG4gICAgICAgIGlmIChlcnJvcj8ucmVzcG9uc2U/LnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBCYWxhbmNlIFNoZWV0IHJldHVybmVkIDQwNCAtIEludmFsaWQgZW5kcG9pbnQgLSBjaGVjayBab2hvIEFQSSBkb2NzJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIEJhbGFuY2UgU2hlZXQgZGF0YSBmYWlsZWQ6JywgYnNEYXRhLnJlYXNvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBFeHRyYWN0IGZpbmFuY2lhbCBtZXRyaWNzIGZyb20gdGhlIHJlc3BvbnNlcyB3aXRoIGZhbGxiYWNrc1xyXG4gICAgICBjb25zdCByZXZlbnVlID0gcGxEYXRhLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyAocGxEYXRhLnZhbHVlPy5yZXZlbnVlPy50b3RhbCB8fCAwKSA6IDA7XHJcbiAgICAgIGNvbnN0IGV4cGVuc2VzID0gcGxEYXRhLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyAocGxEYXRhLnZhbHVlPy5leHBlbnNlcz8udG90YWwgfHwgMCkgOiAwO1xyXG4gICAgICBjb25zdCBncm9zc1Byb2ZpdCA9IHJldmVudWUgLSBleHBlbnNlcztcclxuICAgICAgXHJcbiAgICAgIC8vIENhbGN1bGF0ZSBuZXQgcHJvZml0IChtYXkgbmVlZCBhZGp1c3RtZW50IGJhc2VkIG9uIGFjdHVhbCBab2hvIHJlc3BvbnNlIHN0cnVjdHVyZSlcclxuICAgICAgY29uc3Qgb3BlcmF0aW5nRXhwZW5zZXMgPSBwbERhdGEuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IChwbERhdGEudmFsdWU/Lm9wZXJhdGluZ19leHBlbnNlcz8udG90YWwgfHwgMCkgOiAwO1xyXG4gICAgICBjb25zdCBuZXRQcm9maXQgPSBncm9zc1Byb2ZpdCAtIG9wZXJhdGluZ0V4cGVuc2VzO1xyXG4gICAgICBjb25zdCBvcGVyYXRpbmdJbmNvbWUgPSBncm9zc1Byb2ZpdCAtIG9wZXJhdGluZ0V4cGVuc2VzO1xyXG4gICAgICBcclxuICAgICAgLy8gRXh0cmFjdCBjYXNoIGZsb3cgZGF0YVxyXG4gICAgICBjb25zdCBjYXNoRmxvdyA9IGNmRGF0YS5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gKGNmRGF0YS52YWx1ZT8ubmV0X2Nhc2hfZmxvdyB8fCAwKSA6IDA7XHJcbiAgICAgIGNvbnN0IGFjY291bnRzUmVjZWl2YWJsZSA9IGJzRGF0YS5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gKGJzRGF0YS52YWx1ZT8uY3VycmVudF9hc3NldHM/LmFjY291bnRzX3JlY2VpdmFibGUgfHwgMCkgOiAwO1xyXG4gICAgICBjb25zdCBhY2NvdW50c1BheWFibGUgPSBic0RhdGEuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IChic0RhdGEudmFsdWU/LmN1cnJlbnRfbGlhYmlsaXRpZXM/LmFjY291bnRzX3BheWFibGUgfHwgMCkgOiAwO1xyXG4gICAgICBjb25zdCBjYXNoQmFsYW5jZSA9IGJzRGF0YS5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gKGJzRGF0YS52YWx1ZT8uY3VycmVudF9hc3NldHM/LmNhc2hfYW5kX2JhbmsgfHwgMCkgOiAwO1xyXG5cclxuICAgICAgLy8gTG9nIHdoaWNoIGRhdGEgc291cmNlcyBzdWNjZWVkZWQvZmFpbGVkXHJcbiAgICAgIGNvbnNvbGUuaW5mbygn8J+TiiBGaW5hbmNpYWwgbWV0cmljcyBkYXRhIHNvdXJjZXM6Jywge1xyXG4gICAgICAgIHByb2ZpdExvc3M6IHBsRGF0YS5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gJ+KchScgOiAn4p2MJyxcclxuICAgICAgICBjYXNoRmxvdzogY2ZEYXRhLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyAn4pyFJyA6ICfinYwnLFxyXG4gICAgICAgIGJhbGFuY2VTaGVldDogYnNEYXRhLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyAn4pyFJyA6ICfinYwnXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICByZXZlbnVlLFxyXG4gICAgICAgIGV4cGVuc2VzLFxyXG4gICAgICAgIGdyb3NzUHJvZml0LFxyXG4gICAgICAgIG5ldFByb2ZpdCxcclxuICAgICAgICBvcGVyYXRpbmdJbmNvbWUsXHJcbiAgICAgICAgY2FzaEZsb3csXHJcbiAgICAgICAgYWNjb3VudHNSZWNlaXZhYmxlLFxyXG4gICAgICAgIGFjY291bnRzUGF5YWJsZSxcclxuICAgICAgICBjYXNoQmFsYW5jZVxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGZldGNoaW5nIGZpbmFuY2lhbCBtZXRyaWNzOicsIGVycm9yKTtcclxuICAgICAgY29uc29sZS53YXJuKCfwn46tIFJldHVybmluZyBkZWZhdWx0IGZpbmFuY2lhbCBtZXRyaWNzIGR1ZSB0byBBUEkgZmFpbHVyZScpO1xyXG4gICAgICBcclxuICAgICAgLy8gUmV0dXJuIGRlZmF1bHQgdmFsdWVzIGlmIEFQSSBjYWxscyBmYWlsXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgcmV2ZW51ZTogMCxcclxuICAgICAgICBleHBlbnNlczogMCxcclxuICAgICAgICBncm9zc1Byb2ZpdDogMCxcclxuICAgICAgICBuZXRQcm9maXQ6IDAsXHJcbiAgICAgICAgb3BlcmF0aW5nSW5jb21lOiAwLFxyXG4gICAgICAgIGNhc2hGbG93OiAwLFxyXG4gICAgICAgIGFjY291bnRzUmVjZWl2YWJsZTogMCxcclxuICAgICAgICBhY2NvdW50c1BheWFibGU6IDAsXHJcbiAgICAgICAgY2FzaEJhbGFuY2U6IDBcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIE1ldGhvZCB0byBtYW51YWxseSByZWZyZXNoIHRva2VuIChmb3IgdGVzdGluZylcclxuICBhc3luYyBmb3JjZVJlZnJlc2hUb2tlbigpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgdGhpcy5hY2Nlc3NUb2tlbiA9IG51bGw7XHJcbiAgICB0aGlzLnRva2VuRXhwaXJ5ID0gMDtcclxuICAgIHRoaXMubGFzdFJlZnJlc2hUaW1lID0gRGF0ZS5ub3coKTsgLy8gVHJhY2sgbWFudWFsIHJlZnJlc2ggdGltZVxyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKTtcclxuICB9XHJcblxyXG4gIC8vIEdldCB0b2tlbiBzdGF0dXMgZm9yIGRlYnVnZ2luZ1xyXG4gIGdldFRva2VuU3RhdHVzKCk6IHsgaGFzVG9rZW46IGJvb2xlYW47IGV4cGlyZXNJbjogbnVtYmVyOyBpc0V4cGlyZWQ6IGJvb2xlYW4gfSB7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaGFzVG9rZW46ICEhdGhpcy5hY2Nlc3NUb2tlbixcclxuICAgICAgZXhwaXJlc0luOiB0aGlzLnRva2VuRXhwaXJ5IC0gbm93LFxyXG4gICAgICBpc0V4cGlyZWQ6IG5vdyA+PSB0aGlzLnRva2VuRXhwaXJ5LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIE1ldGhvZCB0byBnZXQgYXV0by1yZWZyZXNoIHN0YXR1c1xyXG4gIGdldEF1dG9SZWZyZXNoU3RhdHVzKCk6IHsgaXNBY3RpdmU6IGJvb2xlYW47IG5leHRSZWZyZXNoSW46IG51bWJlciB9IHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCB0aW1lU2luY2VMYXN0UmVmcmVzaCA9IG5vdyAtIHRoaXMubGFzdFJlZnJlc2hUaW1lO1xyXG4gICAgY29uc3QgbmV4dFJlZnJlc2hJbiA9IE1hdGgubWF4KDAsIHRoaXMuQVVUT19SRUZSRVNIX0lOVEVSVkFMIC0gdGltZVNpbmNlTGFzdFJlZnJlc2gpO1xyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc0FjdGl2ZTogISF0aGlzLmF1dG9SZWZyZXNoVGltZXIsXHJcbiAgICAgIG5leHRSZWZyZXNoSW4sXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljIG1ldGhvZCB0byBzdGFydCBhdXRvLXJlZnJlc2hcclxuICBlbmFibGVBdXRvUmVmcmVzaCgpOiB2b2lkIHtcclxuICAgIHRoaXMuX3N0YXJ0QXV0b1JlZnJlc2goKTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gc3RvcCBhdXRvLXJlZnJlc2hcclxuICBkaXNhYmxlQXV0b1JlZnJlc2goKTogdm9pZCB7XHJcbiAgICB0aGlzLl9zdG9wQXV0b1JlZnJlc2goKTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYyBtZXRob2QgdG8gZ2V0IGNvbXByZWhlbnNpdmUgc3RhdHVzXHJcbiAgZ2V0U3RhdHVzKCk6IHsgXHJcbiAgICBoYXNUb2tlbjogYm9vbGVhbjsgXHJcbiAgICBleHBpcmVzSW46IG51bWJlcjsgXHJcbiAgICBpc0V4cGlyZWQ6IGJvb2xlYW47XHJcbiAgICBhdXRvUmVmcmVzaDogeyBpc0FjdGl2ZTogYm9vbGVhbjsgbmV4dFJlZnJlc2hJbjogbnVtYmVyIH07XHJcbiAgfSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi50aGlzLmdldFRva2VuU3RhdHVzKCksXHJcbiAgICAgIGF1dG9SZWZyZXNoOiB0aGlzLmdldEF1dG9SZWZyZXNoU3RhdHVzKCksXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHpvaG9TZXJ2aWNlID0gbmV3IFpvaG9TZXJ2aWNlKCk7IFxyXG5cclxuLy8gRXhwb3J0IHRoZSBmdW5jdGlvbnMgdGhhdCBhcmUgYmVpbmcgaW1wb3J0ZWQgaW4gcGFnZS50c3hcclxuZXhwb3J0IGNvbnN0IGZldGNoUHJvamVjdHMgPSBhc3luYyAoKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCdDbGllbnQ6IEZldGNoaW5nIHByb2plY3RzIGZyb20gQVBJJyk7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL3Byb2plY3RzJyk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICBcclxuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICBjb25zb2xlLmxvZygnQ2xpZW50OiBTdWNjZXNzZnVsbHkgZmV0Y2hlZCcsIHJlc3VsdC5jb3VudCwgJ3Byb2plY3RzJyk7XHJcbiAgICAgIHJldHVybiByZXN1bHQuZGF0YTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NsaWVudDogQVBJIHJldHVybmVkIGVycm9yOicsIHJlc3VsdC5lcnJvcik7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihyZXN1bHQuZXJyb3IpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdDbGllbnQ6IEVycm9yIGZldGNoaW5nIHByb2plY3RzOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBmZXRjaEludm9pY2VzID0gYXN5bmMgKCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygnQ2xpZW50OiBGZXRjaGluZyBpbnZvaWNlcyBmcm9tIEFQSScpO1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9pbnZvaWNlcycpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgXHJcbiAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgY29uc29sZS5sb2coJ0NsaWVudDogU3VjY2Vzc2Z1bGx5IGZldGNoZWQnLCByZXN1bHQuY291bnQsICdpbnZvaWNlcycpO1xyXG4gICAgICByZXR1cm4gcmVzdWx0LmRhdGE7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdDbGllbnQ6IEFQSSByZXR1cm5lZCBlcnJvcjonLCByZXN1bHQuZXJyb3IpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IocmVzdWx0LmVycm9yKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignQ2xpZW50OiBFcnJvciBmZXRjaGluZyBpbnZvaWNlczonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07ICJdLCJuYW1lcyI6WyJheGlvcyIsInBMaW1pdCIsIlpvaG9TZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJhY2Nlc3NUb2tlbiIsInRva2VuRXhwaXJ5IiwicmVmcmVzaFByb21pc2UiLCJUT0tFTl9SRUZSRVNIX0JVRkZFUiIsImF1dG9SZWZyZXNoVGltZXIiLCJBVVRPX1JFRlJFU0hfSU5URVJWQUwiLCJsYXN0UmVmcmVzaFRpbWUiLCJBQ0NPVU5UU19CQVNFIiwicHJvY2VzcyIsImVudiIsIlpPSE9fQUNDT1VOVFNfQkFTRSIsIkFQSV9CQVNFIiwiWk9IT19BUElfQkFTRSIsIm9yZ2FuaXphdGlvblZhbGlkYXRlZCIsInJlcXVlc3RDb3VudCIsImxhc3RSZXF1ZXN0VGltZSIsIk1BWF9SRVFVRVNUU19QRVJfTUlOVVRFIiwiTUlOX1JFUVVFU1RfSU5URVJWQUwiLCJyZXRyeUNvdW50IiwiTUFYX1JFVFJJRVMiLCJCQVNFX0RFTEFZIiwiY2FjaGVkQWNjZXNzVG9rZW4iLCJyYXRlTGltaXRlciIsIl9zdGFydEF1dG9SZWZyZXNoIiwiY29uc29sZSIsImxvZyIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsIkRhdGUiLCJub3ciLCJmb3JjZVJlZnJlc2hUb2tlbiIsImVycm9yIiwiX3N0b3BBdXRvUmVmcmVzaCIsImdldEFjY2Vzc1Rva2VuIiwidGltZVVudGlsRXhwaXJ5IiwiWk9IT19GT1JDRV9SRUZSRVNIIiwibWludXRlc0xlZnQiLCJNYXRoIiwicm91bmQiLCJaT0hPX0NMSUVOVF9JRCIsIlpPSE9fQ0xJRU5UX1NFQ1JFVCIsIlpPSE9fUkVGUkVTSF9UT0tFTiIsIm1pc3NpbmdWYXJzIiwicHVzaCIsIkVycm9yIiwiam9pbiIsIl9wZXJmb3JtVG9rZW5SZWZyZXNoV2l0aEJhY2tvZmYiLCJ0b2tlbiIsImlzQXhpb3NFcnJvciIsInN0YXR1cyIsInJlc3BvbnNlIiwic3RhdHVzVGV4dCIsImRhdGEiLCJtZXNzYWdlIiwiaGVhZGVycyIsInJhdGVMaW1pdEhlYWRlcnMiLCJ3YXJuIiwibWF4QXR0ZW1wdHMiLCJhdHRlbXB0IiwiZm9ybURhdGEiLCJVUkxTZWFyY2hQYXJhbXMiLCJhcHBlbmQiLCJwb3N0IiwidGltZW91dCIsImFjY2Vzc190b2tlbiIsImV4cGlyZXNfaW4iLCJzdWJzdHJpbmciLCJ0b0lTT1N0cmluZyIsInNjb3BlSW5mbyIsImNoZWNrVG9rZW5TY29wZXMiLCJzY29wZSIsImluY2x1ZGVzIiwic2NvcGVFcnIiLCJlcnIiLCJpc0F4aW9zIiwidW5kZWZpbmVkIiwiZGVzY3JpcHRpb24iLCJlcnJvcl9kZXNjcmlwdGlvbiIsInRvTG93ZXJDYXNlIiwiZGVsYXlNcyIsInBvdyIsImZsb29yIiwicmFuZG9tIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwicmVmcmVzaEFjY2Vzc1Rva2VuIiwibWFrZVJlcXVlc3QiLCJlbmRwb2ludCIsImFwcGx5UmF0ZUxpbWl0Iiwic3RhcnRzV2l0aCIsInZhbGlkYXRlT3JnYW5pemF0aW9uIiwiaW5mbyIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJ0aW1lb3V0SWQiLCJhYm9ydCIsImdldCIsInBhcmFtcyIsIm9yZ2FuaXphdGlvbl9pZCIsIlpPSE9fT1JHQU5JWkFUSU9OX0lEIiwic2lnbmFsIiwiY2xlYXJUaW1lb3V0IiwiYXhpb3NFcnJvciIsImNvZGUiLCJoYW5kbGVSYXRlTGltaXQiLCJuZXdUb2tlbiIsInJldHJ5UmVzcG9uc2UiLCJyZWZyZXNoRXJyb3IiLCJ1cmwiLCJlbmNvZGVVUklDb21wb25lbnQiLCJyZXMiLCJtc2ciLCJTdHJpbmciLCJKU09OIiwic3RyaW5naWZ5Iiwib3JnSWQiLCJvcmdzIiwib3JnYW5pemF0aW9ucyIsImZvdW5kIiwic29tZSIsIm8iLCJ0aW1lU2luY2VMYXN0UmVxdWVzdCIsIndhaXRUaW1lIiwidGltZVNpbmNlRmlyc3RSZXF1ZXN0IiwiZGVsYXkiLCJqaXR0ZXIiLCJ0b3RhbERlbGF5IiwiZ2V0UHJvamVjdHMiLCJhbGxQcm9qZWN0cyIsInBhZ2UiLCJwZXJQYWdlIiwicHJvamVjdHMiLCJtYXAiLCJwcm9qZWN0IiwibGVuZ3RoIiwicHJvamVjdF9pZCIsInByb2plY3RfbmFtZSIsIm5hbWUiLCJzdGFydF9kYXRlIiwiZW5kX2RhdGUiLCJidWRnZXRfYW1vdW50IiwicmF0ZV9wZXJfaG91ciIsImN1c3RvbWVyX2lkIiwiY3VzdG9tZXJfbmFtZSIsInNpZ25lZF9mZWUiLCJjb25jYXQiLCJnZXRQcm9qZWN0c1dpdGhSZXZlbnVlQnVkZ2V0IiwicHJvamVjdHNXaXRoUmV2ZW51ZUJ1ZGdldCIsImZpbHRlciIsImhhc1JldmVudWVCdWRnZXQiLCJkZWJ1Z1Byb2plY3RGaWVsZHMiLCJzYW1wbGVQcm9qZWN0IiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJrZXkiLCJyZXZlbnVlX2J1ZGdldCIsImdldFByb2plY3RzV2l0aEVzdGltYXRlcyIsInByb2plY3RzV2l0aEVzdGltYXRlcyIsImFsbCIsInNsaWNlIiwiZXN0aW1hdGVzIiwiZ2V0UHJvamVjdEVzdGltYXRlcyIsInRvdGFsRXN0aW1hdGVBbW91bnQiLCJyZWR1Y2UiLCJzdW0iLCJlc3RpbWF0ZSIsInRvdGFsIiwiZ2V0UHJvamVjdHNXaXRoSW52b2ljZVRvdGFscyIsImludm9pY2VzIiwiZ2V0SW52b2ljZXMiLCJwcm9qZWN0c1dpdGhJbnZvaWNlVG90YWxzIiwicHJvamVjdEludm9pY2VzIiwiaW52b2ljZSIsInRvdGFsSW52b2ljZUFtb3VudCIsImFtb3VudCIsImludm9pY2VfaWQiLCJpbnZvaWNlX251bWJlciIsImRhdGUiLCJiaWxsZWRfYW1vdW50IiwidW5iaWxsZWRfYW1vdW50Iiwic3RhdHVzQ291bnRzIiwiYWNjIiwiaW52Iiwic2FtcGxlSW52b2ljZSIsImlkIiwibnVtYmVyIiwiZ2V0UHJvamVjdEludm9pY2VzIiwicHJvamVjdElkIiwiZ2V0UHJvamVjdERldGFpbHMiLCJnZXRQcm9qZWN0Q29udHJhY3RzIiwiY29udHJhY3RzIiwiZ2V0UHJvZml0QW5kTG9zcyIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJzaXplQnl0ZXMiLCJnZXRDYXNoRmxvdyIsImdldEJhbGFuY2VTaGVldCIsImdldENoYXJ0T2ZBY2NvdW50cyIsImNoYXJ0b2ZhY2NvdW50cyIsImdldEpvdXJuYWxFbnRyaWVzIiwiam91cm5hbGVudHJpZXMiLCJnZXRGaW5hbmNpYWxNZXRyaWNzIiwicGxEYXRhIiwiY2ZEYXRhIiwiYnNEYXRhIiwiYWxsU2V0dGxlZCIsInByb2ZpdExvc3MiLCJib2R5TGVuZ3RoIiwidmFsdWUiLCJoYXNEYXRhIiwiY2FzaEZsb3ciLCJiYWxhbmNlU2hlZXQiLCJyZWFzb24iLCJyZXZlbnVlIiwiZXhwZW5zZXMiLCJncm9zc1Byb2ZpdCIsIm9wZXJhdGluZ0V4cGVuc2VzIiwib3BlcmF0aW5nX2V4cGVuc2VzIiwibmV0UHJvZml0Iiwib3BlcmF0aW5nSW5jb21lIiwibmV0X2Nhc2hfZmxvdyIsImFjY291bnRzUmVjZWl2YWJsZSIsImN1cnJlbnRfYXNzZXRzIiwiYWNjb3VudHNfcmVjZWl2YWJsZSIsImFjY291bnRzUGF5YWJsZSIsImN1cnJlbnRfbGlhYmlsaXRpZXMiLCJhY2NvdW50c19wYXlhYmxlIiwiY2FzaEJhbGFuY2UiLCJjYXNoX2FuZF9iYW5rIiwiZ2V0VG9rZW5TdGF0dXMiLCJoYXNUb2tlbiIsImV4cGlyZXNJbiIsImlzRXhwaXJlZCIsImdldEF1dG9SZWZyZXNoU3RhdHVzIiwidGltZVNpbmNlTGFzdFJlZnJlc2giLCJuZXh0UmVmcmVzaEluIiwibWF4IiwiaXNBY3RpdmUiLCJlbmFibGVBdXRvUmVmcmVzaCIsImRpc2FibGVBdXRvUmVmcmVzaCIsImdldFN0YXR1cyIsImF1dG9SZWZyZXNoIiwiem9ob1NlcnZpY2UiLCJmZXRjaFByb2plY3RzIiwiZmV0Y2giLCJyZXN1bHQiLCJqc29uIiwic3VjY2VzcyIsImNvdW50IiwiZmV0Y2hJbnZvaWNlcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/zoho.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/mime-db","vendor-chunks/axios","vendor-chunks/follow-redirects","vendor-chunks/debug","vendor-chunks/form-data","vendor-chunks/get-intrinsic","vendor-chunks/asynckit","vendor-chunks/combined-stream","vendor-chunks/mime-types","vendor-chunks/proxy-from-env","vendor-chunks/ms","vendor-chunks/supports-color","vendor-chunks/has-symbols","vendor-chunks/delayed-stream","vendor-chunks/function-bind","vendor-chunks/p-limit","vendor-chunks/es-set-tostringtag","vendor-chunks/get-proto","vendor-chunks/call-bind-apply-helpers","vendor-chunks/dunder-proto","vendor-chunks/yocto-queue","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/has-flag","vendor-chunks/gopd","vendor-chunks/es-define-property","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/es-object-atoms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftop-projects%2Froute&page=%2Fapi%2Ftop-projects%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftop-projects%2Froute.ts&appDir=C%3A%5CUsers%5CJonathan%5CDesktop%5CBilling%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CJonathan%5CDesktop%5CBilling&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();
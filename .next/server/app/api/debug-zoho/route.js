"use strict";(()=>{var e={};e.id=1047,e.ids=[1047],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74175:e=>{e.exports=require("tty")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},19164:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>f,patchFetch:()=>m,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var s={};a.r(s),a.d(s,{GET:()=>u,dynamic:()=>l});var o=a(49303),r=a(88716),n=a(60670),i=a(87070),c=a(87707);let l="force-dynamic";async function u(e){try{console.log("\uD83D\uDD0D Starting Zoho Books Financial Data Diagnostic...\n");let e={environmentVariables:{},tokenStatus:{},basicApiTests:{},financialReports:{},recommendations:[]};console.log("\uD83D\uDCCB Environment Variables Check:"),e.environmentVariables={ZOHO_ORGANIZATION_ID:"✅ Set",ZOHO_CLIENT_ID:"✅ Set",ZOHO_CLIENT_SECRET:"✅ Set",ZOHO_REFRESH_TOKEN:"✅ Set",ZOHO_ACCOUNTS_BASE:process.env.ZOHO_ACCOUNTS_BASE||"Using default",ZOHO_API_BASE:process.env.ZOHO_API_BASE||"Using default"},console.log("\uD83D\uDD11 Token Status Check:");try{e.tokenStatus={status:c.VC.getTokenStatus(),autoRefresh:c.VC.getAutoRefreshStatus(),overall:c.VC.getStatus()}}catch(t){e.tokenStatus={error:t instanceof Error?t.message:"Unknown error"}}console.log("\uD83C\uDF10 Testing Basic API Connectivity:");try{let t=await c.VC.getProjects();e.basicApiTests.projects={status:"✅ Working",count:t.length,message:`${t.length} projects found`}}catch(t){e.basicApiTests.projects={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error"}}try{let t=await c.VC.getInvoices();e.basicApiTests.invoices={status:"✅ Working",count:t.length,message:`${t.length} invoices found`}}catch(t){e.basicApiTests.invoices={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error"}}console.log("\uD83D\uDCB0 Testing Financial Reports:");let t=new Date().getFullYear(),s=`${t}-01-01`,o=new Date().toISOString().split("T")[0],r="2024-01-01",n=new Date().toISOString().split("T")[0],l="2024-04-01",u="2025-03-31",p="2023-04-01",d="2024-03-31";try{console.log(`Testing Profit & Loss (${s} to ${o}):`);let t=await c.VC.getProfitAndLoss(s,o);t?e.financialReports.profitAndLoss={status:"✅ Working",dataKeys:Object.keys(t||{}),revenue:t?.revenue?.total||"N/A",expenses:t?.expenses?.total||"N/A"}:e.financialReports.profitAndLoss={status:"⚠️ No data returned",message:"Profit & Loss returned empty data"}}catch(t){e.financialReports.profitAndLoss={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error",details:t.response?{status:t.response.status,data:t.response.data}:void 0}}try{console.log(`Testing Cash Flow (${s} to ${o}):`);let t=await c.VC.getCashFlow(s,o);t?e.financialReports.cashFlow={status:"✅ Working",dataKeys:Object.keys(t||{}),netCashFlow:t?.net_cash_flow||"N/A"}:e.financialReports.cashFlow={status:"⚠️ No data returned",message:"Cash Flow returned empty data"}}catch(t){e.financialReports.cashFlow={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error",details:t.response?{status:t.response.status,data:t.response.data}:void 0}}try{console.log(`Testing Balance Sheet (${o}):`);let t=await c.VC.getBalanceSheet(o);t?e.financialReports.balanceSheet={status:"✅ Working",dataKeys:Object.keys(t||{}),currentAssets:t?.current_assets?"Available":"N/A",currentLiabilities:t?.current_liabilities?"Available":"N/A"}:e.financialReports.balanceSheet={status:"⚠️ No data returned",message:"Balance Sheet returned empty data"}}catch(t){e.financialReports.balanceSheet={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error",details:t.response?{status:t.response.status,data:t.response.data}:void 0}}console.log("\uD83D\uDCCA Testing Comprehensive Financial Metrics:");try{let t=await c.VC.getFinancialMetrics(s,o);e.financialReports.comprehensiveMetrics={status:"✅ Working",revenue:t.revenue,expenses:t.expenses,operatingIncome:t.operatingIncome,cashFlow:t.cashFlow}}catch(t){e.financialReports.comprehensiveMetrics={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error",details:t.response?{status:t.response.status,data:t.response.data}:void 0}}console.log("\uD83D\uDCCA Testing Financial Metrics with Broader Date Range (2024 onwards):");try{let t=await c.VC.getFinancialMetrics(r,n);e.financialReports.broaderDateRange={status:"✅ Working",revenue:t.revenue,expenses:t.expenses,operatingIncome:t.operatingIncome,cashFlow:t.cashFlow,dateRange:`${r} to ${n}`}}catch(t){e.financialReports.broaderDateRange={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error",details:t.response?{status:t.response.status,data:t.response.data}:void 0}}console.log("\uD83D\uDCCA Testing Financial Metrics with Fiscal Year Periods:");try{let t=await c.VC.getFinancialMetrics(l,u);e.financialReports.fiscalYear2024={status:"✅ Working",revenue:t.revenue,expenses:t.expenses,operatingIncome:t.operatingIncome,cashFlow:t.cashFlow,dateRange:`${l} to ${u}`}}catch(t){e.financialReports.fiscalYear2024={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error"}}try{let t=await c.VC.getFinancialMetrics(p,d);e.financialReports.fiscalYear2023={status:"✅ Working",revenue:t.revenue,expenses:t.expenses,operatingIncome:t.operatingIncome,cashFlow:t.cashFlow,dateRange:`${p} to ${d}`}}catch(t){e.financialReports.fiscalYear2023={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error"}}try{let t=await c.VC.getFinancialMetrics("2024-01-01","2024-12-31");e.financialReports.calendarYear2024={status:"✅ Working",revenue:t.revenue,expenses:t.expenses,operatingIncome:t.operatingIncome,cashFlow:t.cashFlow,dateRange:"2024-01-01 to 2024-12-31"}}catch(t){e.financialReports.calendarYear2024={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error"}}console.log("\uD83D\uDCCA Testing with Much Broader Date Ranges:");try{let t=await c.VC.getFinancialMetrics("2020-01-01","2025-12-31");e.financialReports.fiveYearRange={status:"✅ Working",revenue:t.revenue,expenses:t.expenses,operatingIncome:t.operatingIncome,cashFlow:t.cashFlow,dateRange:"2020-01-01 to 2025-12-31"}}catch(t){e.financialReports.fiveYearRange={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error"}}try{let t=await c.VC.getFinancialMetrics("2024-06-01","2024-12-31");e.financialReports.specificDateRange={status:"✅ Working",revenue:t.revenue,expenses:t.expenses,operatingIncome:t.operatingIncome,cashFlow:t.cashFlow,dateRange:"2024-06-01 to 2024-12-31"}}catch(t){e.financialReports.specificDateRange={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error"}}console.log("\uD83C\uDFE2 Testing Organization Access and Transaction Data:");try{let t=await c.VC.getAccessToken();if(t){let s=await a.e(4760).then(a.bind(a,44760)),o=await s.default.get(`${process.env.ZOHO_API_BASE||"https://www.zohoapis.com"}/books/v3/organizations`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},timeout:15e3}),r=o.data?.organizations||[],n=null;try{let e=await s.default.get(`${process.env.ZOHO_API_BASE||"https://www.zohoapis.com"}/books/v3/transactions?organization_id=652094923&date_start=2020-01-01&date_end=2025-12-31&per_page=1`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},timeout:15e3});n={hasTransactions:e.data?.transactions?.length>0,transactionCount:e.data?.page_context?.total||0,sampleTransaction:e.data?.transactions?.[0]||null}}catch(e){n={error:e instanceof Error?e.message:"Unknown error"}}let i=null;try{let e=await s.default.get(`${process.env.ZOHO_API_BASE||"https://www.zohoapis.com"}/books/v3/reports/profitandloss?organization_id=880131765&from_date=2024-01-01&to_date=2024-12-31`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},timeout:15e3});i={hasData:!!e.data?.profit_and_loss,dataKeys:Object.keys(e.data||{}),sampleData:e.data?.profit_and_loss||null}}catch(e){i={error:e instanceof Error?e.message:"Unknown error"}}e.organizationTest={status:"✅ Working",organizationsFound:r.length,organizations:r.map(e=>({id:e.organization_id,name:e.name,fiscalYearStart:e.fiscal_year_start_month})),configuredOrgId:"652094923",transactionData:n,otherOrganizationData:i}}else e.organizationTest={status:"❌ Failed",error:"Could not obtain access token"}}catch(t){e.organizationTest={status:"❌ Failed",error:t instanceof Error?t.message:"Unknown error"}}if(e.recommendations=["Check if your Zoho Books account has the Reports module enabled","Verify that your OAuth app has the ZohoBooks.reports.READ scope","Ensure your organization ID is correct and has financial data","Check if there are any date range restrictions in your Zoho account","Verify that your Zoho Books subscription includes financial reporting features"],e.financialReports.profitAndLoss?.status==="❌ Failed"){let t=e.financialReports.profitAndLoss.details?.status;404===t?e.recommendations.push("\uD83D\uDD0D 404 Error: Reports endpoints not found. Check if your Zoho Books plan includes financial reporting."):401===t?e.recommendations.push("\uD83D\uDD10 401 Error: Authentication failed. Check OAuth scopes and token validity."):403===t?e.recommendations.push("\uD83D\uDEAB 403 Error: Access forbidden. Check if Reports module is enabled in your Zoho Books account."):429===t&&e.recommendations.push("⏰ 429 Error: Rate limited. Zoho API rate limits exceeded.")}return console.log("✅ Diagnostic completed successfully"),i.NextResponse.json(e)}catch(e){return console.error("❌ Diagnostic failed:",e),i.NextResponse.json({error:"Diagnostic failed",message:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/debug-zoho/route",pathname:"/api/debug-zoho",filename:"route",bundlePath:"app/api/debug-zoho/route"},resolvedPagePath:"C:\\Users\\Jonathan\\Desktop\\Billing\\app\\api\\debug-zoho\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:g,serverHooks:h}=p,f="/api/debug-zoho/route";function m(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[9276,5972,8918,7707],()=>a(19164));module.exports=s})();
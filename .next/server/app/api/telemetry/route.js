"use strict";(()=>{var e={};e.id=3810,e.ids=[3810],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74175:e=>{e.exports=require("tty")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},76682:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>q,patchFetch:()=>f,requestAsyncStorage:()=>y,routeModule:()=>x,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{DELETE:()=>m,GET:()=>d,dynamic:()=>p,runtime:()=>l});var o=t(49303),a=t(88716),n=t(60670),i=t(87070),u=t(57033),c=t(44261);let p="force-dynamic",l="nodejs";async function d(e){try{let{searchParams:r}=new URL(e.url),t=parseInt(r.get("hours")||"24",10),s=r.get("endpoint"),o=await u.M.getSystemMetrics(t),a=null;s&&(a=await u.M.getAnalytics(s,t));let n=await c.zv.getCacheStats();return i.NextResponse.json({success:!0,timeRange:`Last ${t} hours`,systemMetrics:o,endpointAnalytics:a,cacheStats:n})}catch(e){return console.error("Error fetching telemetry:",e),i.NextResponse.json({success:!1,error:"Failed to fetch telemetry data",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function m(e){try{let{searchParams:r}=new URL(e.url),t=r.get("action");if("cleanup-telemetry"===t){let e=parseInt(r.get("days")||"30",10),t=await u.M.cleanup(e);return i.NextResponse.json({success:!0,message:`Cleaned up ${t} old telemetry records`,deleted:t})}if("clear-cache"===t)return await c.zv.clearAllCaches(),i.NextResponse.json({success:!0,message:"All caches cleared successfully"});return i.NextResponse.json({success:!1,error:"Invalid action. Use ?action=cleanup-telemetry or ?action=clear-cache"},{status:400})}catch(e){return console.error("Error in telemetry DELETE:",e),i.NextResponse.json({success:!1,error:"Failed to perform action",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let x=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/telemetry/route",pathname:"/api/telemetry",filename:"route",bundlePath:"app/api/telemetry/route"},resolvedPagePath:"C:\\Users\\Jonathan\\Desktop\\Billing\\app\\api\\telemetry\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:y,staticGenerationAsyncStorage:h,serverHooks:g}=x,q="/api/telemetry/route";function f(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,8918,4261],()=>t(76682));module.exports=s})();
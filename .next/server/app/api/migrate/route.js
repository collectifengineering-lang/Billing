"use strict";(()=>{var e={};e.id=896,e.ids=[896],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},64560:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>j,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>u});var r={};a.r(r),a.d(r,{POST:()=>p,dynamic:()=>d});var o=a(49303),s=a(88716),n=a(60670),c=a(87070),i=a(52663);let d="force-dynamic";async function p(){try{if(console.log("DATABASE_URL (redacted):",process.env.DATABASE_URL?.replace(/\/\/.*@/,"//[redacted]@")||"Not set"),console.log("Attempting migration..."),await i.Z.projection.findFirst())return console.log("Data already exists in database, skipping migration"),c.NextResponse.json({success:!0,message:"Database schema already exists"});return console.log("Creating test data to verify migration..."),await i.Z.projection.create({data:{projectId:"test-project-1",month:"2024-01",value:1e3}}),await i.Z.status.create({data:{projectId:"test-project-1",month:"2024-01",status:"active"}}),await i.Z.comment.create({data:{projectId:"test-project-1",month:"2024-01",comment:"Test comment"}}),await i.Z.signedFee.create({data:{projectId:"test-project-1",value:500}}),await i.Z.asrFee.create({data:{projectId:"test-project-1",value:200}}),await i.Z.closedProject.create({data:{projectId:"test-project-2"}}),await i.Z.projectAssignment.create({data:{projectId:"test-project-1",managerId:"manager-1"}}),await i.Z.projectManager.create({data:{id:"manager-1",name:"Test Manager",color:"#ff0000"}}),await i.Z.projection.deleteMany({where:{projectId:"test-project-1"}}),await i.Z.status.deleteMany({where:{projectId:"test-project-1"}}),await i.Z.comment.deleteMany({where:{projectId:"test-project-1"}}),await i.Z.signedFee.deleteMany({where:{projectId:"test-project-1"}}),await i.Z.asrFee.deleteMany({where:{projectId:"test-project-1"}}),await i.Z.closedProject.deleteMany({where:{projectId:"test-project-2"}}),await i.Z.projectAssignment.deleteMany({where:{projectId:"test-project-1"}}),await i.Z.projectManager.deleteMany({where:{id:"manager-1"}}),console.log("Migration completed successfully"),c.NextResponse.json({success:!0,message:"Migration completed successfully"})}catch(a){console.error("Migration error:",a),console.error("DATABASE_URL (redacted):",process.env.DATABASE_URL?.replace(/\/\/.*@/,"//[redacted]@")||"Not set");let e=a instanceof Error?a.message:"Unknown error",t={message:e,type:a instanceof Error?a.constructor.name:"Unknown",code:a instanceof Error&&"code"in a?a.code:void 0};return c.NextResponse.json({error:"Migration failed: "+e,details:t},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/migrate/route",pathname:"/api/migrate",filename:"route",bundlePath:"app/api/migrate/route"},resolvedPagePath:"C:\\Users\\Jonathan\\Desktop\\Billing\\app\\api\\migrate\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:u,serverHooks:g}=l,j="/api/migrate/route";function w(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:u})}},52663:(e,t,a)=>{a.d(t,{Z:()=>o});let r=require("@prisma/client"),o=globalThis.prisma??new r.PrismaClient({log:["error"]})}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[276,972],()=>a(64560));module.exports=r})();
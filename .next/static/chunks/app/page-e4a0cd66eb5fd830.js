(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{78929:function(e,t,r){Promise.resolve().then(r.bind(r,36800))},36800:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ed}});var a=r(57437),s=r(2265),l=r(27648),i=r(98239),o=r(46244),n=r(63639),c=r(58896),d=r(46221),x=r(98420),m=r(95252),h=r(91723),u=r(33327),b=r(48736),g=r(70525),p=r(95805),j=r(42488),f=r(33245),y=r(11239),v=r(76858),N=r(32489),w=r(31047),k=r(66070),C=r(35974);function P(e){var t;let{isOpen:r,onClose:s,project:l}=e;if(!l)return null;let n=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),d=e=>"".concat((100*e).toFixed(1),"%");return(0,a.jsx)(o.M,{children:r&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s,children:(0,a.jsxs)(i.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:(0,a.jsx)(x.Z,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:l.name}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:l.customer})]})]}),(0,a.jsx)("button",{onClick:s,className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-colors duration-200",children:(0,a.jsx)(N.Z,{className:"h-6 w-6 text-gray-500"})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(C.C,{className:"".concat((e=>{switch(e){case"active":return"bg-green-100 text-green-800 border-green-200";case"completed":return"bg-blue-100 text-blue-800 border-blue-200";case"on-hold":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(l.status||"unknown")," border"),children:(null===(t=l.status)||void 0===t?void 0:t.charAt(0).toUpperCase())+(l.status||"").slice(1)}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-300",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:new Date(l.startDate||"").toLocaleDateString()}),l.endDate&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"-"}),(0,a.jsx)("span",{children:new Date(l.endDate).toLocaleDateString()})]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Budget"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n(l.budget||0)})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 border-0",children:(0,a.jsx)(k.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(m.Z,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Revenue"}),(0,a.jsx)("p",{className:"text-xl font-bold text-blue-900 dark:text-blue-100",children:n(l.revenue||0)})]})]})})}),(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border-0",children:(0,a.jsx)(k.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(h.Z,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Hours"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-green-900 dark:text-green-100",children:[l.hours||0,"h"]})]})]})})}),(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 border-0",children:(0,a.jsx)(k.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(c.Z,{className:"h-8 w-8 text-purple-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:"Efficiency"}),(0,a.jsx)("p",{className:"text-xl font-bold text-purple-900 dark:text-purple-100",children:d(l.efficiency||0)})]})]})})}),(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 border-0",children:(0,a.jsx)(k.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(g.Z,{className:"h-8 w-8 text-orange-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:"Profit Margin"}),(0,a.jsx)("p",{className:"text-xl font-bold text-orange-900 dark:text-orange-100",children:d(l.profitMargin||0)})]})]})})})]}),(0,a.jsxs)(k.Zb,{className:"border-0 shadow-lg",children:[(0,a.jsxs)(k.Ol,{children:[(0,a.jsx)(k.ll,{className:"text-xl font-bold",children:"Financial Summary"}),(0,a.jsx)(k.SZ,{children:"Project financial performance overview"})]}),(0,a.jsx)(k.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Total Budget"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n(l.budget||0)})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Amount Billed"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:n(l.billed||0)})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Remaining"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:n((l.budget||0)-(l.billed||0))})]})]})})]}),(l.totalHours||l.billableHours||l.entryCount)&&(0,a.jsxs)(k.Zb,{className:"border-0 shadow-lg",children:[(0,a.jsxs)(k.Ol,{children:[(0,a.jsx)(k.ll,{className:"text-xl font-bold",children:"Time Tracking (Clockify)"}),(0,a.jsx)(k.SZ,{children:"Project time tracking data from Clockify"})]}),(0,a.jsx)(k.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Total Hours"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[(l.totalHours||0).toFixed(1),"h"]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Billable Hours"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[(l.billableHours||0).toFixed(1),"h"]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Time Entries"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:l.entryCount||0})]})]})})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-slate-700",children:[(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white transition-colors duration-200",children:"Close"}),(0,a.jsx)("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"View Full Details"})]})]})]})})})}var S=r(29),E=r.n(S),I=r(54887),Z=r(60413),F=r(94508),T=r(22135),O=r(40875),D=r(73247),A=r(92369),R=r(30401),H=r(69064),B=r(92735),M=r(17689),L=r(65302),Y=r(22252);function z(e){let t=[],r="",a=!1;for(let s=0;s<e.length;s++){let l=e[s];'"'===l?a&&'"'===e[s+1]?(r+='"',s++):a=!a:","!==l||a?r+=l:(t.push(r.trim()),r="")}return t.push(r.trim()),t}function U(e){let[t,r]=e.split("-");return new Date(parseInt(t),parseInt(r)-1).toLocaleDateString("en-US",{month:"short",year:"numeric"})}function V(e,t){let r=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");if(void 0!==a.download){let e=URL.createObjectURL(r);a.setAttribute("href",e),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}function J(e){let{billingData:t,monthlyProjections:r,asrFees:l,signedFees:i,monthRange:o,onImportData:n}=e,[c,d]=(0,s.useState)(!1),[x,m]=(0,s.useState)(null),[h,u]=(0,s.useState)(!1),g=(0,s.useRef)(null),p=async e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];if(a){if(!a.name.toLowerCase().endsWith(".csv")){H.Am.error("Please select a CSV file");return}d(!0),m(null);try{let e=await new Promise((e,t)=>{let r=new FileReader;r.onload=t=>{var r;e(null===(r=t.target)||void 0===r?void 0:r.result)},r.onerror=()=>{t(Error("Failed to read CSV file"))},r.readAsText(a)}),r=function(e,t){try{let r=e.trim().split("\n");if(r.length<2)return{success:!1,errors:["CSV file must have at least a header row and one data row"]};let a=z(r[0]),s=r.slice(1),l=["Project ID","Project Name","Customer Name","Signed Fee","ASR Fee"].filter(e=>!a.includes(e));if(l.length>0)return{success:!1,errors:["Missing required headers: ".concat(l.join(", "))]};let i=a.slice(5),o=i.filter(e=>!/^\d{4}-\d{2}$/.test(e));if(o.length>0)return{success:!1,errors:["Invalid month format found: ".concat(o.join(", "),". Expected format: YYYY-MM")]};let n={},c=[];if(s.forEach((e,r)=>{let s=z(e);if(s.length!==a.length){c.push("Row ".concat(r+2,": Column count mismatch. Expected ").concat(a.length,", got ").concat(s.length));return}let l=s[0].trim();if(s[1],s[2],parseFloat(s[3]),parseFloat(s[4]),!t.some(e=>e.projectId===l)){c.push("Row ".concat(r+2,': Project ID "').concat(l,'" not found in current data'));return}let o={};i.forEach((e,t)=>{let r=parseFloat(s[5+t])||0;o[e]=r}),n[l]=o}),c.length>0)return{success:!1,errors:c,data:n};return{success:!0,data:n,message:"Successfully imported ".concat(Object.keys(n).length," projects with ").concat(i.length," months of data")}}catch(e){return{success:!1,errors:["Error parsing CSV: ".concat(e instanceof Error?e.message:"Unknown error")]}}}(e,t);m(r),r.success&&r.data?H.Am.success(r.message||"Import completed successfully!"):H.Am.error("Import failed. Please check the errors below.")}catch(e){console.error("Import error:",e),H.Am.error("Failed to read CSV file"),m({success:!1,errors:["Failed to read CSV file"]})}finally{d(!1)}}},j=()=>{u(!1),m(null),g.current&&(g.current.value="")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,a.jsxs)("button",{onClick:()=>{try{let e=function(e,t,r,a,s){let l=["Project ID","Project Name","Customer Name","Signed Fee","ASR Fee",...s.map(e=>U(e))],i=e.map(e=>{let l={projectId:e.projectId,projectName:e.projectName,customerName:e.customerName,signedFee:a[e.projectId]||e.signedFee||0,asrFee:r[e.projectId]||0};return s.forEach(r=>{var a;let s=(null===(a=t[e.projectId])||void 0===a?void 0:a[r])||0;l[r]=s}),l});return[l.join(","),...i.map(e=>l.map(t=>{let r;if("Project ID"===t){let t=e.projectId;console.log("CSV Export - Project ID type:",typeof t,"value:",t),console.log("CSV Export - Final Project ID value:",r="number"==typeof t||"string"==typeof t?String(t):"")}else if("Project Name"===t)r=e.projectName;else if("Customer Name"===t)r=e.customerName;else if("Signed Fee"===t)r=e.signedFee;else if("ASR Fee"===t)r=e.asrFee;else{let a=s.find(e=>U(e)===t);r=a?e[a]:0}let a=String(r).replace(/"/g,'""');return'"'.concat(a,'"')}).join(","))].join("\n")}(t,r,l,i,o),a=function(){let e=new Date,t=e.toISOString().slice(0,10),r=e.toTimeString().slice(0,8).replace(/:/g,"-");return"projections-export-".concat(t,"-").concat(r,".csv")}();V(e,a),H.Am.success("Projections exported successfully!")}catch(e){console.error("Export error:",e),H.Am.error("Failed to export projections")}},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,a.jsx)(B.Z,{className:"w-4 h-4"}),"Export to CSV"]}),(0,a.jsxs)("button",{onClick:()=>{u(!0),m(null)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,a.jsx)(M.Z,{className:"w-4 h-4"}),"Import from CSV"]}),(0,a.jsxs)("button",{onClick:()=>{V("Project ID,Project Name,Customer Name,Signed Fee,ASR Fee,2024-01,2024-02,2024-03,2024-04,2024-05,2024-06\n910829000008470049,Sample Project,Sample Customer,50000,10000,5000,7500,6000,8000,9000,7000","projections-template.csv"),H.Am.success("Template downloaded successfully!")},className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[(0,a.jsx)(b.Z,{className:"w-4 h-4"}),"Download Template"]})]}),h&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,a.jsx)(b.Z,{className:"w-5 h-5"}),"Import Projections from CSV"]}),(0,a.jsx)("button",{onClick:j,className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(N.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Select a CSV file to import projections data. The file should include:"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 list-disc list-inside mb-4",children:[(0,a.jsx)("li",{children:"Project ID, Project Name, Customer Name"}),(0,a.jsx)("li",{children:"Signed Fee and ASR Fee columns"}),(0,a.jsx)("li",{children:"Monthly projection columns (format: YYYY-MM)"})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Tip:"}),' Use the "Download Template" button to get a sample CSV file with the correct format.']})}),(0,a.jsx)("input",{ref:g,type:"file",accept:".csv",onChange:p,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",disabled:c})]}),x&&(0,a.jsxs)("div",{className:"mb-4",children:[x.success?(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsx)(L.Z,{className:"w-5 h-5 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-green-800 font-medium",children:"Import Successful"}),(0,a.jsx)("p",{className:"text-green-700 text-sm",children:x.message})]})]}):(0,a.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)(Y.Z,{className:"w-5 h-5 text-red-600 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-red-800 font-medium",children:"Import Failed"}),x.errors&&(0,a.jsx)("ul",{className:"text-red-700 text-sm mt-1",children:x.errors.map((e,t)=>(0,a.jsx)("li",{className:"list-disc list-inside",children:e},t))})]})]}),!x.success&&x.data&&Object.keys(x.data).length>0&&(0,a.jsx)("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-yellow-800 text-sm",children:'Some data was successfully parsed. You can still import the valid data by clicking "Import Valid Data".'})})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)("button",{onClick:j,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(null==x?void 0:x.data)&&Object.keys(x.data).length>0&&(0,a.jsxs)("button",{onClick:()=>{(null==x?void 0:x.success)&&x.data&&(n(x.data),u(!1),m(null),H.Am.success("Data imported successfully!"))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:["Import ",x.success?"All":"Valid"," Data"]})]})]})})]})}var K=r(77086);function W(e){let{billingData:t,projections:r,onUpdateProjections:l,closedProjects:i,onClosedProjectsChange:o,useDB:n=!0}=e,c=t||[],[d,x]=(0,s.useState)(null),[m,h]=(0,s.useState)(null),[u,b]=(0,s.useState)(null),[g,p]=(0,s.useState)(""),[j,f]=(0,s.useState)(null),[y,v]=(0,s.useState)(null),w=(0,s.useRef)(null),[k,C]=(0,s.useState)(null),[P,S]=(0,s.useState)(null),B=(0,s.useRef)(null),[M,L]=(0,s.useState)(null),[Y,z]=(0,s.useState)(""),[U,V]=(0,s.useState)(null),[W,G]=(0,s.useState)(i||new Set),[_,X]=(0,s.useState)([]),[$,q]=(0,s.useState)({}),[Q,ee]=(0,s.useState)(!1),[et,er]=(0,s.useState)({field:"projectName",direction:"asc"}),[ea,es]=(0,s.useState)(""),el=e=>fetch(e).then(e=>e.json()),ei={revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshInterval:0},{data:eo,mutate:en}=(0,K.ZP)("/api/signed-fees",el,ei),{data:ec,mutate:ed}=(0,K.ZP)("/api/asr-fees",el,ei),{data:ex,mutate:em}=(0,K.ZP)("/api/projections",el,ei),{data:eh,mutate:eu}=(0,K.ZP)("/api/statuses",el,ei),{data:eb,mutate:eg}=(0,K.ZP)("/api/comments",el,ei),{data:ep,mutate:ej}=(0,K.ZP)("/api/project-assignments",el,ei),{data:ef,mutate:ey}=(0,K.ZP)("/api/project-managers",el,ei),{data:ev,mutate:eN}=(0,K.ZP)("/api/project-statuses",el,ei),[ew,ek]=(0,s.useState)({}),[eC,eP]=(0,s.useState)({}),[eS,eE]=(0,s.useState)({}),[eI,eZ]=(0,s.useState)({}),[eF,eT]=(0,s.useState)({}),eO=(0,s.useRef)(null),eD=(0,s.useRef)(null),eA=(0,s.useRef)(null),eR=(0,s.useRef)(null),eH=(0,s.useRef)(null),eB=(0,s.useRef)(null),eM=(0,s.useRef)(null),eL=(0,s.useRef)(null),[eY,ez]=(0,s.useState)(0),[eU,eV]=(0,s.useState)(0),[eJ,eK]=(0,s.useState)(!1),[eW,eG]=(0,s.useState)(0),[e_,eX]=(0,s.useState)(0),e$=(0,s.useMemo)(()=>(0,F.ji)(),[]),eq=(0,s.useMemo)(()=>new Date().toISOString().slice(0,7),[]);(0,s.useEffect)(()=>{eo&&Object.keys(eo).length>0&&ek(eo)},[eo]),(0,s.useEffect)(()=>{ec&&Object.keys(ec).length>0&&eP(ec)},[ec]),(0,s.useEffect)(()=>{ex&&Object.keys(ex).length>0&&eE(ex)},[ex]),(0,s.useEffect)(()=>{eh&&Object.keys(eh).length>0&&eZ(eh)},[eh]),(0,s.useEffect)(()=>{eb&&Object.keys(eb).length>0&&eT(eb)},[eb]),(0,s.useEffect)(()=>{if(ev&&"object"==typeof ev){let e=new Set(Object.entries(ev).filter(e=>{let[t,r]=e;return"closed"===r}).map(e=>{let[t,r]=e;return t}));G(e),null==o||o(e)}},[ev,o]),(0,s.useEffect)(()=>{ep&&"object"==typeof ep&&q(ep)},[ep]),(0,s.useEffect)(()=>{ef&&Array.isArray(ef)&&X(ef)},[ef]),(0,s.useEffect)(()=>()=>{f(null),v(null),C(null),S(null),L(null),V(null)},[]),(0,s.useEffect)(()=>{console.log("HighPerformanceTable: projectManagers state changed:",_)},[_]),(0,s.useEffect)(()=>{let e=setInterval(()=>{let e=localStorage.getItem("projectManagers");e&&Array.isArray(JSON.parse(e))&&0===_.length&&(console.log("HighPerformanceTable: Periodic check found project managers but state is empty, reloading"),X(JSON.parse(e)))},5e3);return()=>clearInterval(e)},[_.length]),(0,s.useEffect)(()=>{let e=e=>{if(j&&y){let t=e.target,r=w.current;r&&!r.contains(t)&&(f(null),v(null))}if(k&&P){let t=e.target,r=B.current;r&&!r.contains(t)&&(C(null),S(null))}if(M&&eL.current){let t=e.target;eL.current.contains(t)||(L(null),z(""),V(null))}};return(j||k||M)&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[j,y,k,P,M]),(0,s.useEffect)(()=>{let e=e=>{let{projectId:t,status:r,closedProjects:a}=e.detail;console.log("HighPerformanceTable: Received project status change:",{projectId:t,status:r,newClosedProjects:a}),a&&(G(a),null==o||o(a))};return window.addEventListener("projectStatusChanged",e),()=>{window.removeEventListener("projectStatusChanged",e)}},[o]),(0,s.useEffect)(()=>{var e,t;let r=()=>{eO.current&&eD.current&&(eD.current.scrollTop=eO.current.scrollTop)},a=()=>{eO.current&&eD.current&&(eO.current.scrollTop=eD.current.scrollTop)};return null===(e=eO.current)||void 0===e||e.addEventListener("scroll",r),null===(t=eD.current)||void 0===t||t.addEventListener("scroll",a),()=>{var e,t;null===(e=eO.current)||void 0===e||e.removeEventListener("scroll",r),null===(t=eD.current)||void 0===t||t.removeEventListener("scroll",a)}},[]);let eQ=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:220,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,a=e.getBoundingClientRect(),s=window.innerWidth,l=window.innerHeight,i=a.left,o=a.bottom+5;return i+t+8>s&&(i=Math.max(8,s-t-8)),o+r+8>l&&(o=Math.max(8,a.top-r-5)),i=Math.max(8,i),o=Math.max(8,o),console.log("Dropdown positioning:",{anchor:e.tagName,rect:{left:a.left,top:a.top,right:a.right,bottom:a.bottom},viewport:{width:s,height:l},dropdown:{width:t,height:r},calculated:{x:i,y:o}}),{x:i,y:o}},[]);(0,s.useEffect)(()=>{let e;let t=()=>{clearTimeout(e),e=setTimeout(()=>{if(j||k){var e,t;let r=Math.max((null===(e=eO.current)||void 0===e?void 0:e.scrollTop)||0,(null===(t=eD.current)||void 0===t?void 0:t.scrollTop)||0);Math.abs(r-window.lastScrollTop||0)>50&&(j&&(f(null),v(null)),k&&(C(null),S(null))),window.lastScrollTop=r}},100)},r=eO.current,a=eD.current;return r&&r.addEventListener("scroll",t),a&&a.addEventListener("scroll",t),()=>{clearTimeout(e),r&&r.removeEventListener("scroll",t),a&&a.removeEventListener("scroll",t)}},[j,k]),(0,s.useEffect)(()=>{let e;let t=()=>{clearTimeout(e),e=setTimeout(()=>{let e=window.innerWidth,t=window.innerHeight;(Math.abs(e-window.lastWidth||0)>100||Math.abs(t-window.lastHeight||0)>100)&&(j&&(f(null),v(null)),k&&(C(null),S(null)),window.lastWidth=e,window.lastHeight=t)},100)};return window.addEventListener("resize",t),()=>{clearTimeout(e),window.removeEventListener("resize",t)}},[j,k]),(0,s.useEffect)(()=>{eO.current&&eO.current.classList.add("hide-scrollbar"),eD.current&&(eD.current.style.overflowX="hidden")},[]),(0,s.useEffect)(()=>{if(eH.current){let e=e$.indexOf(eq);-1!==e&&(eH.current.scrollLeft=128*e)}},[e$,eq]),(0,s.useEffect)(()=>{var e;let t=()=>{eH.current&&ee(eH.current.scrollLeft>0)};return null===(e=eH.current)||void 0===e||e.addEventListener("scroll",t),()=>{var e;null===(e=eH.current)||void 0===e||e.removeEventListener("scroll",t)}},[]),(0,s.useEffect)(()=>{eB.current&&ez(eB.current.clientHeight);let e=new ResizeObserver(()=>{eB.current&&ez(eB.current.clientHeight)});return eB.current&&e.observe(eB.current),()=>e.disconnect()},[]),(0,s.useEffect)(()=>{eM.current&&eV(eM.current.clientHeight);let e=new ResizeObserver(()=>{eM.current&&eV(eM.current.clientHeight)});return eM.current&&e.observe(eM.current),()=>e.disconnect()},[]),(0,s.useEffect)(()=>{eG((()=>{let e=document.createElement("div");e.style.overflowY="scroll",e.style.width="50px",e.style.height="50px",e.style.visibility="hidden",document.body.appendChild(e);let t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t})())},[]),(0,s.useEffect)(()=>{eX((()=>{let e=document.createElement("div");e.style.overflowX="scroll",e.style.height="50px",e.style.width="50px",e.style.visibility="hidden",document.body.appendChild(e);let t=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),t})())},[]);let e0=(0,s.useCallback)((e,t)=>{var r;return(null==ex?void 0:null===(r=ex[e])||void 0===r?void 0:r[t])||0},[ex]),e5=(0,s.useCallback)(e=>(null==ec?void 0:ec[e])||0,[ec]),e6=(0,s.useCallback)(e=>((null==eo?void 0:eo[e.projectId])||0)+e5(e.projectId),[eo,e5]),e2=(0,s.useCallback)(e=>e$.reduce((t,r)=>t+e0(e,r),0),[e$,e0]);(0,s.useCallback)(e=>{let t=null==ep?void 0:ep[e];if(!t)return;if(ef&&!Array.isArray(ef)){var r;return null===(r=ef[t])||void 0===r?void 0:r.color}let a=null==ef?void 0:ef.find(e=>e.id===t);return null==a?void 0:a.color},[ep,ef]);let e1=(0,s.useCallback)((e,t)=>{var r;return(null==eh?void 0:null===(r=eh[e])||void 0===r?void 0:r[t])||""},[eh]),e9=(0,s.useCallback)((e,t)=>{var r;return(null==eb?void 0:null===(r=eb[e])||void 0===r?void 0:r[t])||""},[eb]),e8=e=>{switch(e){case"Confirmed":return"bg-blue-100/80 dark:bg-blue-900/40 border-l-4 border-l-blue-500 dark:border-l-blue-400 shadow-sm";case"Estimate":return"bg-amber-100/80 dark:bg-amber-900/40 border-l-4 border-l-amber-500 dark:border-l-amber-400 shadow-sm";case"Billed":return"bg-emerald-100/80 dark:bg-emerald-900/40 border-l-4 border-l-emerald-500 dark:border-l-emerald-400 shadow-sm";case"Other":return"bg-violet-100/80 dark:bg-violet-900/40 border-l-4 border-l-violet-500 dark:border-l-violet-400 shadow-sm";default:return""}},e7=(0,s.useCallback)((e,t,r)=>{x({projectId:e,month:t}),p(r.toString())},[]),e4=(0,s.useCallback)(async()=>{if(!d)return;let{projectId:e,month:t}=d,r=parseFloat(g)||0;try{await fetch("/api/projections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,month:t,value:r})}),em(),window.dispatchEvent(new CustomEvent("projectionsUpdated")),x(null),p("")}catch(e){console.error("Error saving projection:",e),H.ZP.error("Failed to save projection")}},[d,g,em]),e3=(0,s.useCallback)(async()=>{if(!m)return;let e=parseFloat(g)||0;try{await fetch("/api/asr-fees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:m,value:e})}),eP(t=>({...t,[m]:e})),ed(),h(null),p("")}catch(e){console.error("Error saving ASR fee:",e),H.ZP.error("Failed to save ASR fee")}},[m,g,ed]),te=(0,s.useCallback)(async()=>{if(!u)return;let e=parseFloat(g)||0;try{await fetch("/api/signed-fees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:u,value:e})}),ek(t=>({...t,[u]:e})),en(),b(null),p("")}catch(e){console.error("Error saving signed fee:",e),H.ZP.error("Failed to save signed fee")}},[u,g,en]),tt=(0,s.useCallback)(async e=>{try{if((await fetch("/api/project-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,status:"closed"})})).ok){let t=new Set(W);t.add(e),G(t),null==o||o(t),eN(),f(null),window.dispatchEvent(new CustomEvent("projectStatusChanged",{detail:{projectId:e,status:"closed",closedProjects:t}})),H.ZP.success("Project closed")}else throw Error("Failed to close project")}catch(e){console.error("Error closing project:",e),H.ZP.error("Failed to close project")}},[W,o,eN]),tr=(0,s.useCallback)(async e=>{try{if((await fetch("/api/project-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,status:"active"})})).ok){let t=new Set(W);t.delete(e),G(t),null==o||o(t),eN(),window.dispatchEvent(new CustomEvent("projectStatusChanged",{detail:{projectId:e,status:"reopened",closedProjects:t}})),H.ZP.success("Project reopened")}else throw Error("Failed to reopen project")}catch(e){console.error("Error reopening project:",e),H.ZP.error("Failed to reopen project")}},[W,o,eN]),ta=async e=>{if(!k)return;let{projectId:t,month:r}=k;try{"Clear"===e?await fetch("/api/statuses",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:t,month:r})}):await fetch("/api/statuses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:t,month:r,status:e})}),eu(),window.dispatchEvent(new CustomEvent("projectionsUpdated")),C(null),S(null)}catch(e){console.error("Error updating status:",e),H.ZP.error("Failed to update status")}},ts=async e=>{if(!k)return;let{projectId:t,month:r}=k;if("AddComment"===e||"EditComment"===e){L(k),z(e9(t,r)),V(P),C(null),S(null);return}if("RemoveComment"===e){try{await fetch("/api/comments",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:t,month:r})}),eg(),C(null),S(null)}catch(e){console.error("Error removing comment:",e),H.ZP.error("Failed to remove comment")}return}await ta(e)},tl=(0,s.useCallback)(e=>[...e].sort((e,t)=>{let r,a;switch(et.field){case"projectName":r=e.projectName.toLowerCase(),a=t.projectName.toLowerCase();break;case"signedFee":r=ew[e.projectId]||e.signedFee||0,a=ew[t.projectId]||t.signedFee||0;break;case"asrFee":r=e5(e.projectId),a=e5(t.projectId);break;case"totalFee":r=e6(e),a=e6(t);break;case"projected":r=e2(e.projectId),a=e2(t.projectId);break;default:if(!e$.includes(et.field))return 0;r=e0(e.projectId,et.field),a=e0(t.projectId,et.field)}return r<a?"asc"===et.direction?-1:1:r>a?"asc"===et.direction?1:-1:0}),[et,ew,e5,e6,e2,e$,e0]),ti=(0,s.useCallback)(e=>{er(t=>({field:e,direction:t.field===e&&"asc"===t.direction?"desc":"asc"}))},[]),to=e=>et.field!==e?null:"asc"===et.direction?(0,a.jsx)(T.Z,{className:"h-4 w-4"}):(0,a.jsx)(O.Z,{className:"h-4 w-4"}),tn=e=>et.field!==e?null:"asc"===et.direction?(0,a.jsx)(T.Z,{className:"h-3 w-3"}):(0,a.jsx)(O.Z,{className:"h-3 w-3"}),[tc,td]=(0,s.useState)(!1),tx=(0,s.useMemo)(()=>tc?tl(c):tl(c.filter(e=>!W.has(e.projectId))),[c,W,tc,tl]),tm=tl(c),th=(0,s.useMemo)(()=>ea.trim()?tx.filter(e=>e.projectName.toLowerCase().includes(ea.toLowerCase())):tx,[tx,ea]);console.log("HighPerformanceTable: safeBillingData length:",c.length),console.log("HighPerformanceTable: displayedProjects length:",tx.length),console.log("HighPerformanceTable: filteredProjects length:",th.length),console.log("HighPerformanceTable: closedProjects size:",W.size),console.log("HighPerformanceTable: showClosedProjects:",tc),c.length>0&&console.log("HighPerformanceTable: First billing data item:",c[0]),(0,s.useEffect)(()=>{let e=()=>{if(eB.current){let e=eB.current.scrollHeight>eB.current.clientHeight;eK(e);let t=eW||15,r=e?"".concat(t,"px"):"0";eA.current&&eA.current.firstChild&&(eA.current.firstChild.style.paddingRight=r),eR.current&&eR.current.firstChild&&(eR.current.firstChild.style.paddingRight=r)}};e();let t=new ResizeObserver(e);eB.current&&t.observe(eB.current);let r=setInterval(e,500);return()=>{t.disconnect(),clearInterval(r)}},[tx.length,eW]);let tu=async e=>{try{let t=[];Object.keys(e).forEach(r=>{Object.keys(e[r]).forEach(a=>{let s=e[r][a];0!==s&&t.push(fetch("/api/projections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:r,month:a,value:s})}))})}),t.length>0&&(await Promise.all(t),em(),H.ZP.success("Data imported successfully")),l&&l(e)}catch(e){console.error("Error importing data:",e),H.ZP.error("Failed to import data")}};return(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm rounded-2xl shadow-xl border border-gray-200 dark:border-slate-700 overflow-hidden",children:[(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 px-6 py-6 border-b border-gray-200 dark:border-slate-700",children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex items-center justify-between mb-6",children:(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750",children:[(0,a.jsx)("h3",{className:"jsx-19280ab6560fe750 text-2xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent mb-2",children:"Projections Table"}),(0,a.jsxs)("p",{className:"jsx-19280ab6560fe750 text-sm text-gray-600 dark:text-gray-300",children:["Virtualized table with ",th.length," ",tc?"total":"active"," projects - click any cell to edit"]})]})}),(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 mb-6",children:[(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 relative",children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:(0,a.jsx)(D.Z,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),(0,a.jsx)("input",{type:"text",placeholder:"Filter projects by name...",value:ea,onChange:e=>es(e.target.value),className:"jsx-19280ab6560fe750 block w-full pl-12 pr-4 py-3 border border-gray-300 dark:border-slate-600 rounded-xl leading-5 bg-white dark:bg-slate-700 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 sm:text-sm text-gray-900 dark:text-white transition-all duration-200"}),ea&&(0,a.jsx)("button",{onClick:()=>es(""),className:"jsx-19280ab6560fe750 absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-200",children:(0,a.jsx)(N.Z,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 mt-3 flex items-center justify-between",children:[ea&&(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 text-sm text-gray-600 dark:text-gray-300",children:["Showing ",th.length," of ",tx.length," projects"]}),(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 flex items-center space-x-4",children:[(0,a.jsxs)("label",{className:"jsx-19280ab6560fe750 flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-300",children:[(0,a.jsx)("input",{type:"checkbox",checked:tc,onChange:e=>td(e.target.checked),className:"jsx-19280ab6560fe750 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"jsx-19280ab6560fe750",children:"Show closed projects"})]}),W.size>0&&(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 text-xs text-gray-500 dark:text-gray-400",children:[W.size," closed project",1!==W.size?"s":""]})]})]})]}),(0,a.jsx)(J,{billingData:c,monthlyProjections:eS,asrFees:eC,signedFees:ew,monthRange:e$,onImportData:tu})]}),(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 relative table-container",children:[(0,a.jsxs)("div",{style:{width:"776px",height:"600px"},className:"jsx-19280ab6560fe750 absolute left-0 top-0 z-30 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm flex flex-col",children:[(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 flex bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-b border-gray-200 dark:border-slate-600 sticky-header",children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-[264px] bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsxs)("div",{onClick:()=>ti("projectName"),className:"jsx-19280ab6560fe750 h-18 px-4 py-3 flex items-center justify-start cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors group",children:[(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider leading-none whitespace-nowrap group-hover:text-gray-800 dark:group-hover:text-gray-100",children:"Project"}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 ml-1 text-gray-400 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-400",children:to("projectName")})]})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsxs)("div",{onClick:()=>ti("signedFee"),className:"jsx-19280ab6560fe750 h-18 px-4 py-3 flex items-center justify-end cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors group",children:[(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider leading-none whitespace-nowrap group-hover:text-gray-800 dark:group-hover:text-gray-100",children:"Signed Fee"}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 ml-1 text-gray-400 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-400",children:to("signedFee")})]})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsxs)("div",{onClick:()=>ti("asrFee"),className:"jsx-19280ab6560fe750 h-18 px-4 py-3 flex items-center justify-end cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors group",children:[(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider leading-none whitespace-nowrap group-hover:text-gray-800 dark:group-hover:text-gray-100",children:"Total ASR Fee"}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 ml-1 text-gray-400 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-400",children:to("asrFee")})]})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsxs)("div",{onClick:()=>ti("totalFee"),className:"jsx-19280ab6560fe750 h-18 px-4 py-3 flex items-center justify-end cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors group",children:[(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider leading-none whitespace-nowrap group-hover:text-gray-800 dark:group-hover:text-gray-100",children:"Total Fee"}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 ml-1 text-gray-400 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-400",children:to("totalFee")})]})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsxs)("div",{onClick:()=>ti("projected"),className:"jsx-19280ab6560fe750 h-18 px-4 py-3 flex items-center justify-end cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors group",children:[(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider leading-none whitespace-nowrap group-hover:text-gray-800 dark:group-hover:text-gray-100",children:"Projected"}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 ml-1 text-gray-400 dark:text-gray-500 group-hover:text-gray-600 dark:group-hover:text-gray-400",children:to("projected")})]})})]}),(0,a.jsx)("div",{ref:eM,style:{overflowY:"auto",overflowX:"hidden"},className:"jsx-19280ab6560fe750 flex-1 hide-scrollbar",children:(0,a.jsx)(Z.t7,{height:eU,itemCount:th.length,itemSize:72,width:776,outerRef:eO,overscanCount:5,children:e=>{let{index:t,style:r}=e,s=th[t];if(!s)return null;let l=e2(s.projectId),i=e6(s),o=e5(s.projectId),n=m===s.projectId,c=(null==ep?void 0:ep[s.projectId])||$[s.projectId],d=(null==ef?void 0:ef[c])||_.find(e=>e.id===c),x=W.has(s.projectId);return(0,a.jsxs)("div",{style:r,className:"jsx-19280ab6560fe750 "+"flex border-b border-gray-200 dark:border-slate-600 sticky-column ".concat(x?"bg-gray-100/50 dark:bg-slate-700/50":""),children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 "+"flex-shrink-0 w-[264px] backdrop-blur-sm border-r border-gray-200 dark:border-slate-600 ".concat(x?"bg-gray-100/90 dark:bg-slate-700/90":"bg-gray-50/90 dark:bg-slate-800/90"),children:(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 flex items-center h-18 px-4",children:[(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 flex-1 min-w-0 flex flex-col justify-center overflow-hidden",children:[(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 flex items-center",children:[d&&(0,a.jsx)("div",{style:{backgroundColor:d.color},className:"jsx-19280ab6560fe750 w-3 h-3 rounded-full mr-2 shadow-sm"}),(0,a.jsx)("span",{title:s.projectName,className:"jsx-19280ab6560fe750 text-xs font-medium text-gray-900 dark:text-white truncate",children:s.projectName}),W.has(s.projectId)&&(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 ml-2 px-2 py-0.5 text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full",children:"Closed"})]}),d&&(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 text-xs text-gray-500 dark:text-gray-400 italic truncate",children:d.name})]}),(0,a.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),f(s.projectId),v(e.currentTarget)},"data-project-id":s.projectId,className:"jsx-19280ab6560fe750 ml-2 p-1 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-200 dropdown-trigger",children:(0,a.jsx)(A.Z,{className:"h-4 w-4"})})]})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 "+"flex-shrink-0 w-32 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600 ".concat(x?"bg-gray-100/90 dark:bg-slate-700/90":"bg-gray-50/90 dark:bg-slate-800/90"),children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-center",children:u===s.projectId?(0,a.jsx)("input",{type:"number",value:g,onChange:e=>p(e.target.value),onBlur:te,onKeyDown:e=>"Enter"===e.key&&te(),autoFocus:!0,className:"jsx-19280ab6560fe750 w-full px-2 py-1 border border-blue-300 dark:border-blue-400 rounded text-sm bg-white dark:bg-slate-700 text-gray-900 dark:text-white"}):(()=>{let e=ew[s.projectId],t=null==eo?void 0:eo[s.projectId],r=void 0!==e?e:void 0!==t?t:0;return(0,a.jsx)("div",{onClick:()=>{b(s.projectId),p(r.toString())},className:"jsx-19280ab6560fe750 text-sm cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-700 p-1 rounded transition-colors duration-200 text-gray-900 dark:text-white",children:(0,F.xG)(r)})})()})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 "+"flex-shrink-0 w-32 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600 ".concat(x?"bg-gray-100/90 dark:bg-slate-700/90":"bg-gray-50/90 dark:bg-slate-800/90"),children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-center",children:n?(0,a.jsx)("input",{type:"number",value:g,onChange:e=>p(e.target.value),onBlur:e3,onKeyDown:e=>"Enter"===e.key&&e3(),autoFocus:!0,className:"jsx-19280ab6560fe750 w-full px-2 py-1 border border-blue-300 dark:border-blue-400 rounded text-sm bg-white dark:bg-slate-700 text-gray-900 dark:text-white"}):(0,a.jsx)("div",{onClick:()=>{h(s.projectId),p(o.toString())},className:"jsx-19280ab6560fe750 text-sm cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-700 p-1 rounded transition-colors duration-200 text-gray-900 dark:text-white",children:(0,F.xG)(o)})})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 "+"flex-shrink-0 w-32 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600 ".concat(x?"bg-gray-100/90 dark:bg-slate-700/90":"bg-gray-50/90 dark:bg-slate-800/90"),children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:(0,F.xG)(i)})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 "+"flex-shrink-0 w-32 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600 ".concat(x?"bg-gray-100/90 dark:bg-slate-700/90":"bg-gray-50/90 dark:bg-slate-800/90"),children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:(0,F.xG)(l)})})]})}})}),(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 flex bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-t border-gray-200 dark:border-slate-600",children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-[264px] bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-left text-sm font-medium text-gray-900 dark:text-white",children:"Totals"})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:(0,F.xG)(tm.reduce((e,t)=>{let r=ew[t.projectId],a=null==eo?void 0:eo[t.projectId];return e+(void 0!==r?r:void 0!==a?a:0)},0))})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:(0,F.xG)(tm.reduce((e,t)=>e+e5(t.projectId),0))})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:(0,F.xG)(tm.reduce((e,t)=>e+e6(t),0))})}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-r border-gray-200 dark:border-slate-600",children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 h-18 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white",children:(0,F.xG)(tm.reduce((e,t)=>e+e2(t.projectId),0))})})]}),(0,a.jsx)("div",{style:{height:"".concat(e_,"px")},className:"jsx-19280ab6560fe750"})]}),(0,a.jsx)("div",{ref:eH,style:{height:"600px",marginLeft:"776px"},className:"jsx-19280ab6560fe750 "+"overflow-x-auto overflow-y-hidden scrollable-outer ".concat(Q?"scrolled-horizontal":""),children:(0,a.jsxs)("div",{style:{width:"".concat(128*e$.length,"px"),height:"100%",display:"flex",flexDirection:"column"},className:"jsx-19280ab6560fe750",children:[(0,a.jsx)("div",{ref:eA,className:"jsx-19280ab6560fe750 scrollable-header",children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-b border-gray-200 dark:border-slate-600 sticky-header header-flex",children:e$.map(e=>(0,a.jsx)("div",{onClick:()=>ti(e),title:"Click to sort by ".concat((0,F.bh)(e)," projections"),className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 flex items-center justify-center px-4 py-3 border-r border-gray-200 dark:border-slate-600 h-18 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors group",children:(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 flex flex-col items-center group-hover:text-gray-700 dark:group-hover:text-gray-200",children:[(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider leading-none whitespace-nowrap group-hover:text-gray-800 dark:group-hover:text-gray-100",children:(0,F.bh)(e)}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 text-gray-400 dark:text-gray-500 mt-0.5 group-hover:text-gray-600 dark:group-hover:text-gray-400",children:tn(e)})]})},e))})}),(0,a.jsx)("div",{ref:eB,style:{overflowY:"auto",overflowX:"hidden"},className:"jsx-19280ab6560fe750 flex-1 body-wrapper",children:(0,a.jsx)(Z.t7,{height:eY,itemCount:th.length,itemSize:72,width:128*e$.length,outerRef:eD,overscanCount:5,children:e=>{let{index:t,style:r}=e,s=th[t];if(!s)return null;let l=W.has(s.projectId);return(0,a.jsx)("div",{style:r,className:"jsx-19280ab6560fe750 "+"flex border-b border-gray-200 ".concat(l?"bg-gray-100/50 dark:bg-slate-700/50":""),children:e$.map(e=>{let t=e0(s.projectId,e),r=(null==d?void 0:d.projectId)===s.projectId&&(null==d?void 0:d.month)===e;return(0,a.jsxs)("div",{onClick:()=>e7(s.projectId,e,t),title:e9(s.projectId,e),className:"jsx-19280ab6560fe750 "+"flex-shrink-0 w-32 h-18 px-4 py-2 text-center text-sm border-r border-gray-200 dark:border-slate-600 cursor-pointer relative ".concat(e8(e1(s.projectId,e))||(l?"bg-gray-100/90 dark:bg-slate-700/90 backdrop-blur-sm":"bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm")),children:[r?(0,a.jsx)("input",{type:"number",value:g,onChange:e=>p(e.target.value),onBlur:e4,onKeyDown:e=>"Enter"===e.key&&e4(),autoFocus:!0,className:"jsx-19280ab6560fe750 w-full px-2 py-1 border border-blue-300 dark:border-blue-400 rounded text-sm bg-white dark:bg-slate-700 text-gray-900 dark:text-white"}):(0,a.jsx)("span",{className:"jsx-19280ab6560fe750 text-gray-900 dark:text-white",children:(0,F.xG)(t)}),(0,a.jsx)("button",{onClick:t=>{t.preventDefault(),t.stopPropagation();let r=t.currentTarget.getBoundingClientRect();if(r.width,r.bottom<0||r.top>window.innerHeight||r.right<0||r.left>window.innerWidth){console.warn("Status button is outside viewport, skipping dropdown positioning:",{projectId:s.projectId,month:e,rect:r,viewport:{width:window.innerWidth,height:window.innerHeight}});return}let a=r.left;r.left+200>window.innerWidth&&(a=r.right-200);let l={x:Math.max(8,a),y:r.bottom+5};if(l.x<0||l.y<0||l.x>window.innerWidth||l.y>window.innerHeight){console.warn("Calculated status position is outside viewport:",{projectId:s.projectId,month:e,position:l,viewport:{width:window.innerWidth,height:window.innerHeight}});return}console.log("HighPerformanceTable status dropdown positioning:",{projectId:s.projectId,month:e,rect:{left:r.left,right:r.right,bottom:r.bottom},window:{width:window.innerWidth,height:window.innerHeight},calculated:l}),C({projectId:s.projectId,month:e}),S(t.currentTarget)},className:"jsx-19280ab6560fe750 absolute top-1 right-1 text-gray-400 hover:text-gray-600 text-xs dropdown-trigger",children:"⋯"})]},e)})})}})}),(0,a.jsx)("div",{ref:eR,className:"jsx-19280ab6560fe750 scrollable-footer",children:(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm border-t border-gray-200 dark:border-slate-600 footer-flex",children:e$.map((e,t)=>{let r=e$.map(e=>tm.reduce((t,r)=>t+e0(r.projectId,e),0));return(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 flex-shrink-0 w-32 h-18 px-4 py-2 text-center text-sm font-medium text-gray-900 dark:text-white border-r border-gray-200 dark:border-slate-600 bg-gray-50/90 dark:bg-slate-700/90 backdrop-blur-sm",children:(0,F.xG)(r[t])},e)})})})]})})]}),j&&y&&(0,I.createPortal)((0,a.jsxs)("div",{ref:w,"data-dropdown":"true",style:{left:"".concat(eQ(y,220,200).x,"px"),top:"".concat(eQ(y,220,200).y,"px"),pointerEvents:"auto"},className:"jsx-19280ab6560fe750 fixed bg-white/95 dark:bg-slate-800/95 backdrop-blur-sm border border-gray-200 dark:border-slate-600 rounded-xl shadow-2xl z-[9999] min-w-[220px] py-2",children:[(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 py-1",children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 px-3 pb-1 text-[11px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Assign Project Manager"}),ef&&0!==Object.keys(ef).length||0!==_.length?(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 space-y-0.5",children:(()=>{let e=(null==ep?void 0:ep[j])||$[j];return ef&&Object.keys(ef).length>0?Object.entries(ef).map(t=>{let[r,s]=t;return(0,a.jsxs)("button",{onClick:async()=>{try{await fetch("/api/project-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:j,managerId:r})}),ej(),f(null)}catch(e){console.error("Error assigning project manager:",e),H.ZP.error("Failed to assign project manager")}},className:"jsx-19280ab6560fe750 "+"w-full px-3 py-2 text-left text-sm flex items-center justify-between hover:bg-gray-50 dark:hover:bg-slate-700 text-gray-900 dark:text-white ".concat(e===r?"bg-gray-50 dark:bg-slate-700":""),children:[(0,a.jsxs)("span",{className:"jsx-19280ab6560fe750 flex items-center space-x-2",children:[(0,a.jsx)("span",{style:{backgroundColor:s.color},className:"jsx-19280ab6560fe750 w-3 h-3 rounded-full inline-block shadow-sm"}),(0,a.jsx)("span",{className:"jsx-19280ab6560fe750",children:s.name})]}),e===r&&(0,a.jsx)(R.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400"})]},r)}):_.map(t=>(0,a.jsxs)("button",{onClick:()=>{let e={...$,[j]:t.id};q(e),localStorage.setItem("projectAssignments",JSON.stringify(e)),f(null)},className:"jsx-19280ab6560fe750 "+"w-full px-3 py-2 text-left text-sm flex items-center justify-between hover:bg-gray-50 dark:hover:bg-slate-700 text-gray-900 dark:text-white ".concat(e===t.id?"bg-gray-50 dark:bg-slate-700":""),children:[(0,a.jsxs)("span",{className:"jsx-19280ab6560fe750 flex items-center space-x-2",children:[(0,a.jsx)("span",{style:{backgroundColor:t.color},className:"jsx-19280ab6560fe750 w-3 h-3 rounded-full inline-block shadow-sm"}),(0,a.jsx)("span",{className:"jsx-19280ab6560fe750",children:t.name})]}),e===t.id&&(0,a.jsx)(R.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400"})]},t.id))})()}):(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 px-3 py-2 text-xs text-gray-400 dark:text-gray-500 italic",children:"No project managers available"})]}),((null==ep?void 0:ep[j])||$[j])&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 my-1 border-t border-gray-200 dark:border-slate-600"}),(0,a.jsxs)("button",{onClick:async()=>{try{await fetch("/api/project-assignments",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:j})}),ej(),f(null)}catch(e){console.error("Error removing project manager:",e),H.ZP.error("Failed to remove project manager")}},className:"jsx-19280ab6560fe750 w-full px-3 py-2 text-left text-sm text-orange-600 dark:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/20 flex items-center transition-colors duration-200",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),"Remove Manager"]})]}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 my-1 border-t border-gray-200"}),W.has(j)?(0,a.jsxs)("button",{onClick:()=>tr(j),className:"jsx-19280ab6560fe750 w-full px-3 py-2 text-left text-sm text-green-600 hover:bg-green-50 flex items-center",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),"Reopen Project"]}):(0,a.jsxs)("button",{onClick:()=>tt(j),className:"jsx-19280ab6560fe750 w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Close Project"]})]}),document.body),k&&P&&(0,I.createPortal)((0,a.jsxs)("div",{ref:B,"data-dropdown":"true",style:{left:"".concat(eQ(P,200,150).x,"px"),top:"".concat(eQ(P,200,150).y,"px"),pointerEvents:"auto"},className:"jsx-19280ab6560fe750 fixed bg-white/95 dark:bg-slate-800/95 backdrop-blur-sm border border-gray-200 dark:border-slate-600 rounded-xl shadow-2xl z-[9999] min-w-[200px] py-2",children:[(()=>{let e=e1(k.projectId,k.month);return(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 py-1",children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 px-3 pb-1 text-[11px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),["Confirmed","Estimate","Billed","Other"].map(t=>(0,a.jsxs)("button",{onClick:()=>ts(t),className:"jsx-19280ab6560fe750 "+"w-full px-3 py-2 text-left text-sm flex items-center justify-between hover:bg-gray-50 dark:hover:bg-slate-700 text-gray-900 dark:text-white ".concat(e===t?"bg-gray-50 dark:bg-slate-700":""),children:[(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 "+"w-3 h-3 rounded-full ".concat("Confirmed"===t?"bg-blue-500 dark:bg-blue-400":"Estimate"===t?"bg-amber-500 dark:bg-amber-400":"Billed"===t?"bg-emerald-500 dark:bg-emerald-400":"bg-violet-500 dark:bg-violet-400")}),(0,a.jsx)("span",{className:"jsx-19280ab6560fe750",children:t})]}),e===t&&(0,a.jsx)(R.Z,{className:"h-4 w-4 text-green-600 dark:text-green-400"})]},t)),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 my-1 border-t border-gray-200 dark:border-slate-600"}),(0,a.jsx)("button",{onClick:()=>ts("Clear"),className:"jsx-19280ab6560fe750 w-full px-3 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700",children:"Clear"})]})})(),(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 py-1",children:[(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 px-3 pb-1 text-[11px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Comment"}),(0,a.jsx)("button",{onClick:()=>ts(e9(k.projectId,k.month)?"EditComment":"AddComment"),className:"jsx-19280ab6560fe750 w-full px-3 py-2 text-left text-sm hover:bg-gray-50 dark:hover:bg-slate-700 text-gray-900 dark:text-white",children:e9(k.projectId,k.month)?"Edit Comment":"Add Comment"}),e9(k.projectId,k.month)&&(0,a.jsx)("button",{onClick:()=>ts("RemoveComment"),className:"jsx-19280ab6560fe750 w-full px-3 py-2 text-left text-sm hover:bg-gray-50 dark:hover:bg-slate-700 text-gray-900 dark:text-white",children:"Remove Comment"})]})]}),document.body),M&&U&&(0,I.createPortal)((0,a.jsxs)("div",{ref:eL,style:{left:"".concat(eQ(U,300,200).x,"px"),top:"".concat(eQ(U,300,200).y,"px"),pointerEvents:"auto"},className:"jsx-19280ab6560fe750 fixed bg-white border border-gray-200 rounded-md shadow-lg z-[9999] min-w-[300px] max-w-md comment-modal",children:[(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 px-4 py-3 border-b border-gray-200 flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"jsx-19280ab6560fe750 text-lg font-medium text-gray-900",children:"Edit Comment"}),(0,a.jsx)("button",{onClick:()=>{L(null),z(""),V(null)},className:"jsx-19280ab6560fe750 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(N.Z,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"jsx-19280ab6560fe750 p-4",children:(0,a.jsx)("textarea",{value:Y,onChange:e=>z(e.target.value),rows:4,autoFocus:!0,className:"jsx-19280ab6560fe750 w-full px-2 py-1 border border-gray-300 rounded text-sm"})}),(0,a.jsxs)("div",{className:"jsx-19280ab6560fe750 px-4 py-3 border-t border-gray-200 flex justify-end",children:[(0,a.jsx)("button",{onClick:async()=>{let{projectId:e,month:t}=M,r=Y.trim();try{r?await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,month:t,comment:r})}):await fetch("/api/comments",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:e,month:t})}),eg(),L(null),z(""),V(null)}catch(e){console.error("Error saving comment:",e),H.ZP.error("Failed to save comment")}},className:"jsx-19280ab6560fe750 px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-md",children:"Save Comment"}),(0,a.jsx)("button",{onClick:()=>{L(null),z(""),V(null)},className:"jsx-19280ab6560fe750 ml-2 px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-md",children:"Cancel"})]})]}),document.body),(0,a.jsx)(E(),{id:"19280ab6560fe750",children:".table-container.jsx-19280ab6560fe750{position:relative;overflow:hidden}.sticky-header.jsx-19280ab6560fe750{position:-webkit-sticky;position:sticky;top:0;z-index:40;background:inherit;overflow:hidden}.sticky-column.jsx-19280ab6560fe750{position:-webkit-sticky;position:sticky;left:0;z-index:30;background:white;overflow:hidden}.scrolled-horizontal.jsx-19280ab6560fe750{-webkit-box-shadow:inset -10px 0 8px -8px rgba(0,0,0,.1);-moz-box-shadow:inset -10px 0 8px -8px rgba(0,0,0,.1);box-shadow:inset -10px 0 8px -8px rgba(0,0,0,.1)}.hide-scrollbar.jsx-19280ab6560fe750::-webkit-scrollbar{display:none}.hide-scrollbar.jsx-19280ab6560fe750{-ms-overflow-style:none;scrollbar-width:none}.hide-horizontal-scrollbar.jsx-19280ab6560fe750{overflow-x:hidden!important}.body-wrapper.jsx-19280ab6560fe750{scrollbar-gutter:stable}.scrollable-header.jsx-19280ab6560fe750,.scrollable-footer.jsx-19280ab6560fe750{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.header-flex.jsx-19280ab6560fe750,.footer-flex.jsx-19280ab6560fe750{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.scrollable-outer.jsx-19280ab6560fe750{scrollbar-gutter:stable}"})]})}var G=r(47625),_=r(5481),X=r(56940),$=r(97059),q=r(62994),Q=r(8147),ee=r(22190),et=r(23263);function er(e){let{billingData:t,closedProjects:r}=e,l=t||[],i=r||new Set,[o,n]=(0,s.useState)(0),c=e=>fetch(e).then(e=>e.json()),{data:d}=(0,K.ZP)("/api/projections",c),{data:x}=(0,K.ZP)("/api/statuses",c);(0,s.useEffect)(()=>{let e=()=>{n(e=>e+1)};return window.addEventListener("projectionsUpdated",e),window.addEventListener("statusUpdated",e),()=>{window.removeEventListener("projectionsUpdated",e),window.removeEventListener("statusUpdated",e)}},[]);let m=d||{},h=x||{},u=(0,F.UF)().map(e=>{let t=0,r=0,a=new Set([...l.map(e=>e.projectId),...Array.from(i)]);a.forEach(a=>{let s=m[a],l=h[a];if(s&&s[e]){let a=s[e];l&&"Billed"===l[e]?r+=a:t+=a}});let s=t;return e===new Date().toISOString().slice(0,7)&&console.log("BillingChart: Current month data:",{month:e,monthProjected:t,monthBilled:r,monthUnbilled:s,allProjectIdsCount:a.size,activeProjectsCount:l.length,closedProjectsCount:i.size}),{month:e,name:(0,F.bh)(e),billed:r,unbilled:s,projected:t,total:t}});return(0,a.jsx)("div",{className:"h-80",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"chart-container",children:(0,a.jsx)(G.h,{width:"100%",height:320,children:(0,a.jsxs)(_.T,{data:u,margin:{top:20,right:30,left:20,bottom:5},children:[(0,a.jsx)(X.q,{strokeDasharray:"3 3"}),(0,a.jsx)($.K,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12,interval:0}),(0,a.jsx)(q.B,{tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k"),fontSize:12,label:{value:"Amount (USD)",angle:-90,position:"insideLeft"}}),(0,a.jsx)(Q.u,{content:(0,a.jsx)(e=>{let{active:t,payload:r,label:s}=e;return t&&r&&r.length?(0,a.jsxs)("div",{className:"bg-white p-4 border rounded-lg shadow-lg",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:s}),r.map((e,t)=>(0,a.jsxs)("p",{className:"text-sm",style:{color:e.color},children:[e.name,": ",(0,F.xG)(e.value)]},t))]}):null},{})}),(0,a.jsx)(ee.D,{}),(0,a.jsx)(et.u,{type:"monotone",dataKey:"projected",stackId:"1",stroke:"#f97316",fill:"#f97316",fillOpacity:.6,name:"Projected"}),(0,a.jsx)(et.u,{type:"monotone",dataKey:"billed",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Billed"})]})})})})})}var ea=r(12339),es=r(32759),el=r(75169),ei=r(3574),eo=r(20407),en=r(77031),ec=r(31699);function ed(){let[e,t]=(0,s.useState)(null),[r,N]=(0,s.useState)([]),[w,S]=(0,s.useState)([]),[E,I]=(0,s.useState)("projections-table"),[Z,F]=(0,s.useState)(null),[T,O]=(0,s.useState)(!1),[D,A]=(0,s.useState)(!0),[R,H]=(0,s.useState)(null),[B,M]=(0,s.useState)([]),[L,Y]=(0,s.useState)({}),[z,U]=(0,s.useState)(new Set),[V,J]=(0,s.useState)({});(0,s.useEffect)(()=>{r&&!Array.isArray(r)&&(console.warn("topProjects is not an array, resetting to empty array:",r),N([]))},[r]),(0,s.useEffect)(()=>{w&&!Array.isArray(w)&&(console.warn("bottomProjects is not an array, resetting to empty array:",w),S([]))},[w]);let K=async()=>{try{let e=await fetch("/api/project-statuses");if(e.ok){let t=await e.json();if("object"==typeof t&&null!==t){J(t);let e=Object.entries(t).filter(e=>{let[t,r]=e;return"closed"===r}).map(e=>{let[t,r]=e;return t});U(new Set(e))}}}catch(e){console.error("Error loading project statuses:",e)}};(0,s.useEffect)(()=>{(async()=>{try{A(!0),H(null);try{console.log("Setting up database schema..."),(await fetch("/api/setup-database",{method:"POST"})).ok?console.log("Database setup completed"):console.log("Database setup failed, continuing with existing schema")}catch(e){console.log("Database setup error, continuing with existing schema:",e)}let[e,r,a,s]=await Promise.all([fetch("/api/homepage-dashboard"),fetch("/api/top-projects"),fetch("/api/bottom-projects"),fetch("/api/projects")]);if(!e.ok)throw Error("Failed to fetch dashboard data");if(!r.ok)throw Error("Failed to fetch top projects data");if(!a.ok)throw Error("Failed to fetch bottom projects data");if(!s.ok)throw Error("Failed to fetch projects data");let l=await e.json(),i=await r.json(),o=await a.json(),n=await s.json();await K();try{let e=await fetch("/api/projections");if(e.ok){let t=await e.json();Y(t)}}catch(e){console.error("Error loading projections:",e)}if(l&&"object"==typeof l?t(l):(console.warn("Invalid dashboard data received:",l),t(null)),console.log("Raw topProjectsData:",i),i&&i.success&&i.data&&Array.isArray(i.data.topProjects)?(console.log("Setting topProjects:",i.data.topProjects),N(i.data.topProjects)):(console.warn("Invalid topProjects data received, setting empty array:",i),N([])),console.log("Raw bottomProjectsData:",o),o&&o.success&&o.data&&Array.isArray(o.data.bottomProjects)?(console.log("Setting bottomProjects:",o.data.bottomProjects),S(o.data.bottomProjects)):(console.warn("Invalid bottomProjects data received, setting empty array:",o),S([])),n.success&&n.data){let e=n.data.map(e=>({projectId:e.project_id,projectName:e.project_name,customerName:e.customer_name,signedFee:e.signed_fee||0,monthlyData:[],totalBilled:0,totalUnbilled:0,totalProjected:0,isClosed:!1,projectManagerId:void 0,clockifyData:void 0,totalHours:0,billableHours:0,nonBillableHours:0,hourlyRate:0,efficiency:0}));M(e)}}catch(e){console.error("Error fetching dashboard data:",e),H(e instanceof Error?e.message:"Failed to load dashboard data")}finally{A(!1)}})();let e=e=>{let{projectId:t,status:r,closedProjects:a}=e.detail;console.log("HomePage: Received project status change:",{projectId:t,status:r,newClosedProjects:a}),a&&U(a)};return window.addEventListener("projectStatusChanged",e),()=>{window.removeEventListener("projectStatusChanged",e)}},[]);let _=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),X=e=>"".concat(e.toLocaleString(),"h"),ee=e=>"".concat((100*e).toFixed(0),"%"),et=e=>{if(!Array.isArray(r)||!e)return;let t=r.find(t=>t.id===e||t.projectId===e);t&&(F({id:t.id||t.projectId||e,name:t.name||t.projectName||"Unknown Project",customer:t.customer||t.customerName||"Unknown Customer",status:t.status||"active",startDate:t.startDate||new Date().toISOString(),endDate:t.endDate||void 0,budget:Number(t.budget)||0,billed:Number(t.billed)||0,hours:Number(t.hours||t.totalHours)||0,efficiency:Number(t.efficiency)||0,revenue:Number(t.revenue)||0,profitMargin:Number(t.profitMargin)||0,multiplier:Number(t.multiplier)||0,estimatedCost:Number(t.estimatedCost)||0,projectId:t.projectId||t.id,totalHours:Number(t.totalHours)||0,billableHours:Number(t.billableHours)||0,entryCount:Number(t.entryCount)||0}),O(!0))},ed={hidden:{opacity:0,y:20},visible:{opacity:1,y:0},exit:{opacity:0,y:-20}},ex={hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1}};if(D)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-xl text-gray-600 dark:text-gray-300",children:"Loading dashboard data..."})]})});if(R||!e)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,a.jsx)(n.Z,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Error Loading Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:R||"Failed to load dashboard data"}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Retry"})]})});let em=[{name:"Billable",value:Math.round(100*e.efficiency),color:"#10b981"},{name:"Non-Billable",value:Math.round((1-e.efficiency)*100),color:"#6b7280"}],eh=(Array.isArray(r)?r:[]).slice(0,5).map(e=>({name:e.name||"Unknown Project",hours:e.hours||0,revenue:e.revenue||0,efficiency:Math.round(100*(e.efficiency||0)),multiplier:e.multiplier||0})),eu=(Array.isArray(w)?w:[]).slice(0,5).map(e=>({name:e.name||"Unknown Project",hours:e.hours||0,revenue:e.revenue||0,efficiency:Math.round(100*(e.efficiency||0)),multiplier:e.multiplier||0}));return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)(i.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"relative mb-12",children:[(0,a.jsx)("div",{className:"absolute top-0 right-0",children:(0,a.jsx)(l.default,{href:"/settings",className:"inline-flex items-center justify-center w-12 h-12 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-gray-200 dark:border-slate-700 rounded-full hover:bg-white dark:hover:bg-slate-700 transition-all duration-200 shadow-lg hover:shadow-xl",children:(0,a.jsx)(c.Z,{className:"h-6 w-6 text-gray-600 dark:text-gray-300"})})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent mb-4",children:"Billing Dashboard"}),(0,a.jsx)("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto mb-6",children:"Comprehensive financial insights and project performance metrics for engineering excellence"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-3 sm:space-y-0 sm:space-x-4",children:[(0,a.jsxs)(l.default,{href:"/dashboard",className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors duration-200 shadow-lg hover:shadow-xl",children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 mr-2"}),"Detailed Finances"]}),(0,a.jsxs)(l.default,{href:"/projects",className:"inline-flex items-center px-6 py-3 bg-gray-600 text-white font-medium rounded-lg hover:bg-gray-700 transition-colors duration-200 shadow-lg hover:shadow-xl",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 mr-2"}),"Project Information"]})]})]})]}),(0,a.jsxs)(ea.mQ,{value:E,onValueChange:I,className:"w-full space-y-8",children:[(0,a.jsxs)(ea.dr,{className:"grid w-full grid-cols-6 h-16 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-gray-200 dark:border-slate-700 rounded-xl p-1 shadow-lg",children:[(0,a.jsxs)(ea.SP,{value:"projections-table",className:"text-white data-[state=active]:bg-indigo-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-200 rounded-lg",children:[(0,a.jsx)(c.Z,{className:"h-5 w-5 mr-2"}),"Projections Table"]}),(0,a.jsxs)(ea.SP,{value:"billing",className:"text-white data-[state=active]:bg-blue-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-200 rounded-lg",children:[(0,a.jsx)(m.Z,{className:"h-5 w-5 mr-2"}),"Billing Overview"]}),(0,a.jsxs)(ea.SP,{value:"time-tracking",className:"text-white data-[state=active]:bg-green-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-200 rounded-lg",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5 mr-2"}),"Time Tracking KPIs"]}),(0,a.jsxs)(ea.SP,{value:"performance",className:"text-white data-[state=active]:bg-purple-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-200 rounded-lg",children:[(0,a.jsx)(d.Z,{className:"h-5 w-5 mr-2"}),"Performance Metrics"]}),(0,a.jsxs)(ea.SP,{value:"top-projects",className:"text-white data-[state=active]:bg-orange-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-200 rounded-lg",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 mr-2"}),"Top Projects"]}),(0,a.jsxs)(ea.SP,{value:"bottom-projects",className:"text-white data-[state=active]:bg-red-500 data-[state=active]:text-white data-[state=active]:shadow-lg transition-all duration-200 rounded-lg",children:[(0,a.jsx)(n.Z,{className:"h-5 w-5 mr-2"}),"Bottom Projects"]})]}),(0,a.jsx)(ea.nU,{value:"billing",className:"space-y-6",children:(0,a.jsx)(o.M,{mode:"wait",children:(0,a.jsxs)(i.E.div,{variants:ed,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[{name:"Total Projects",value:e.totalProjects,icon:b.Z,color:"from-blue-500 to-blue-600",description:"Active and closed projects",trend:"+12% from last month"},{name:"Total Billed YTD",value:_(e.totalBilled),icon:m.Z,color:"from-green-500 to-green-600",description:"Year-to-date billed amount",trend:"+8.5% from last year"},{name:"Backlog",value:_(e.totalUnbilled),icon:g.Z,color:"from-yellow-500 to-yellow-600",description:"Unbilled work in progress",trend:"+15% from last month"},{name:"Active Projects",value:e.activeProjects,icon:p.Z,color:"from-purple-500 to-purple-600",description:"Currently active projects",trend:"+5% from last month"}].map((e,t)=>(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.1*t},children:(0,a.jsxs)(k.Zb,{className:"h-full bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",children:[(0,a.jsx)(k.Ol,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"p-3 rounded-xl bg-gradient-to-r ".concat(e.color),children:(0,a.jsx)(e.icon,{className:"h-6 w-6 text-white"})}),(0,a.jsx)(C.C,{variant:"secondary",className:"text-xs",children:e.trend})]})}),(0,a.jsxs)(k.aY,{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300 mb-2",children:e.name}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:e.value}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.description})]})]})},e.name))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.4},children:(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium opacity-90 mb-1",children:"Zoho Books Total Revenue"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:_(e.ytdOperatingIncome)}),(0,a.jsx)("p",{className:"text-sm opacity-80 mt-2",children:"YTD Income (Accrual Basis)"})]}),(0,a.jsx)(m.Z,{className:"h-12 w-12 opacity-80"})]})})})}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.45},children:(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-green-500 to-green-600 text-white border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium opacity-90 mb-1",children:"Project Billing Total"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:_(e.totalBilled+e.totalUnbilled)}),(0,a.jsx)("p",{className:"text-sm opacity-80 mt-2",children:"Combined billed and unbilled"})]}),(0,a.jsx)(m.Z,{className:"h-12 w-12 opacity-80"})]})})})}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.5},children:(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-emerald-500 to-emerald-600 text-white border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium opacity-90 mb-1",children:"Project Count"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:e.totalProjects}),(0,a.jsx)("p",{className:"text-sm opacity-80 mt-2",children:"Total projects managed"})]}),(0,a.jsx)(x.Z,{className:"h-12 w-12 opacity-80"})]})})})}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.55},children:(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-violet-500 to-violet-600 text-white border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium opacity-80 mb-1",children:"Active Rate"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:ee(e.activeProjects/e.totalProjects)}),(0,a.jsx)("p",{className:"text-sm opacity-80 mt-2",children:"Projects currently active"})]}),(0,a.jsx)(j.Z,{className:"h-12 w-12 opacity-80"})]})})})})]}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.6},children:(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-amber-500 to-amber-600 text-white border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Revenue Reconciliation"}),(0,a.jsx)(n.Z,{className:"h-6 w-6 opacity-80"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Zoho Books Operating Income:"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:_(e.ytdOperatingIncome)}),(0,a.jsx)("p",{className:"opacity-80 text-xs",children:"Accrual basis financial data"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Project Billing Total:"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:_(e.totalBilled+e.totalUnbilled)}),(0,a.jsx)("p",{className:"opacity-80 text-xs",children:"Project-based billing data"})]})]}),(0,a.jsxs)("div",{className:"border-t border-white/20 pt-3",children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Difference:"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:_(e.ytdOperatingIncome-(e.totalBilled+e.totalUnbilled))}),(0,a.jsx)("p",{className:"opacity-80 text-xs",children:"This difference represents additional revenue sources, timing differences, or data synchronization gaps"}),(0,a.jsxs)("p",{className:"opacity-80 text-xs mt-1",children:[(0,a.jsx)("strong",{children:"Note:"})," Zoho Books data is the authoritative source for financial reporting"]})]})]})})})}),e.ytdOperatingIncome>0?(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.7},children:(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-slate-700 to-slate-800 text-white border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Zoho Books Financial Metrics (YTD)"}),(0,a.jsx)(d.Z,{className:"h-6 w-6 opacity-80"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Revenue:"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:_(e.ytdRevenue)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Expenses:"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:_(e.ytdExpenses)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Gross Profit:"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:_(e.ytdGrossProfit)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Operating Income:"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:_(e.ytdOperatingIncome)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Net Profit:"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:_(e.ytdNetProfit)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"opacity-90 font-medium",children:"Cash Flow:"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:_(e.ytdCashFlow)})]})]})]})})})}):(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.7},children:(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-red-500 to-red-600 text-white border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"⚠️ Zoho Books Data Not Available"}),(0,a.jsx)(n.Z,{className:"h-6 w-6 opacity-80"})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("p",{className:"opacity-90",children:"Unable to fetch financial data from Zoho Books. This could be due to:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside mt-2 opacity-80 text-xs",children:[(0,a.jsx)("li",{children:"API authentication issues"}),(0,a.jsx)("li",{children:"Rate limiting"}),(0,a.jsx)("li",{children:"Network connectivity problems"}),(0,a.jsx)("li",{children:"Missing or expired API tokens"})]}),(0,a.jsx)("p",{className:"mt-2 opacity-80 text-xs",children:"Showing project billing data only. Please check your Zoho Books integration."})]})]})})})}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.8},children:(0,a.jsx)(k.Zb,{className:"bg-gray-100 border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Data Source Information"}),(0,a.jsx)(f.Z,{className:"h-6 w-6 text-gray-600"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Primary Financial Data:"}),(0,a.jsx)("p",{className:"text-sm",children:"Zoho Books API (Accrual Basis)"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Real-time financial metrics"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Project Billing Data:"}),(0,a.jsx)("p",{className:"text-sm",children:"Zoho Projects + Clockify"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Project-based time tracking"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Update Frequency:"}),(0,a.jsx)("p",{className:"text-sm",children:"Real-time via API calls"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Refreshed on each page load"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Data Reconciliation:"}),(0,a.jsx)("p",{className:"text-sm",children:"Automatic calculation"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Shows differences and gaps"})]})]})]})})})})]},"billing")})}),(0,a.jsx)(ea.nU,{value:"time-tracking",className:"space-y-6",children:(0,a.jsx)(o.M,{mode:"wait",children:(0,a.jsxs)(i.E.div,{variants:ed,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[{name:"Total Hours",value:X(e.totalHours),icon:h.Z,color:"from-indigo-500 to-indigo-600",description:"Total tracked hours",progress:100},{name:"Billable Hours",value:X(e.billableHours),icon:c.Z,color:"from-emerald-500 to-emerald-600",description:"Billable time tracked",progress:e.billableHours/e.totalHours*100},{name:"Efficiency",value:ee(e.efficiency),icon:d.Z,color:"from-orange-500 to-orange-600",description:"Billable hours ratio",progress:100*e.efficiency},{name:"Avg Hourly Rate",value:_(e.averageHourlyRate),icon:y.Z,color:"from-pink-500 to-pink-600",description:"Average billable rate",progress:85}].map((t,r)=>(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.1*r},children:(0,a.jsxs)(k.Zb,{className:"h-full bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",children:[(0,a.jsx)(k.Ol,{className:"pb-3",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("div",{className:"p-3 rounded-xl bg-gradient-to-r ".concat(t.color),children:(0,a.jsx)(t.icon,{className:"h-6 w-6 text-white"})})})}),(0,a.jsxs)(k.aY,{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300 mb-2",children:t.name}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-3",children:t.value}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:t.description}),"Efficiency"===t.name?(0,a.jsxs)("div",{className:"relative w-16 h-16 mx-auto",children:[(0,a.jsxs)("svg",{className:"w-16 h-16 transform -rotate-90",viewBox:"0 0 36 36",children:[(0,a.jsx)("path",{className:"text-gray-200 dark:text-gray-600",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,a.jsx)("path",{className:"text-emerald-500",strokeWidth:"3",strokeDasharray:"".concat(t.progress,", 100"),strokeLinecap:"round",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:ee(e.efficiency)})})]}):(0,a.jsx)(es.E,{value:t.progress,className:"h-2"})]})]})},t.name))}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.4},children:(0,a.jsxs)(k.Zb,{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl",children:[(0,a.jsxs)(k.Ol,{children:[(0,a.jsx)(k.ll,{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Billable vs Non-Billable Hours"}),(0,a.jsx)(k.SZ,{children:"Visual breakdown of time allocation efficiency"})]}),(0,a.jsxs)(k.aY,{children:[(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(G.h,{width:"100%",height:"100%",children:(0,a.jsxs)(el.u,{children:[(0,a.jsx)(ei.b,{data:em,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:em.map((e,t)=>(0,a.jsx)(eo.b,{fill:e.color},"cell-".concat(t)))}),(0,a.jsx)(Q.u,{})]})})}),(0,a.jsx)("div",{className:"flex justify-center space-x-8 mt-4",children:em.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:e.color}}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.name,": ",e.value,"%"]})]},e.name))})]})]})})]},"time-tracking")})}),(0,a.jsx)(ea.nU,{value:"performance",className:"space-y-6",children:(0,a.jsx)(o.M,{mode:"wait",children:(0,a.jsxs)(i.E.div,{variants:ed,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[{name:"Total Time Value",value:_(e.totalTimeValue),icon:j.Z,color:"from-cyan-500 to-cyan-600",description:"Total value of tracked time",metric:"High Performance"},{name:"Avg Hours/Project",value:X(e.averageHoursPerProject),icon:u.Z,color:"from-violet-500 to-violet-600",description:"Average hours per project",metric:"Optimal"}].map((e,t)=>(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.1*t},children:(0,a.jsxs)(k.Zb,{className:"h-full bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",children:[(0,a.jsx)(k.Ol,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"p-3 rounded-xl bg-gradient-to-r ".concat(e.color),children:(0,a.jsx)(e.icon,{className:"h-6 w-6 text-white"})}),(0,a.jsx)(C.C,{variant:"default",className:"text-xs",children:e.metric})]})}),(0,a.jsxs)(k.aY,{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300 mb-2",children:e.name}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:e.value}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.description})]})]})},e.name))}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.3},children:(0,a.jsx)(k.Zb,{className:"bg-gradient-to-r from-slate-800 to-slate-900 text-white border-0 shadow-xl",children:(0,a.jsx)(k.aY,{className:"p-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl font-bold text-blue-400 mb-2",children:ee(e.efficiency)}),(0,a.jsx)("div",{className:"text-sm text-gray-300",children:"Overall Efficiency"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl font-bold text-green-400 mb-2",children:e.activeProjects}),(0,a.jsx)("div",{className:"text-sm text-gray-300",children:"Active Projects"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-4xl font-bold text-purple-400 mb-2",children:_(e.averageHourlyRate)}),(0,a.jsx)("div",{className:"text-sm text-gray-300",children:"Avg Hourly Rate"})]})]})})})})]},"performance")})}),(0,a.jsx)(ea.nU,{value:"projections-table",className:"space-y-6",children:(0,a.jsx)(o.M,{mode:"wait",children:(0,a.jsxs)(i.E.div,{variants:ed,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.1},children:(0,a.jsxs)(k.Zb,{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl",children:[(0,a.jsxs)(k.Ol,{children:[(0,a.jsx)(k.ll,{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Financial Projections Overview"}),(0,a.jsx)(k.SZ,{children:"Projected and billed amounts from 1 year back to 1 year in the future"})]}),(0,a.jsx)(k.aY,{children:(0,a.jsx)(er,{billingData:B,closedProjects:z})})]})}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.2},children:(0,a.jsx)(k.Zb,{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl",children:(0,a.jsx)(k.aY,{children:(0,a.jsx)(W,{billingData:B,projections:L,onUpdateProjections:e=>{Y(e)},closedProjects:z,onClosedProjectsChange:U})})})})]},"projections-table")})}),(0,a.jsx)(ea.nU,{value:"top-projects",className:"space-y-6",children:(0,a.jsx)(o.M,{mode:"wait",children:(0,a.jsxs)(i.E.div,{variants:ed,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.1},children:(0,a.jsxs)(k.Zb,{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl",children:[(0,a.jsxs)(k.Ol,{children:[(0,a.jsx)(k.ll,{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Top Performing Projects by Multiplier"}),(0,a.jsx)(k.SZ,{children:"Multiplier comparison of top 5 projects (higher = better profitability)"})]}),(0,a.jsx)(k.aY,{children:eh.length>0?(0,a.jsx)("div",{className:"h-80",children:(0,a.jsx)(G.h,{width:"100%",height:"100%",children:(0,a.jsxs)(en.v,{data:eh,margin:{top:20,right:30,left:20,bottom:5},children:[(0,a.jsx)($.K,{dataKey:"name"}),(0,a.jsx)(q.B,{}),(0,a.jsx)(Q.u,{formatter:(e,t)=>["multiplier"===t?Number(e).toFixed(2)+"x":"revenue"===t?_(Number(e)):e,"multiplier"===t?"Multiplier":"revenue"===t?"Revenue":"Hours"]}),(0,a.jsx)(ec.$,{dataKey:"multiplier",fill:"#3b82f6",radius:[4,4,0,0]})]})})}):(0,a.jsx)("div",{className:"h-80 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(d.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No project data available"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Projects will appear here once data is loaded"})]})})})]})}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.2},children:(0,a.jsxs)(k.Zb,{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl",children:[(0,a.jsxs)(k.Ol,{children:[(0,a.jsx)(k.ll,{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Top Performing Projects by Multiplier"}),(0,a.jsx)(k.SZ,{children:"Projects ranked by profitability multiplier (higher = better). Click on any project to view detailed metrics."})]}),(0,a.jsx)(k.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:r.map((e,t)=>(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+.1*t},className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-slate-700 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-600 transition-colors duration-200 cursor-pointer group",onClick:()=>et(e.id||e.projectId||"project-".concat(t)),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-bold",children:t+1})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors duration-200",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.hours||e.totalHours||0,"h • ",ee(e.efficiency||0)," efficient"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-semibold text-gray-900 dark:text-white",children:[(e.multiplier||0).toFixed(2),"x"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Multiplier"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:_(e.revenue||0)}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Revenue"})]}),(0,a.jsx)(v.Z,{className:"h-5 w-5 text-gray-400 group-hover:text-blue-500 transition-colors duration-200"})]})]},e.id||e.projectId||"project-".concat(t)))})})]})})]},"top-projects")})}),(0,a.jsx)(ea.nU,{value:"bottom-projects",className:"space-y-6",children:(0,a.jsx)(o.M,{mode:"wait",children:(0,a.jsxs)(i.E.div,{variants:ed,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.3},className:"space-y-6",children:[(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.1},children:(0,a.jsxs)(k.Zb,{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl",children:[(0,a.jsxs)(k.Ol,{children:[(0,a.jsx)(k.ll,{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Bottom Performing Projects by Multiplier"}),(0,a.jsx)(k.SZ,{children:"Multiplier comparison of bottom 5 projects (lower = worse profitability)"})]}),(0,a.jsx)(k.aY,{children:eu.length>0?(0,a.jsx)("div",{className:"h-80",children:(0,a.jsx)(G.h,{width:"100%",height:"100%",children:(0,a.jsxs)(en.v,{data:eu,margin:{top:20,right:30,left:20,bottom:5},children:[(0,a.jsx)($.K,{dataKey:"name"}),(0,a.jsx)(q.B,{}),(0,a.jsx)(Q.u,{formatter:(e,t)=>["multiplier"===t?Number(e).toFixed(2)+"x":"revenue"===t?_(Number(e)):e,"multiplier"===t?"Multiplier":"revenue"===t?"Revenue":"Hours"]}),(0,a.jsx)(ec.$,{dataKey:"multiplier",fill:"#ef4444",radius:[4,4,0,0]})]})})}):(0,a.jsx)("div",{className:"h-80 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(n.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No project data available"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Projects will appear here once data is loaded"})]})})})]})}),(0,a.jsx)(i.E.div,{variants:ex,initial:"hidden",animate:"visible",transition:{delay:.2},children:(0,a.jsxs)(k.Zb,{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border-0 shadow-xl",children:[(0,a.jsxs)(k.Ol,{children:[(0,a.jsx)(k.ll,{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Bottom Performing Projects by Multiplier"}),(0,a.jsx)(k.SZ,{children:"Projects ranked by lowest profitability multiplier (lower = worse). Click on any project to view detailed metrics."})]}),(0,a.jsx)(k.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:Array.isArray(w)&&w.length>0?w.map((e,t)=>(0,a.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+.1*t},className:"flex items-center justify-between p-4 bg-red-50 dark:bg-red-900/20 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors duration-200 cursor-pointer group border border-red-200 dark:border-red-800",onClick:()=>et(e.id||e.projectId||"project-".concat(t)),children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-red-400 to-red-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-bold",children:t+1})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white group-hover:text-red-600 dark:group-hover:text-red-400 transition-colors duration-200",children:e.name||"Unknown Project"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.hours||0,"h • ",ee(e.efficiency||0)," efficient"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-semibold text-red-600 dark:text-red-400",children:[(e.multiplier||0).toFixed(2),"x"]}),(0,a.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:"Multiplier"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:_(e.revenue||0)}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Revenue"})]}),(0,a.jsx)(v.Z,{className:"h-5 w-5 text-red-400 group-hover:text-red-600 transition-colors duration-200"})]})]},e.id||e.projectId||"project-".concat(t))):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(n.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No project data available"})]})})})]})})]},"bottom-projects")})})]})]}),(0,a.jsx)(P,{isOpen:T,onClose:()=>{O(!1),F(null)},project:Z||void 0})]})}}},function(e){e.O(0,[451,64,961,425,788,848,215,417,971,117,744],function(){return e(e.s=78929)}),_N_E=e.O()}]);
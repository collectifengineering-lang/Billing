(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{48721:function(e,t,s){Promise.resolve().then(s.bind(s,77103))},77103:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return S}});var r=s(57437),n=s(2265),a=s(27648),i=s(70525),l=s(3085),c=s(21047),o=s(32660),d=s(46221),u=s(95252),m=s(48664),f=s(58896),x=s(95805),h=s(94508);let j=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,h.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});j.displayName="Card";let p=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,h.cn)("flex flex-col space-y-1.5 p-6",s),...n})});p.displayName="CardHeader";let y=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("h3",{ref:t,className:(0,h.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});y.displayName="CardTitle";let v=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("p",{ref:t,className:(0,h.cn)("text-sm text-muted-foreground",s),...n})});v.displayName="CardDescription";let g=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,h.cn)("p-6 pt-0",s),...n})});g.displayName="CardContent",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,h.cn)("flex items-center p-6 pt-0",s),...n})}).displayName="CardFooter";var b=s(43105);let N=b.fC,w=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(b.aV,{ref:t,className:(0,h.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...n})});w.displayName=b.aV.displayName;let A=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(b.xz,{ref:t,className:(0,h.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...n})});A.displayName=b.xz.displayName;let _=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(b.VY,{ref:t,className:(0,h.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n})});_.displayName=b.VY.displayName;let I=(0,s(90535).j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function P(e){let{className:t,variant:s,...n}=e;return(0,r.jsx)("div",{className:(0,h.cn)(I({variant:s}),t),...n})}var R=s(60610);let E=n.forwardRef((e,t)=>{let{className:s,value:n,...a}=e;return(0,r.jsx)(R.fC,{ref:t,className:(0,h.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:(0,r.jsx)(R.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});E.displayName=R.fC.displayName;var C=s(17486);function D(){let[e,t]=(0,n.useState)(null),[s,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{b()},[]);let b=async()=>{try{h(!0);let e=await fetch("/api/dashboard");if(!e.ok)throw Error("Failed to fetch dashboard data");let s=await e.json();t(s)}catch(e){console.error("Error fetching dashboard data:",e)}finally{h(!1)}},I=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),R=e=>"".concat((100*e).toFixed(1),"%");return s?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):e?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)(a.default,{href:"/",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[(0,r.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mt-2",children:"Financial Dashboard"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"Comprehensive financial metrics and performance indicators"})]}),(0,r.jsx)("div",{className:"flex space-x-3",children:(0,r.jsxs)(P,{variant:"outline",className:"flex items-center",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Financial Analytics"]})})]})}),(0,r.jsxs)(N,{defaultValue:"overview",className:"space-y-6",children:[(0,r.jsxs)(w,{className:"grid w-full grid-cols-4",children:[(0,r.jsx)(A,{value:"overview",children:"Overview"}),(0,r.jsx)(A,{value:"profitability",children:"Profitability"}),(0,r.jsx)(A,{value:"cashflow",children:"Cashflow"}),(0,r.jsx)(A,{value:"forecasting",children:"Forecasting"})]}),(0,r.jsxs)(_,{value:"overview",className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(y,{className:"text-sm font-medium",children:"YTD Profit"}),(0,r.jsx)(u.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(g,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:I(e.ytdProfit)}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["vs ",I(e.lastYearYtdProfit)," last year"]})]})]}),(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(y,{className:"text-sm font-medium",children:"Gross Margin"}),(0,r.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(g,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:R(e.currentYearGrossMargin)}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["vs ",R(e.lastYearGrossMargin)," last year"]})]})]}),(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(y,{className:"text-sm font-medium",children:"Utilization Rate"}),(0,r.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(g,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:R(e.utilizationRate)}),(0,r.jsx)(E,{value:100*e.utilizationRate,className:"mt-2"})]})]}),(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(y,{className:"text-sm font-medium",children:"Active Projects"}),(0,r.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(g,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:e.totalActiveProjects}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.totalEmployees," employees"]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(y,{children:"Multipliers"}),(0,r.jsx)(v,{children:"Project multipliers by year"})]}),(0,r.jsxs)(g,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Current Year"}),(0,r.jsxs)(P,{variant:"default",children:[e.currentYearMultiplier.toFixed(1),"x"]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Last Year"}),(0,r.jsxs)(P,{variant:"secondary",children:[e.lastYearMultiplier.toFixed(1),"x"]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Two Years Ago"}),(0,r.jsxs)(P,{variant:"outline",children:[e.twoYearsAgoMultiplier.toFixed(1),"x"]})]})]})]}),(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(y,{children:"Overhead Rates"}),(0,r.jsx)(v,{children:"Overhead rates by year"})]}),(0,r.jsxs)(g,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Current Year"}),(0,r.jsx)(P,{variant:"default",children:R(e.currentYearOverhead)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Last Year"}),(0,r.jsx)(P,{variant:"secondary",children:R(e.lastYearOverhead)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Two Years Ago"}),(0,r.jsx)(P,{variant:"outline",children:R(e.twoYearsAgoOverhead)})]})]})]})]})]}),(0,r.jsx)(_,{value:"profitability",className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(y,{children:"Profit Metrics"}),(0,r.jsx)(v,{children:"Year-to-date profitability analysis"})]}),(0,r.jsxs)(g,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"YTD Operating Income"}),(0,r.jsx)("span",{className:"font-semibold",children:I(e.ytdOperatingIncome)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Last Year YTD Operating Income"}),(0,r.jsx)("span",{className:"font-semibold",children:I(e.lastYearYtdOperatingIncome)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Revenue per Employee"}),(0,r.jsx)("span",{className:"font-semibold",children:I(e.currentYearRevenuePerEmployee)})]})]})]}),(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(y,{children:"Client Retention"}),(0,r.jsx)(v,{children:"Client retention and project metrics"})]}),(0,r.jsxs)(g,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Client Retention Rate"}),(0,r.jsx)(P,{variant:"default",children:R(e.clientRetentionRate)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Average Project Size"}),(0,r.jsx)("span",{className:"font-semibold",children:I(e.averageProjectSize)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Average Billing Rate"}),(0,r.jsxs)("span",{className:"font-semibold",children:[I(e.averageBillingRate),"/hr"]})]})]})]})]})}),(0,r.jsx)(_,{value:"cashflow",className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(y,{children:"Cashflow Overview"}),(0,r.jsx)(v,{children:"Current cashflow status"})]}),(0,r.jsxs)(g,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Current Cashflow"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-semibold",children:I(e.currentCashflow)}),(e=>{switch(e){case"up":return(0,r.jsx)(i.Z,{className:"h-4 w-4 text-green-600"});case"down":return(0,r.jsx)(l.Z,{className:"h-4 w-4 text-red-600"});default:return(0,r.jsx)(c.Z,{className:"h-4 w-4 text-gray-600"})}})(e.cashflowTrend)]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Previous Month"}),(0,r.jsx)("span",{className:"font-semibold",children:I(e.previousMonthCashflow)})]})]})]}),(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(y,{children:"Invoice Status"}),(0,r.jsx)(v,{children:"Outstanding invoices and payment metrics"})]}),(0,r.jsxs)(g,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Overdue Invoices"}),(0,r.jsx)("span",{className:"font-semibold text-red-600",children:I(e.overdueInvoiceValue)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Total Outstanding"}),(0,r.jsx)("span",{className:"font-semibold",children:I(e.totalOutstandingInvoices)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Avg Days to Payment"}),(0,r.jsxs)("span",{className:"font-semibold",children:[e.averageDaysToPayment," days"]})]})]})]})]})}),(0,r.jsx)(_,{value:"forecasting",className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(y,{children:"Trailing 12 Months"}),(0,r.jsx)(v,{children:"Revenue and profit trends"})]}),(0,r.jsx)(g,{children:(0,r.jsx)("div",{className:"space-y-2",children:e.trailing12Months.slice(-6).map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,r.jsx)("span",{children:e.month}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("span",{children:I(e.revenue)}),(0,r.jsx)(P,{variant:e.profitMargin>.2?"default":"secondary",children:R(e.profitMargin)})]})]},t))})})]}),(0,r.jsxs)(j,{children:[(0,r.jsxs)(p,{children:[(0,r.jsx)(y,{children:"6-Month Forecast"}),(0,r.jsx)(v,{children:"Projected revenue and expenses"})]}),(0,r.jsx)(g,{children:(0,r.jsx)("div",{className:"space-y-2",children:e.forecast.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,r.jsx)("span",{children:e.month}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("span",{children:I(e.projectedRevenue)}),(0,r.jsx)(P,{variant:"outline",children:I(e.projectedProfit)})]})]},t))})})]})]})})]})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Financial Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Failed to load dashboard data"})]})})}function S(){return(0,r.jsx)(C.Z,{children:(0,r.jsx)(D,{})})}},17486:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(57437),n=s(90483),a=s(99376),i=s(2265);function l(e){let{children:t}=e,{user:s,loading:l}=(0,n.a)(),c=(0,a.useRouter)();return((0,i.useEffect)(()=>{l||s&&s.isAdmin||c.push("/unauthorized")},[s,l,c]),l)?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):s&&s.isAdmin?(0,r.jsx)(r.Fragment,{children:t}):null}},90483:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return j},a:function(){return p}});var r=s(57437),n=s(2265),a=s(96244),i=s(40257);let l="72ed6933-6bc6-430e-a75a-cb5d2e1c20e1",c="e4748cdc-321b-4db0-bc36-141b121a9117";l&&c||(console.warn("Azure AD environment variables are not set. Authentication will not work."),console.warn("Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file"));let o={auth:{clientId:l||"dummy-client-id",authority:"https://login.microsoftonline.com/".concat(c||"dummy-tenant-id"),redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}},d=new a.Lx(o),u={scopes:["User.Read","Directory.Read.All"]};async function m(){try{if(!l||!c)throw Error("Azure AD environment variables are not configured. Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file");return await d.loginRedirect(u),null}catch(e){throw console.error("Sign in error:",e),e}}async function f(){try{await d.logoutPopup()}catch(e){console.error("Sign out error:",e)}}async function x(){try{var e,t;let s=d.getActiveAccount();if(!s)return null;let r=await d.acquireTokenSilent({scopes:["User.Read","Directory.Read.All"]}),n=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(r.accessToken)}});if(!n.ok)throw Error("Failed to fetch user details");let a=await n.json(),l=(null===(e=i.env.NEXT_PUBLIC_ADMIN_EMAILS)||void 0===e?void 0:e.split(","))||[],c=l.includes(a.mail)||l.includes(a.userPrincipalName)||(null===(t=a.mail)||void 0===t?void 0:t.endsWith("@yourcompany.com"));return{id:s.localAccountId,name:s.name||"",email:s.username||"",isAdmin:c,isBasic:!0}}catch(t){console.error("Get auth user error:",t);let e=d.getActiveAccount();return{id:(null==e?void 0:e.localAccountId)||"",name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.username)||"",isAdmin:!1,isBasic:!0}}}let h=(0,n.createContext)(void 0);function j(e){let{children:t}=e,[s,a]=(0,n.useState)(null),[i,l]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{try{await d.initialize();let e=await d.handleRedirectPromise();e&&(console.log("Redirect response received:",e),d.setActiveAccount(e.account));let t=await x();a(t)}catch(e){console.error("Auth initialization error:",e)}finally{l(!1)}})()},[]);let c=async()=>{try{l(!0),await m()}catch(e){console.error("Sign in error:",e),l(!1)}},o=async()=>{try{l(!0),await f(),a(null)}catch(e){console.error("Sign out error:",e)}finally{l(!1)}};return(0,r.jsx)(h.Provider,{value:{user:s,loading:i,signIn:c,signOut:o},children:t})}function p(){let e=(0,n.useContext)(h);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},94508:function(e,t,s){"use strict";s.d(t,{K0:function(){return b},UF:function(){return f},_2:function(){return v},ab:function(){return x},az:function(){return g},bh:function(){return p},bx:function(){return w},cn:function(){return d},fc:function(){return h},ji:function(){return m},sJ:function(){return N},sP:function(){return A},xG:function(){return j}});var r=s(31559),n=s(13657),a=s(61069),i=s(55463),l=s(14613),c=s(61994),o=s(53335);function d(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.m6)((0,c.W)(t))}function u(e,t){let s=[],l=(0,r.Z)(e),c=(0,n.Z)(t);for(;l<=c;)s.push((0,a.Z)(l,"yyyy-MM")),l=(0,i.Z)(l,1);return s}function m(){let e=new Date(2022,0,1),t=new Date;return u(e,(0,i.Z)(t,24))}function f(){let e=new Date;return u((0,l.Z)(e,12),(0,i.Z)(e,12))}function x(e,t,s){let r=t||[],n=s||{},i=m();return(e||[]).map(e=>{let t=r.filter(t=>t.project_id===e.project_id),s=i.map(s=>{var r,i,l;let c=t.filter(e=>(0,a.Z)(new Date(e.date),"yyyy-MM")===s),o=c.reduce((e,t)=>e+t.billed_amount,0),d=c.reduce((e,t)=>e+t.unbilled_amount,0),u=(null===(l=n[e.project_id])||void 0===l?void 0:null===(i=l.months)||void 0===i?void 0:null===(r=i[s])||void 0===r?void 0:r.value)||0;return{month:s,billed:o,unbilled:d,projected:u,actual:o+d}}),l=s.reduce((e,t)=>e+t.billed,0),c=s.reduce((e,t)=>e+t.unbilled,0),o=s.reduce((e,t)=>e+t.projected,0);return{projectId:e.project_id,projectName:e.project_name,customerName:e.customer_name,signedFee:void 0,monthlyData:s,totalBilled:l,totalUnbilled:c,totalProjected:o}})}function h(e,t,s,r){if(!e||!Array.isArray(e))return{totalProjects:0,totalBilled:0,totalUnbilled:0,totalProjected:0,activeProjects:0,totalHours:0,billableHours:0,nonBillableHours:0,averageHourlyRate:0,totalTimeValue:0,efficiency:0,averageHoursPerProject:0,topPerformingProjects:[]};let n=e.length,a=t?t.size:0,i=s||v("monthlyProjections")||{},l=r||v("monthlyStatuses")||{},c=new Date().getFullYear().toString(),o=0;Object.keys(i).forEach(e=>{let t=i[e],s=l[e];t&&s&&Object.keys(t).forEach(e=>{e.startsWith(c)&&"Billed"===s[e]&&(o+=t[e]||0)})});let d=new Date().toISOString().slice(0,7),u=0;Object.keys(i).forEach(e=>{let t=i[e],s=l[e];t&&s&&Object.keys(t).forEach(e=>{e>=d&&"Billed"!==s[e]&&(u+=t[e]||0)})});let m=0;Object.keys(i).forEach(e=>{let t=i[e];t&&Object.keys(t).forEach(e=>{e>=d&&(m+=t[e]||0)})});let f=0,x=0,h=0,j=0,p=0,y=[];e.forEach(e=>{if(e.clockifyData){let t=e.clockifyData;if(f+=t.totalHours,x+=t.billableHours,h+=t.nonBillableHours,j+=t.billableAmount,t.totalHours>0){let s=t.billableHours/t.totalHours;y.push({projectId:e.projectId,efficiency:s,hours:t.totalHours}),p++}}});let g=p>0?j/x:0,b=f>0?x/f:0,N=p>0?f/p:0,w=y.sort((e,t)=>t.efficiency*t.hours-e.efficiency*e.hours).slice(0,5).map(e=>e.projectId);return{totalProjects:n,totalBilled:o,totalUnbilled:u,totalProjected:m,activeProjects:n-a,totalHours:f,billableHours:x,nonBillableHours:h,averageHourlyRate:g,totalTimeValue:j,efficiency:b,averageHoursPerProject:N,topPerformingProjects:w}}function j(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function p(e){let[t,s]=e.split("-"),r=new Date(parseInt(t),parseInt(s)-1);return(0,a.Z)(r,"MMM yyyy")}function y(){try{let e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function v(e){if(!y())return console.warn("localStorage is not available"),null;try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.error("Error reading from localStorage key '".concat(e,"':"),t),null}}function g(e,t){if(!y())return console.warn("localStorage is not available"),!1;try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(t){return console.error("Error writing to localStorage key '".concat(e,"':"),t),!1}}function b(e){let t=m(),s={};return(e||[]).forEach(e=>{s[e.project_id]={months:{},asrFee:0},t.forEach(t=>{let r=t>(0,a.Z)(new Date,"yyyy-MM");s[e.project_id].months[t]={value:0,isEditable:r,isProjected:r}})}),s}function N(e,t){return e.map(e=>{let s=t.find(t=>t.projectId===e.projectId||t.projectName.toLowerCase().includes(e.projectName.toLowerCase()));if(s){let t=function(e){let t=e.totalHours>0?e.billableHours/e.totalHours:0,s=e.billableHours>0?e.billableAmount/e.billableHours:0;return{projectId:e.projectId,projectName:e.projectName,totalHours:e.totalHours,billableHours:e.billableHours,nonBillableHours:e.nonBillableHours,hourlyRate:s,totalValue:e.billableAmount,efficiency:t,period:e.period}}(s);return{...e,clockifyData:s,totalHours:s.totalHours,billableHours:s.billableHours,nonBillableHours:s.nonBillableHours,hourlyRate:t.hourlyRate,efficiency:t.efficiency}}return e})}function w(e){let t=Math.floor(e);return"".concat(t,"h ").concat(Math.round((e-t)*60),"m")}function A(e){return"".concat((100*e).toFixed(1),"%")}}},function(e){e.O(0,[649,648,82,538,971,117,744],function(){return e(e.s=48721)}),_N_E=e.O()}]);
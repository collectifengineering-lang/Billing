(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{48721:function(e,s,l){Promise.resolve().then(l.bind(l,77103))},77103:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return M}});var t=l(57437),n=l(2265),a=l(27648),r=l(70525),i=l(3085),c=l(21047),o=l(32660),d=l(46221),u=l(63639),x=l(95252),m=l(48664),h=l(58896),j=l(95805),f=l(98420),v=l(65302),p=l(45131),g=l(94508);let y=n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",l),...n})});y.displayName="Card";let N=n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("flex flex-col space-y-1.5 p-6",l),...n})});N.displayName="CardHeader";let b=n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)("h3",{ref:s,className:(0,g.cn)("text-2xl font-semibold leading-none tracking-tight",l),...n})});b.displayName="CardTitle";let w=n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)("p",{ref:s,className:(0,g.cn)("text-sm text-muted-foreground",l),...n})});w.displayName="CardDescription";let P=n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("p-6 pt-0",l),...n})});P.displayName="CardContent",n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("flex items-center p-6 pt-0",l),...n})}).displayName="CardFooter";var A=l(43105);let C=A.fC,k=n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)(A.aV,{ref:s,className:(0,g.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",l),...n})});k.displayName=A.aV.displayName;let D=n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)(A.xz,{ref:s,className:(0,g.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",l),...n})});D.displayName=A.xz.displayName;let E=n.forwardRef((e,s)=>{let{className:l,...n}=e;return(0,t.jsx)(A.VY,{ref:s,className:(0,g.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",l),...n})});E.displayName=A.VY.displayName;let I=(0,l(90535).j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function _(e){let{className:s,variant:l,...n}=e;return(0,t.jsx)("div",{className:(0,g.cn)(I({variant:l}),s),...n})}var S=l(60610);let R=n.forwardRef((e,s)=>{let{className:l,value:n,...a}=e;return(0,t.jsx)(S.fC,{ref:s,className:(0,g.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",l),...a,children:(0,t.jsx)(S.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});R.displayName=S.fC.displayName;var T=l(17486);function H(){var e,s,l,g,A,I,S,T,H,M,B,O,U;let[F,Z]=(0,n.useState)(null),[L,Y]=(0,n.useState)(null),[z,V]=(0,n.useState)([]),[W,X]=(0,n.useState)(""),[G,J]=(0,n.useState)(!0),[q,K]=(0,n.useState)(!1),[$,Q]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{Q(null),await Promise.all([ee(),es()])}catch(e){console.error("Failed to initialize dashboard:",e),Q("Failed to initialize dashboard. Please refresh the page.")}})()},[]),(0,n.useEffect)(()=>{W?el(W):Y(null)},[W]);let ee=async()=>{try{J(!0);let e=await fetch("/api/dashboard");if(!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(e.statusText));let s=await e.json();Z(s)}catch(e){console.error("Error fetching dashboard data:",e),Q("Failed to load dashboard data. Please check your connection and try again.")}finally{J(!1)}},es=async()=>{try{let e=await fetch("/api/projects");if(!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(e.statusText));let s=await e.json();V(s.data||[])}catch(e){console.error("Error fetching projects:",e),Q("Failed to load projects. Please check your connection and try again.")}},el=async e=>{try{K(!0);let s=await fetch("/api/dashboard/project/".concat(e));if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"HTTP ".concat(s.status,": ").concat(s.statusText))}let l=await s.json();Y(l)}catch(s){console.error("Error fetching project metrics:",s),Q("Failed to load project metrics. Please try selecting a different project."),Y({projectId:e,projectName:"Unknown Project",customerName:"Unknown Customer",status:"unknown",startDate:new Date().toISOString().split("T")[0],totalBudget:0,totalBilled:0,totalUnbilled:0,totalCollected:0,outstandingAmount:0,profitMargin:0,grossProfit:0,currentMultiplier:0,historicalMultipliers:[],totalHours:0,billableHours:0,nonBillableHours:0,efficiency:0,employeeBreakdown:[],timeEntries:[],cashBasis:{totalCollected:0,outstandingReceivables:0,totalRevenue:0},accrualBasis:{totalEarned:0,totalExpenses:0,netIncome:0,workInProgress:0},budgetUtilization:0,schedulePerformance:0,profitabilityTrend:"stable",riskLevel:"low",changeOrders:{count:0,totalValue:0,approvedValue:0,pendingValue:0},phases:[],projectedCompletion:new Date().toISOString().split("T")[0],projectedFinalCost:0,projectedProfit:0,projectedMargin:0})}finally{K(!1)}},et=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),en=e=>"".concat((100*e).toFixed(1),"%");return $?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-red-900 mb-4",children:"Dashboard Error"}),(0,t.jsx)("p",{className:"text-red-600 mb-4",children:$}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Refresh Page"})]})}):G?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):F?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center space-x-4",children:(0,t.jsxs)(a.default,{href:"/",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),"Back to Home"]})}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mt-2",children:"Financial Dashboard"}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Comprehensive financial metrics and performance indicators"})]}),(0,t.jsx)("div",{className:"flex space-x-3",children:(0,t.jsxs)(_,{variant:"outline",className:"flex items-center",children:[(0,t.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"Financial Analytics"]})})]})}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("label",{htmlFor:"project-select",className:"text-sm font-medium text-gray-700",children:"Select Project:"}),(0,t.jsxs)("select",{id:"project-select",value:W,onChange:e=>{try{let s=e.target.value;console.log("Project selection changed to:",s),X(s)}catch(e){console.error("Error in project selection change:",e),X(""),Y(null)}},className:"block w-80 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[(0,t.jsx)("option",{value:"",children:"All Projects (Company Overview)"}),Array.isArray(z)&&z.map(e=>(0,t.jsxs)("option",{value:(null==e?void 0:e.project_id)||"",children:[(null==e?void 0:e.project_name)||"Unknown Project"," - ",(null==e?void 0:e.customer_name)||"Unknown Customer"]},(null==e?void 0:e.project_id)||"unknown"))]}),q&&(0,t.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Loading project data..."]})]})}),$&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(u.Z,{className:"h-5 w-5 text-red-400"})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Dashboard Error"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,t.jsx)("p",{children:$})}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("button",{onClick:()=>{Q(null),window.location.reload()},className:"bg-red-100 text-red-800 px-3 py-2 rounded-md text-sm font-medium hover:bg-red-200",children:"Retry"})})]})]})}),(0,t.jsxs)(C,{defaultValue:"overview",className:"space-y-6",children:[(0,t.jsxs)(k,{className:"grid w-full grid-cols-5",children:[(0,t.jsx)(D,{value:"overview",children:"Overview"}),(0,t.jsx)(D,{value:"profitability",children:"Profitability"}),(0,t.jsx)(D,{value:"cashflow",children:"Cashflow"}),(0,t.jsx)(D,{value:"forecasting",children:"Forecasting"}),W&&(0,t.jsx)(D,{value:"project",children:"Project Details"})]}),(0,t.jsxs)(E,{value:"overview",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(b,{className:"text-sm font-medium",children:"YTD Profit"}),(0,t.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(P,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:et((null==F?void 0:F.ytdProfit)||0)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["vs ",et((null==F?void 0:F.lastYearYtdProfit)||0)," last year"]})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(b,{className:"text-sm font-medium",children:"Gross Margin"}),(0,t.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(P,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:en((null==F?void 0:F.currentYearGrossMargin)||0)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["vs ",en((null==F?void 0:F.lastYearGrossMargin)||0)," last year"]})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(b,{className:"text-sm font-medium",children:"Utilization Rate"}),(0,t.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(P,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:en((null==F?void 0:F.utilizationRate)||0)}),(0,t.jsx)(R,{value:100*((null==F?void 0:F.utilizationRate)||0),className:"mt-2"})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(b,{className:"text-sm font-medium",children:"Active Projects"}),(0,t.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(P,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:(null==F?void 0:F.totalActiveProjects)||0}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==F?void 0:F.totalEmployees)||0," employees"]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Multipliers"}),(0,t.jsx)(w,{children:"Project multipliers by year"})]}),(0,t.jsxs)(P,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Current Year"}),(0,t.jsxs)(_,{variant:"default",children:[(null==F?void 0:F.currentYearMultiplier.toFixed(1))||"N/A","x"]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Last Year"}),(0,t.jsxs)(_,{variant:"secondary",children:[(null==F?void 0:F.lastYearMultiplier.toFixed(1))||"N/A","x"]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Two Years Ago"}),(0,t.jsxs)(_,{variant:"outline",children:[(null==F?void 0:F.twoYearsAgoMultiplier.toFixed(1))||"N/A","x"]})]})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Overhead Rates"}),(0,t.jsx)(w,{children:"Overhead rates by year"})]}),(0,t.jsxs)(P,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Current Year"}),(0,t.jsx)(_,{variant:"default",children:en((null==F?void 0:F.currentYearOverhead)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Last Year"}),(0,t.jsx)(_,{variant:"secondary",children:en((null==F?void 0:F.lastYearOverhead)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Two Years Ago"}),(0,t.jsx)(_,{variant:"outline",children:en((null==F?void 0:F.twoYearsAgoOverhead)||0)})]})]})]})]})]}),(0,t.jsx)(E,{value:"profitability",className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Profit Metrics"}),(0,t.jsx)(w,{children:"Year-to-date profitability analysis"})]}),(0,t.jsxs)(P,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"YTD Operating Income"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==F?void 0:F.ytdOperatingIncome)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Last Year YTD Operating Income"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==F?void 0:F.lastYearYtdOperatingIncome)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Revenue per Employee"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==F?void 0:F.currentYearRevenuePerEmployee)||0)})]})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Client Retention"}),(0,t.jsx)(w,{children:"Client retention and project metrics"})]}),(0,t.jsxs)(P,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Client Retention Rate"}),(0,t.jsx)(_,{variant:"default",children:en((null==F?void 0:F.clientRetentionRate)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Average Project Size"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==F?void 0:F.averageProjectSize)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Average Billing Rate"}),(0,t.jsxs)("span",{className:"font-semibold",children:[et((null==F?void 0:F.averageBillingRate)||0),"/hr"]})]})]})]})]})}),(0,t.jsx)(E,{value:"cashflow",className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Cashflow Overview"}),(0,t.jsx)(w,{children:"Current cashflow status"})]}),(0,t.jsxs)(P,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Current Cashflow"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"font-semibold",children:et((null==F?void 0:F.currentCashflow)||0)}),(e=>{switch(e){case"up":return(0,t.jsx)(r.Z,{className:"h-4 w-4 text-green-600"});case"down":return(0,t.jsx)(i.Z,{className:"h-4 w-4 text-red-600"});default:return(0,t.jsx)(c.Z,{className:"h-4 w-4 text-gray-600"})}})((null==F?void 0:F.cashflowTrend)||"stable")]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Previous Month"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==F?void 0:F.previousMonthCashflow)||0)})]})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Invoice Status"}),(0,t.jsx)(w,{children:"Outstanding invoices and payment metrics"})]}),(0,t.jsxs)(P,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Overdue Invoices"}),(0,t.jsx)("span",{className:"font-semibold text-red-600",children:et((null==F?void 0:F.overdueInvoiceValue)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Total Outstanding"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==F?void 0:F.totalOutstandingInvoices)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{children:"Avg Days to Payment"}),(0,t.jsxs)("span",{className:"font-semibold",children:[(null==F?void 0:F.averageDaysToPayment)||0," days"]})]})]})]})]})}),(0,t.jsx)(E,{value:"forecasting",className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Trailing 12 Months"}),(0,t.jsx)(w,{children:"Revenue and profit trends"})]}),(0,t.jsx)(P,{children:(0,t.jsx)("div",{className:"space-y-2",children:null==F?void 0:null===(e=F.trailing12Months)||void 0===e?void 0:e.slice(-6).map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsx)("span",{children:e.month}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("span",{children:et(e.revenue)}),(0,t.jsx)(_,{variant:e.profitMargin>.2?"default":"secondary",children:en(e.profitMargin)})]})]},s))})})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"6-Month Forecast"}),(0,t.jsx)(w,{children:"Projected revenue and expenses"})]}),(0,t.jsx)(P,{children:(0,t.jsx)("div",{className:"space-y-2",children:null==F?void 0:null===(s=F.forecast)||void 0===s?void 0:s.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsx)("span",{children:e.month}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("span",{children:et(e.projectedRevenue)}),(0,t.jsx)(_,{variant:"outline",children:et(e.projectedProfit)})]})]},s))})})]})]})}),W&&L&&(0,t.jsxs)(E,{value:"project",className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:(null==L?void 0:L.projectName)||"Unknown Project"}),(0,t.jsx)("p",{className:"text-gray-600",children:(null==L?void 0:L.customerName)||"Unknown Customer"}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,t.jsx)(_,{variant:(null==L?void 0:L.status)==="active"?"default":"secondary",children:(null==L?void 0:L.status)||"unknown"}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:[(null==L?void 0:L.startDate)?new Date(L.startDate).toLocaleDateString():"Unknown Date",(null==L?void 0:L.endDate)&&" - ".concat(new Date(L.endDate).toLocaleDateString())]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:et((null==L?void 0:L.totalBudget)||0)}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"Total Budget"})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(b,{className:"text-sm font-medium",children:"Current Multiplier"}),(0,t.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(P,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[((null==L?void 0:L.currentMultiplier)||0).toFixed(1),"x"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==L?void 0:L.profitabilityTrend)==="improving"&&"↗ Improving",(null==L?void 0:L.profitabilityTrend)==="declining"&&"↘ Declining",(null==L?void 0:L.profitabilityTrend)==="stable"&&"→ Stable"]})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(b,{className:"text-sm font-medium",children:"Efficiency"}),(0,t.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(P,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:en((null==L?void 0:L.efficiency)||0)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==L?void 0:L.billableHours)||0,"h billable / ",(null==L?void 0:L.totalHours)||0,"h total"]})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(b,{className:"text-sm font-medium",children:"Budget Utilization"}),(0,t.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(P,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:en(((null==L?void 0:L.budgetUtilization)||0)/100)}),(0,t.jsx)(R,{value:(null==L?void 0:L.budgetUtilization)||0,className:"mt-2"})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(b,{className:"text-sm font-medium",children:"Risk Level"}),(null==L?void 0:L.riskLevel)==="low"&&(0,t.jsx)(v.Z,{className:"h-4 w-4 text-green-600"}),(null==L?void 0:L.riskLevel)==="medium"&&(0,t.jsx)(u.Z,{className:"h-4 w-4 text-yellow-600"}),(null==L?void 0:L.riskLevel)==="high"&&(0,t.jsx)(p.Z,{className:"h-4 w-4 text-red-600"})]}),(0,t.jsxs)(P,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold capitalize",children:(null==L?void 0:L.riskLevel)||"unknown"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==L?void 0:L.schedulePerformance)||0,"% schedule performance"]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Financial Summary"}),(0,t.jsx)(w,{children:"Cash vs Accrual basis"})]}),(0,t.jsxs)(P,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-sm text-gray-700 mb-2",children:"Cash Basis"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Total Collected"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==L?void 0:null===(l=L.cashBasis)||void 0===l?void 0:l.totalCollected)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Outstanding"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==L?void 0:null===(g=L.cashBasis)||void 0===g?void 0:g.outstandingReceivables)||0)})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-sm text-gray-700 mb-2",children:"Accrual Basis"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Total Earned"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==L?void 0:null===(A=L.accrualBasis)||void 0===A?void 0:A.totalEarned)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Work in Progress"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==L?void 0:null===(I=L.accrualBasis)||void 0===I?void 0:I.workInProgress)||0)})]})]})]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"font-semibold",children:"Gross Profit"}),(0,t.jsx)("span",{className:"text-lg font-bold text-green-600",children:et((null==L?void 0:L.grossProfit)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Profit Margin"}),(0,t.jsx)("span",{className:"text-sm font-semibold",children:en((null==L?void 0:L.profitMargin)||0)})]})]})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Employee Analysis"}),(0,t.jsx)(w,{children:"Hours and efficiency by employee"})]}),(0,t.jsx)(P,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[null==L?void 0:null===(S=L.employeeBreakdown)||void 0===S?void 0:S.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-semibold text-sm",children:(null==e?void 0:e.employeeName)||"Unknown Employee"}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[(null==e?void 0:e.billableHours)||0,"h billable / ",(null==e?void 0:e.totalHours)||0,"h total"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"font-semibold",children:et((null==e?void 0:e.billableValue)||0)}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[en((null==e?void 0:e.efficiency)||0)," efficient"]})]})]},s)),(!(null==L?void 0:L.employeeBreakdown)||0===L.employeeBreakdown.length)&&(0,t.jsx)("div",{className:"text-center text-gray-500 py-4",children:"No employee data available"})]})})]})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Project Phases"}),(0,t.jsx)(w,{children:"Architectural/Engineering phase breakdown"})]}),(0,t.jsx)(P,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[null==L?void 0:null===(T=L.phases)||void 0===T?void 0:T.map((e,s)=>(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"font-semibold",children:(null==e?void 0:e.phaseName)||"Unknown Phase"}),(0,t.jsxs)(_,{variant:100===((null==e?void 0:e.completion)||0)?"default":"secondary",children:[(null==e?void 0:e.completion)||0,"% Complete"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Budget:"}),(0,t.jsx)("div",{className:"font-semibold",children:et((null==e?void 0:e.budget)||0)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Actual Cost:"}),(0,t.jsx)("div",{className:"font-semibold",children:et((null==e?void 0:e.actualCost)||0)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Hours:"}),(0,t.jsxs)("div",{className:"font-semibold",children:[(null==e?void 0:e.hours)||0,"h"]})]})]}),(0,t.jsx)(R,{value:(null==e?void 0:e.completion)||0,className:"mt-2"})]},s)),(!(null==L?void 0:L.phases)||0===L.phases.length)&&(0,t.jsx)("div",{className:"text-center text-gray-500 py-4",children:"No phase data available"})]})})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Change Orders"}),(0,t.jsx)(w,{children:"Additional scope and value"})]}),(0,t.jsx)(P,{children:(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:(null==L?void 0:null===(H=L.changeOrders)||void 0===H?void 0:H.count)||0}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Total Changes"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:et((null==L?void 0:null===(M=L.changeOrders)||void 0===M?void 0:M.totalValue)||0)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Total Value"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:et((null==L?void 0:null===(B=L.changeOrders)||void 0===B?void 0:B.approvedValue)||0)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Approved"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:et((null==L?void 0:null===(O=L.changeOrders)||void 0===O?void 0:O.pendingValue)||0)}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Pending"})]})]})})]}),(0,t.jsxs)(y,{children:[(0,t.jsxs)(N,{children:[(0,t.jsx)(b,{children:"Project Forecasting"}),(0,t.jsx)(w,{children:"Projected completion and final metrics"})]}),(0,t.jsx)(P,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-3",children:"Projected Completion"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Target Date:"}),(0,t.jsx)("span",{className:"font-semibold",children:(null==L?void 0:L.projectedCompletion)?new Date(L.projectedCompletion).toLocaleDateString():"Unknown Date"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Projected Final Cost:"}),(0,t.jsx)("span",{className:"font-semibold",children:et((null==L?void 0:L.projectedFinalCost)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Projected Profit:"}),(0,t.jsx)("span",{className:"font-semibold text-green-600",children:et((null==L?void 0:L.projectedProfit)||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Projected Margin:"}),(0,t.jsx)("span",{className:"font-semibold",children:en((null==L?void 0:L.projectedMargin)||0)})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-3",children:"Historical Multipliers"}),(0,t.jsxs)("div",{className:"space-y-2",children:[null==L?void 0:null===(U=L.historicalMultipliers)||void 0===U?void 0:U.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-semibold",children:[((null==e?void 0:e.multiplier)||0).toFixed(1),"x"]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:(null==e?void 0:e.notes)||"No notes"})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:(null==e?void 0:e.date)?new Date(e.date).toLocaleDateString():"Unknown Date"})]},s)),(!(null==L?void 0:L.historicalMultipliers)||0===L.historicalMultipliers.length)&&(0,t.jsx)("div",{className:"text-center text-gray-500 py-2",children:"No historical multiplier data available"})]})]})]})})]})]})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Financial Dashboard"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Failed to load dashboard data"})]})})}function M(){return(0,t.jsx)(T.Z,{children:(0,t.jsx)(H,{})})}},17486:function(e,s,l){"use strict";l.d(s,{Z:function(){return i}});var t=l(57437),n=l(90483),a=l(99376),r=l(2265);function i(e){let{children:s}=e,{user:l,loading:i}=(0,n.a)(),c=(0,a.useRouter)();return((0,r.useEffect)(()=>{i||l&&l.isAdmin||c.push("/unauthorized")},[l,i,c]),i)?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):l&&l.isAdmin?(0,t.jsx)(t.Fragment,{children:s}):null}},90483:function(e,s,l){"use strict";l.d(s,{AuthProvider:function(){return f},a:function(){return v}});var t=l(57437),n=l(2265),a=l(96244),r=l(40257);let i="72ed6933-6bc6-430e-a75a-cb5d2e1c20e1",c="e4748cdc-321b-4db0-bc36-141b121a9117";i&&c||(console.warn("Azure AD environment variables are not set. Authentication will not work."),console.warn("Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file"));let o={auth:{clientId:i||"dummy-client-id",authority:"https://login.microsoftonline.com/".concat(c||"dummy-tenant-id"),redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}},d=new a.Lx(o),u={scopes:["User.Read","Directory.Read.All"]};async function x(){try{if(!i||!c)throw Error("Azure AD environment variables are not configured. Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file");return await d.loginRedirect(u),null}catch(e){throw console.error("Sign in error:",e),e}}async function m(){try{await d.logoutPopup()}catch(e){console.error("Sign out error:",e)}}async function h(){try{var e,s,l,t,n;let a=d.getActiveAccount();if(!a)return null;let i=await d.acquireTokenSilent({scopes:["User.Read","Directory.Read.All"]}),c=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(i.accessToken)}});if(!c.ok)throw Error("Failed to fetch user details");let o=await c.json(),u=(null===(e=r.env.NEXT_PUBLIC_ADMIN_EMAILS)||void 0===e?void 0:e.split(","))||[],x=u.includes(o.mail)||u.includes(o.userPrincipalName)||(null===(s=o.mail)||void 0===s?void 0:s.endsWith("@collectif.nyc"))||(null===(l=o.mail)||void 0===l?void 0:l.endsWith("@yourcompany.com"));return console.log("Auth Debug:",{userEmail:o.mail,userPrincipalName:o.userPrincipalName,adminEmails:u,isAdmin:x,adminEmailsIncludes:u.includes(o.mail),adminEmailsIncludesPrincipal:u.includes(o.userPrincipalName),endsWithCollectif:null===(t=o.mail)||void 0===t?void 0:t.endsWith("@collectif.nyc"),endsWithLegacy:null===(n=o.mail)||void 0===n?void 0:n.endsWith("@yourcompany.com"),envVar:r.env.NEXT_PUBLIC_ADMIN_EMAILS}),{id:a.localAccountId,name:a.name||"",email:a.username||"",isAdmin:x,isBasic:!0}}catch(s){console.error("Get auth user error:",s);let e=d.getActiveAccount();return console.log("Auth Fallback Debug:",{accountEmail:null==e?void 0:e.username,accountName:null==e?void 0:e.name,isAdmin:!1}),{id:(null==e?void 0:e.localAccountId)||"",name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.username)||"",isAdmin:!1,isBasic:!0}}}let j=(0,n.createContext)(void 0);function f(e){let{children:s}=e,[l,a]=(0,n.useState)(null),[r,i]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{try{await d.initialize();let e=await d.handleRedirectPromise();e&&(console.log("Redirect response received:",e),d.setActiveAccount(e.account));let s=await h();a(s)}catch(e){console.error("Auth initialization error:",e)}finally{i(!1)}})()},[]);let c=async()=>{try{i(!0),await x()}catch(e){console.error("Sign in error:",e),i(!1)}},o=async()=>{try{i(!0),await m(),a(null)}catch(e){console.error("Sign out error:",e)}finally{i(!1)}};return(0,t.jsx)(j.Provider,{value:{user:l,loading:r,signIn:c,signOut:o},children:s})}function v(){let e=(0,n.useContext)(j);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},94508:function(e,s,l){"use strict";l.d(s,{K0:function(){return N},UF:function(){return m},_2:function(){return g},ab:function(){return h},az:function(){return y},bh:function(){return v},bx:function(){return w},cn:function(){return d},fc:function(){return j},ji:function(){return x},sJ:function(){return b},sP:function(){return P},xG:function(){return f}});var t=l(31559),n=l(13657),a=l(61069),r=l(55463),i=l(14613),c=l(61994),o=l(53335);function d(){for(var e=arguments.length,s=Array(e),l=0;l<e;l++)s[l]=arguments[l];return(0,o.m6)((0,c.W)(s))}function u(e,s){let l=[],i=(0,t.Z)(e),c=(0,n.Z)(s);for(;i<=c;)l.push((0,a.Z)(i,"yyyy-MM")),i=(0,r.Z)(i,1);return l}function x(){let e=new Date(2022,0,1),s=new Date;return u(e,(0,r.Z)(s,24))}function m(){let e=new Date;return u((0,i.Z)(e,12),(0,r.Z)(e,12))}function h(e,s,l){let t=s||[],n=l||{},r=x();return(e||[]).map(e=>{let s=t.filter(s=>s.project_id===e.project_id),l=r.map(l=>{var t,r,i;let c=s.filter(e=>(0,a.Z)(new Date(e.date),"yyyy-MM")===l),o=c.reduce((e,s)=>e+s.billed_amount,0),d=c.reduce((e,s)=>e+s.unbilled_amount,0),u=(null===(i=n[e.project_id])||void 0===i?void 0:null===(r=i.months)||void 0===r?void 0:null===(t=r[l])||void 0===t?void 0:t.value)||0;return{month:l,billed:o,unbilled:d,projected:u,actual:o+d}}),i=l.reduce((e,s)=>e+s.billed,0),c=l.reduce((e,s)=>e+s.unbilled,0),o=l.reduce((e,s)=>e+s.projected,0);return{projectId:e.project_id,projectName:e.project_name,customerName:e.customer_name,signedFee:void 0,monthlyData:l,totalBilled:i,totalUnbilled:c,totalProjected:o}})}function j(e,s,l,t){if(!e||!Array.isArray(e))return{totalProjects:0,totalBilled:0,totalUnbilled:0,totalProjected:0,activeProjects:0,totalHours:0,billableHours:0,nonBillableHours:0,averageHourlyRate:0,totalTimeValue:0,efficiency:0,averageHoursPerProject:0,topPerformingProjects:[]};let n=e.length,a=s?s.size:0,r=l||g("monthlyProjections")||{},i=t||g("monthlyStatuses")||{},c=new Date().getFullYear().toString(),o=0;Object.keys(r).forEach(e=>{let s=r[e],l=i[e];s&&l&&Object.keys(s).forEach(e=>{e.startsWith(c)&&"Billed"===l[e]&&(o+=s[e]||0)})});let d=new Date().toISOString().slice(0,7),u=0;Object.keys(r).forEach(e=>{let s=r[e],l=i[e];s&&l&&Object.keys(s).forEach(e=>{e>=d&&"Billed"!==l[e]&&(u+=s[e]||0)})});let x=0;Object.keys(r).forEach(e=>{let s=r[e];s&&Object.keys(s).forEach(e=>{e>=d&&(x+=s[e]||0)})});let m=0,h=0,j=0,f=0,v=0,p=[];e.forEach(e=>{if(e.clockifyData){let s=e.clockifyData;if(m+=s.totalHours,h+=s.billableHours,j+=s.nonBillableHours,f+=s.billableAmount,s.totalHours>0){let l=s.billableHours/s.totalHours;p.push({projectId:e.projectId,efficiency:l,hours:s.totalHours}),v++}}});let y=v>0?f/h:0,N=m>0?h/m:0,b=v>0?m/v:0,w=p.sort((e,s)=>s.efficiency*s.hours-e.efficiency*e.hours).slice(0,5).map(e=>e.projectId);return{totalProjects:n,totalBilled:o,totalUnbilled:u,totalProjected:x,activeProjects:n-a,totalHours:m,billableHours:h,nonBillableHours:j,averageHourlyRate:y,totalTimeValue:f,efficiency:N,averageHoursPerProject:b,topPerformingProjects:w}}function f(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function v(e){let[s,l]=e.split("-"),t=new Date(parseInt(s),parseInt(l)-1);return(0,a.Z)(t,"MMM yyyy")}function p(){try{let e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function g(e){if(!p())return console.warn("localStorage is not available"),null;try{let s=localStorage.getItem(e);return s?JSON.parse(s):null}catch(s){return console.error("Error reading from localStorage key '".concat(e,"':"),s),null}}function y(e,s){if(!p())return console.warn("localStorage is not available"),!1;try{return localStorage.setItem(e,JSON.stringify(s)),!0}catch(s){return console.error("Error writing to localStorage key '".concat(e,"':"),s),!1}}function N(e){let s=x(),l={};return(e||[]).forEach(e=>{l[e.project_id]={months:{},asrFee:0},s.forEach(s=>{let t=s>(0,a.Z)(new Date,"yyyy-MM");l[e.project_id].months[s]={value:0,isEditable:t,isProjected:t}})}),l}function b(e,s){return e.map(e=>{let l=s.find(s=>s.projectId===e.projectId||s.projectName.toLowerCase().includes(e.projectName.toLowerCase()));if(l){let s=function(e){let s=e.totalHours>0?e.billableHours/e.totalHours:0,l=e.billableHours>0?e.billableAmount/e.billableHours:0;return{projectId:e.projectId,projectName:e.projectName,totalHours:e.totalHours,billableHours:e.billableHours,nonBillableHours:e.nonBillableHours,hourlyRate:l,totalValue:e.billableAmount,efficiency:s,period:e.period}}(l);return{...e,clockifyData:l,totalHours:l.totalHours,billableHours:l.billableHours,nonBillableHours:l.nonBillableHours,hourlyRate:s.hourlyRate,efficiency:s.efficiency}}return e})}function w(e){let s=Math.floor(e);return"".concat(s,"h ").concat(Math.round((e-s)*60),"m")}function P(e){return"".concat((100*e).toFixed(1),"%")}}},function(e){e.O(0,[649,648,82,358,971,117,744],function(){return e(e.s=48721)}),_N_E=e.O()}]);
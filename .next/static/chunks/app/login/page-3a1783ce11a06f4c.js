(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{45161:function(e,t,r){Promise.resolve().then(r.bind(r,66374))},66374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(57437),i=r(2265),o=r(99376),s=r(90483);function c(){let{user:e,loading:t,signIn:r}=(0,s.a)(),c=(0,o.useRouter)(),[a,l]=(0,i.useState)(null);(0,i.useEffect)(()=>{!t&&e&&c.push("/")},[e,t,c]);let u=async()=>{try{l(null),await r()}catch(e){console.error("Sign in error:",e),l(e instanceof Error?e.message:"Sign in failed")}};return t?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):e?null:(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,n.jsx)("div",{children:(0,n.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"})}),(0,n.jsxs)("div",{className:"mt-8 space-y-6",children:[a&&(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,n.jsxs)("div",{className:"ml-3",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Authentication Error"}),(0,n.jsxs)("div",{className:"mt-2 text-sm text-red-700",children:[(0,n.jsx)("p",{children:a}),a.includes("environment variables")&&(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)("p",{className:"font-medium",children:"To fix this:"}),(0,n.jsxs)("ol",{className:"list-decimal list-inside mt-1 space-y-1",children:[(0,n.jsxs)("li",{children:["Create a ",(0,n.jsx)("code",{className:"bg-red-100 px-1 rounded",children:".env.local"})," file in the project root"]}),(0,n.jsx)("li",{children:"Add your Azure AD configuration:"})]}),(0,n.jsx)("pre",{className:"mt-2 bg-red-100 p-2 rounded text-xs overflow-x-auto",children:"NEXT_PUBLIC_AZURE_AD_CLIENT_ID=your-client-id\nNEXT_PUBLIC_AZURE_AD_TENANT_ID=your-tenant-id"})]})]})]})]})}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{onClick:u,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sign in with Azure AD"})})]})]})})}},90483:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return v},a:function(){return A}});var n=r(57437),i=r(2265),o=r(96244),s=r(40257);let c="72ed6933-6bc6-430e-a75a-cb5d2e1c20e1",a="e4748cdc-321b-4db0-bc36-141b121a9117";c&&a||(console.warn("Azure AD environment variables are not set. Authentication will not work."),console.warn("Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file"));let l={auth:{clientId:c||"dummy-client-id",authority:"https://login.microsoftonline.com/".concat(a||"dummy-tenant-id"),redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}},u=new o.Lx(l),d={scopes:["User.Read","Directory.Read.All"]};async function m(){try{if(!c||!a)throw Error("Azure AD environment variables are not configured. Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file");return await u.loginRedirect(d),null}catch(e){throw console.error("Sign in error:",e),e}}async function h(){try{await u.logoutPopup()}catch(e){console.error("Sign out error:",e)}}async function f(){try{var e,t;let r=u.getActiveAccount();if(!r)return null;let n=await u.acquireTokenSilent({scopes:["User.Read","Directory.Read.All"]}),i=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(n.accessToken)}});if(!i.ok)throw Error("Failed to fetch user details");let o=await i.json(),c=(null===(e=s.env.NEXT_PUBLIC_ADMIN_EMAILS)||void 0===e?void 0:e.split(","))||[],a=c.includes(o.mail)||c.includes(o.userPrincipalName)||(null===(t=o.mail)||void 0===t?void 0:t.endsWith("@yourcompany.com"));return{id:r.localAccountId,name:r.name||"",email:r.username||"",isAdmin:a,isBasic:!0}}catch(t){console.error("Get auth user error:",t);let e=u.getActiveAccount();return{id:(null==e?void 0:e.localAccountId)||"",name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.username)||"",isAdmin:!1,isBasic:!0}}}let x=(0,i.createContext)(void 0);function v(e){let{children:t}=e,[r,o]=(0,i.useState)(null),[s,c]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{await u.initialize();let e=await u.handleRedirectPromise();e&&(console.log("Redirect response received:",e),u.setActiveAccount(e.account));let t=await f();o(t)}catch(e){console.error("Auth initialization error:",e)}finally{c(!1)}})()},[]);let a=async()=>{try{c(!0),await m()}catch(e){console.error("Sign in error:",e),c(!1)}},l=async()=>{try{c(!0),await h(),o(null)}catch(e){console.error("Sign out error:",e)}finally{c(!1)}};return(0,n.jsx)(x.Provider,{value:{user:r,loading:s,signIn:a,signOut:l},children:t})}function A(){let e=(0,i.useContext)(x);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},99376:function(e,t,r){"use strict";var n=r(35475);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[649,971,117,744],function(){return e(e.s=45161)}),_N_E=e.O()}]);
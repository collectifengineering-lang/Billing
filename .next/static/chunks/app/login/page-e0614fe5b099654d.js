(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{45161:function(e,t,r){Promise.resolve().then(r.bind(r,56776))},56776:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var a=r(57437),i=r(2265),n=r(35475),o=r(90483),c=r(98239),l=r(98420),s=r(88906),d=r(76858);function u(){let{user:e,loading:t,signIn:r}=(0,o.a)(),u=(0,n.useRouter)(),[m,h]=(0,i.useState)(null);(0,i.useEffect)(()=>{!t&&e&&u.push("/")},[e,t,u]);let f=async()=>{try{h(null),await r()}catch(e){console.error("Sign in error:",e),h(e instanceof Error?e.message:"Sign in failed")}};return t?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-xl text-gray-600 dark:text-gray-300",children:"Loading..."})]})}):e?null:(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex items-center justify-center p-4",children:(0,a.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-md w-full",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(c.E.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.2,duration:.5},className:"mx-auto w-20 h-20 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full flex items-center justify-center mb-6 shadow-xl",children:(0,a.jsx)(l.Z,{className:"h-10 w-10 text-white"})}),(0,a.jsx)(c.E.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.6},className:"text-4xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent mb-4",children:"Billing Dashboard"}),(0,a.jsx)(c.E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.6},className:"text-lg text-gray-600 dark:text-gray-300",children:"Sign in to access your financial insights"})]}),(0,a.jsx)(c.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.5,duration:.6},className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-gray-200 dark:border-slate-700 rounded-2xl shadow-2xl p-8",children:(0,a.jsxs)("div",{className:"space-y-6",children:[m&&(0,a.jsx)(c.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-red-100 dark:bg-red-800 rounded-full flex items-center justify-center",children:(0,a.jsx)(s.Z,{className:"h-5 w-5 text-red-600 dark:text-red-400"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Authentication Error"}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:[(0,a.jsx)("p",{children:m}),m.includes("environment variables")&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-red-100 dark:bg-red-800/30 rounded-lg",children:[(0,a.jsx)("p",{className:"font-medium text-red-800 dark:text-red-200",children:"To fix this:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside mt-2 space-y-1 text-red-700 dark:text-red-300",children:[(0,a.jsxs)("li",{children:["Create a ",(0,a.jsx)("code",{className:"bg-red-200 dark:bg-red-700 px-1 rounded text-red-800 dark:text-red-200",children:".env.local"})," file in the project root"]}),(0,a.jsx)("li",{children:"Add your Azure AD configuration:"})]}),(0,a.jsx)("pre",{className:"mt-2 bg-red-200 dark:bg-red-700 p-2 rounded text-xs overflow-x-auto text-red-800 dark:text-red-200",children:"NEXT_PUBLIC_AZURE_AD_CLIENT_ID=your-client-id\nNEXT_PUBLIC_AZURE_AD_TENANT_ID=your-tenant-id"})]})]})]})]})}),(0,a.jsx)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.6},children:(0,a.jsxs)("button",{onClick:f,className:"group relative w-full flex justify-center items-center py-4 px-6 border border-transparent text-lg font-semibold rounded-xl text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-slate-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:[(0,a.jsx)(s.Z,{className:"h-5 w-5 mr-3 group-hover:scale-110 transition-transform duration-200"}),"Sign in with Azure AD",(0,a.jsx)(d.Z,{className:"h-5 w-5 ml-3 group-hover:translate-x-1 transition-transform duration-200"})]})}),(0,a.jsx)(c.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.6},className:"text-center pt-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Secure authentication powered by Microsoft Azure Active Directory"})})]})}),(0,a.jsx)(c.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.6},className:"text-center mt-8",children:(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"\xa9 2025 Billing Dashboard. All rights reserved."})})]})})}},90483:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return x},a:function(){return y}});var a=r(57437),i=r(2265),n=r(96244);let o="72ed6933-6bc6-430e-a75a-cb5d2e1c20e1",c="e4748cdc-321b-4db0-bc36-141b121a9117";o&&c||(console.warn("Azure AD environment variables are not set. Authentication will not work."),console.warn("Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file"));let l={auth:{clientId:o||"dummy-client-id",authority:"https://login.microsoftonline.com/".concat(c||"dummy-tenant-id"),redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}},s=new n.Lx(l),d={scopes:["User.Read","Directory.Read.All"]};function u(e){if(!e)return console.warn("checkAdminStatus: No user email provided"),!1;console.log("checkAdminStatus: Checking admin status for:",e);try{var t;let r=((t="jonathan@collectif.nyc,Rafael@collectif.nyc",void 0===t)?void 0:t.split(",").map(e=>e.trim()))||[];if(console.log("checkAdminStatus: Admin emails from env:",r),console.log("checkAdminStatus: Raw NEXT_PUBLIC_ADMIN_EMAILS value:","jonathan@collectif.nyc,Rafael@collectif.nyc"),r.includes(e))return console.log("checkAdminStatus: User is admin via NEXT_PUBLIC_ADMIN_EMAILS"),!0}catch(e){console.warn("checkAdminStatus: Error checking NEXT_PUBLIC_ADMIN_EMAILS:",e)}if(e.endsWith("@collectif.nyc"))return console.log("checkAdminStatus: User is admin via @collectif.nyc domain"),!0;try{if(localStorage.getItem("adminOverride")===e)return console.log("checkAdminStatus: User is admin via localStorage override"),!0}catch(e){console.warn("checkAdminStatus: Error checking localStorage override:",e)}for(let t of[/^admin@/i,/^administrator@/i,/^superuser@/i,/^root@/i])if(t.test(e))return console.log("checkAdminStatus: User is admin via pattern match:",t),!0;return"jonathan@collectif.nyc"===e?(console.log("checkAdminStatus: User is admin via hardcoded fallback"),!0):(console.log("checkAdminStatus: User is not admin:",e),!1)}async function m(){try{if(!o||!c)throw Error("Azure AD environment variables are not configured. Please set NEXT_PUBLIC_AZURE_AD_CLIENT_ID and NEXT_PUBLIC_AZURE_AD_TENANT_ID in your .env.local file");return await s.loginRedirect(d),null}catch(e){throw console.error("Sign in error:",e),e}}async function h(){try{await s.logoutPopup()}catch(e){console.error("Sign out error:",e)}}async function f(){try{let e=s.getActiveAccount();if(!e)return console.log("getAuthUser: No active account found"),null;let t=null;try{let e=await s.acquireTokenSilent({scopes:["User.Read","Directory.Read.All"]}),r=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:"Bearer ".concat(e.accessToken)}});if(!r.ok)throw Error("Failed to fetch user details from Graph API");t=await r.json(),console.log("getAuthUser: Successfully fetched user data from Graph API")}catch(r){console.warn("getAuthUser: Graph API failed, using fallback data:",r),t={mail:e.username,userPrincipalName:e.username,displayName:e.name}}let r=t.mail||t.userPrincipalName||e.username,a=u(r);return console.log("getAuthUser Debug:",{userEmail:r,accountName:e.name,accountId:e.localAccountId,isAdmin:a,adminEmails:"jonathan@collectif.nyc,Rafael@collectif.nyc",envVarAccessible:!0}),{id:e.localAccountId,name:t.displayName||e.name||"",email:r||"",isAdmin:a,isBasic:!0}}catch(e){console.error("getAuthUser error:",e);try{let e=s.getActiveAccount();if(!e)return console.log("getAuthUser: No account available for fallback"),null;let t=e.username,r=u(t);return console.log("getAuthUser Fallback Debug:",{accountEmail:t,accountName:e.name,isAdmin:r}),{id:e.localAccountId||"fallback-user",name:e.name||"Unknown User",email:t||"",isAdmin:r,isBasic:!0}}catch(e){return console.error("getAuthUser: Fallback also failed:",e),null}}}let g=(0,i.createContext)(void 0);function x(e){let{children:t}=e,[r,n]=(0,i.useState)(null),[o,c]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{await s.initialize();let e=await s.handleRedirectPromise();e&&(console.log("Redirect response received:",e),s.setActiveAccount(e.account));let t=await f();n(t)}catch(e){console.error("Auth initialization error:",e)}finally{c(!1)}})()},[]);let l=async()=>{try{c(!0),await m()}catch(e){console.error("Sign in error:",e),c(!1)}},d=async()=>{try{c(!0),await h(),n(null)}catch(e){console.error("Sign out error:",e)}finally{c(!1)}};return(0,a.jsx)(g.Provider,{value:{user:r,loading:o,signIn:l,signOut:d},children:t})}function y(){let e=(0,i.useContext)(g);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},39763:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var a=r(2265),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=(e,t)=>{let r=(0,a.forwardRef)((r,o)=>{let{color:c="currentColor",size:l=24,strokeWidth:s=2,absoluteStrokeWidth:d,children:u,...m}=r;return(0,a.createElement)("svg",{ref:o,...i,width:l,height:l,stroke:c,strokeWidth:d?24*Number(s)/Number(l):s,className:"lucide lucide-".concat(n(e)),...m},[...t.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...(Array.isArray(u)?u:[u])||[]])});return r.displayName="".concat(e),r}},88906:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(39763).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])}},function(e){e.O(0,[244,425,971,117,744],function(){return e(e.s=45161)}),_N_E=e.O()}]);
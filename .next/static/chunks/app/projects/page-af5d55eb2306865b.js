(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[895],{80051:function(e,t,s){Promise.resolve().then(s.bind(s,90782))},90782:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(57437),r=s(2265),l=s(69064),c=s(39763);let o=(0,c.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var i=s(92735),n=s(73247);let d=(0,c.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var x=s(10398),m=s(94508),p=s(27648);function h(){let[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)(new Set),[h,u]=(0,r.useState)(!0),[j,g]=(0,r.useState)(""),[y,N]=(0,r.useState)("all"),[b,f]=(0,r.useState)("projectName"),[v,w]=(0,r.useState)("asc"),[P,k]=(0,r.useState)(!1);(0,r.useEffect)(()=>{C(),S()},[]);let C=async()=>{try{u(!0),console.log("ProjectsPage: Starting fetchProjectsData");let[e,s]=await Promise.all([(0,x.bl)(),(0,x.WM)()]);if(console.log("ProjectsPage: API responses - projects:",null==e?void 0:e.length,"invoices:",null==s?void 0:s.length),e&&s){let a=(0,m.K0)(e),r=(0,m.ab)(e,s,a).map(e=>({projectId:e.projectId,projectName:e.projectName,customerName:e.customerName,status:"active",totalBilled:e.totalBilled,totalUnbilled:e.totalUnbilled,totalProjected:e.totalProjected}));t(r),console.log("ProjectsPage: Processed",r.length,"project summaries")}else l.Am.error("Failed to fetch projects data")}catch(e){console.error("Error fetching projects:",e),l.Am.error("Failed to fetch projects")}finally{u(!1)}},S=()=>{let e=(0,m._2)("closedProjects");e&&Array.isArray(e)&&c(new Set(e))},U=e=>{let t=new Set(s);t.delete(e),c(t),(0,m.az)("closedProjects",Array.from(t)),l.Am.success("Project reopened successfully")},B=e.filter(e=>!s.has(e.projectId)),T=e.filter(e=>s.has(e.projectId)),A=B.filter(e=>{let t=e.projectName.toLowerCase().includes(j.toLowerCase())||e.customerName.toLowerCase().includes(j.toLowerCase()),s="all"===y||e.status===y;return t&&s}).sort((e,t)=>{let s=e[b],a=t[b];if("string"==typeof s&&"string"==typeof a){let e=s.localeCompare(a);return"asc"===v?e:-e}return"number"==typeof s&&"number"==typeof a?"asc"===v?s-a:a-s:0}),L=e=>{b===e?w("asc"===v?"desc":"asc"):(f(e),w("asc"))},I=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return h?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading projects..."})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)(p.default,{href:"/",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[(0,a.jsx)(o,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mt-2",children:"Project Summary"}),(0,a.jsxs)("p",{className:"mt-2 text-gray-600",children:[A.length," of ",B.length," active projects",T.length>0&&(0,a.jsxs)("span",{className:"ml-2 text-gray-500",children:["(",T.length," closed)"]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[T.length>0&&(0,a.jsxs)("button",{onClick:()=>k(!P),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[P?"Hide":"Show"," Closed Projects (",T.length,")"]}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob([["Project Name,Customer,Status,Total Billed,Total Unbilled,Total Projected",...A.map(e=>['"'.concat(e.projectName,'"'),'"'.concat(e.customerName,'"'),e.status,e.totalBilled,e.totalUnbilled,e.totalProjected].join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="projects-summary.csv",s.click(),window.URL.revokeObjectURL(t)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Projects"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:j,onChange:e=>g(e.target.value),placeholder:"Search by project or customer name...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Filter"}),(0,a.jsxs)("select",{value:y,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"on-hold",children:"On Hold"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),(0,a.jsxs)("select",{value:b,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"projectName",children:"Project Name"}),(0,a.jsx)("option",{value:"customerName",children:"Customer"}),(0,a.jsx)("option",{value:"totalBilled",children:"Total Billed"}),(0,a.jsx)("option",{value:"totalUnbilled",children:"Total Unbilled"}),(0,a.jsx)("option",{value:"totalProjected",children:"Total Projected"})]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden mb-6",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Active Projects"})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsxs)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("projectName"),children:["Project Name","projectName"===b&&(0,a.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,a.jsxs)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("customerName"),children:["Customer","customerName"===b&&(0,a.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("totalBilled"),children:["Total Billed","totalBilled"===b&&(0,a.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,a.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("totalUnbilled"),children:["Total Unbilled","totalUnbilled"===b&&(0,a.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,a.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("totalProjected"),children:["Total Projected","totalProjected"===b&&(0,a.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.projectName}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.customerName}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:I(e.totalBilled)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:I(e.totalUnbilled)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:I(e.totalProjected)})]},e.projectId))})]})})]}),P&&T.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Closed Projects"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"These projects have been closed and are hidden from the main projections table."})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project Name"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Billed"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Unbilled"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Projected"}),(0,a.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.projectName}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.customerName}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:I(e.totalBilled)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:I(e.totalUnbilled)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:I(e.totalProjected)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:(0,a.jsxs)("button",{onClick:()=>U(e.projectId),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:[(0,a.jsx)(d,{className:"h-3 w-3 mr-1"}),"Reopen"]})})]},e.projectId))})]})})]}),0===A.length&&B.length>0&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No active projects found matching your criteria."})}),0===B.length&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No active projects found."})})]})})}}},function(e){e.O(0,[64,648,755,837,971,117,744],function(){return e(e.s=80051)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[895],{80051:function(e,t,r){Promise.resolve().then(r.bind(r,36751))},36751:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var s=r(57437),a=r(2265),l=r(69064),c=r(32660),n=r(92735),o=r(73247);let i=(0,r(39763).Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var d=r(10398),x=r(94508),m=r(27648);function p(){let[e,t]=(0,a.useState)([]),[r,p]=(0,a.useState)(new Set),[u,h]=(0,a.useState)(!0),[g,j]=(0,a.useState)(""),[y,f]=(0,a.useState)("all"),[b,N]=(0,a.useState)("projectName"),[v,w]=(0,a.useState)("asc");(0,a.useEffect)(()=>{k(),P()},[]);let k=async()=>{try{h(!0),console.log("ProjectsPage: Starting fetchProjectsData");let[e,r]=await Promise.all([(0,d.bl)(),(0,d.WM)()]);if(console.log("ProjectsPage: API responses - projects:",null==e?void 0:e.length,"invoices:",null==r?void 0:r.length),e&&r){let s=(0,x.K0)(e),a=(0,x.ab)(e,r,s).map(e=>({projectId:e.projectId,projectName:e.projectName,customerName:e.customerName,status:"active",totalBilled:e.totalBilled,totalUnbilled:e.totalUnbilled,totalProjected:e.totalProjected}));t(a),console.log("ProjectsPage: Processed",a.length,"project summaries")}else l.Am.error("Failed to fetch projects data")}catch(e){console.error("Error fetching projects:",e),l.Am.error("Failed to fetch projects")}finally{h(!1)}},P=()=>{let e=(0,x._2)("closedProjects");e&&Array.isArray(e)&&p(new Set(e))},T=e=>{let t=new Set(r);t.delete(e),p(t),(0,x.az)("closedProjects",Array.from(t)),l.Am.success("Project reopened successfully")},C=e=>{let t=new Set(r);t.add(e),p(t),(0,x.az)("closedProjects",Array.from(t)),l.Am.success("Project closed successfully")},S=e.filter(e=>!r.has(e.projectId)),U=e.filter(e=>r.has(e.projectId)),A=S.filter(e=>{let t=e.projectName.toLowerCase().includes(g.toLowerCase())||e.customerName.toLowerCase().includes(g.toLowerCase()),r="all"===y||e.status===y;return t&&r}).sort((e,t)=>{let r=e[b],s=t[b];if("string"==typeof r&&"string"==typeof s){let e=r.localeCompare(s);return"asc"===v?e:-e}return"number"==typeof r&&"number"==typeof s?"asc"===v?r-s:s-r:0}),L=e=>{b===e?w("asc"===v?"desc":"asc"):(N(e),w("asc"))},B=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return u?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading projects..."})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)(m.default,{href:"/",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),"Back to Dashboard"]})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mt-2",children:"Project Summary"}),(0,s.jsxs)("p",{className:"mt-2 text-gray-600",children:[A.length," of ",S.length," active projects",U.length>0&&(0,s.jsxs)("span",{className:"ml-2 text-gray-500",children:["(",U.length," closed)"]})]})]}),(0,s.jsx)("div",{className:"flex space-x-3",children:(0,s.jsxs)("button",{onClick:()=>{let e=new Blob([["Project Name,Customer,Status,Total Billed,Total Unbilled,Total Projected",...A.map(e=>['"'.concat(e.projectName,'"'),'"'.concat(e.customerName,'"'),e.status,e.totalBilled,e.totalUnbilled,e.totalProjected].join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="projects-summary.csv",r.click(),window.URL.revokeObjectURL(t)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[(0,s.jsx)(n.Z,{className:"h-4 w-4 mr-2"}),"Export CSV"]})})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Projects"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(o.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",value:g,onChange:e=>j(e.target.value),placeholder:"Search by project or customer name...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Filter"}),(0,s.jsxs)("select",{value:y,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"all",children:"All Status"}),(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"completed",children:"Completed"}),(0,s.jsx)("option",{value:"on-hold",children:"On Hold"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),(0,s.jsxs)("select",{value:b,onChange:e=>L(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"projectName",children:"Project Name"}),(0,s.jsx)("option",{value:"customerName",children:"Customer"}),(0,s.jsx)("option",{value:"totalBilled",children:"Total Billed"}),(0,s.jsx)("option",{value:"totalUnbilled",children:"Total Unbilled"}),(0,s.jsx)("option",{value:"totalProjected",children:"Total Projected"})]})]})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden mb-6",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Active Projects"})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsxs)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("projectName"),children:["Project Name","projectName"===b&&(0,s.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,s.jsxs)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("customerName"),children:["Customer","customerName"===b&&(0,s.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("totalBilled"),children:["Total Billed","totalBilled"===b&&(0,s.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,s.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("totalUnbilled"),children:["Total Unbilled","totalUnbilled"===b&&(0,s.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,s.jsxs)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>L("totalProjected"),children:["Total Projected","totalProjected"===b&&(0,s.jsx)("span",{className:"ml-1",children:"asc"===v?"↑":"↓"})]}),(0,s.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.projectName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.customerName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:e.status})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:B(e.totalBilled)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:B(e.totalUnbilled)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:B(e.totalProjected)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:(0,s.jsx)("button",{onClick:()=>C(e.projectId),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200",children:"Close"})})]},e.projectId))})]})})]}),U.length>0&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Closed Projects"})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Billed"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Unbilled"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Projected"}),(0,s.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.projectName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.customerName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:B(e.totalBilled)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:B(e.totalUnbilled)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:B(e.totalProjected)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",children:(0,s.jsxs)("button",{onClick:()=>T(e.projectId),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200",children:[(0,s.jsx)(i,{className:"h-3 w-3 mr-1"}),"Reopen"]})})]},e.projectId))})]})})]}),0===A.length&&S.length>0&&(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("p",{className:"text-gray-500",children:"No active projects found matching your criteria."})}),0===S.length&&(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("p",{className:"text-gray-500",children:"No active projects found."})})]})})}},32660:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(39763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},40257:function(e,t,r){"use strict";var s,a;e.exports=(null==(s=r.g.process)?void 0:s.env)&&"object"==typeof(null==(a=r.g.process)?void 0:a.env)?r.g.process:r(44227)},44227:function(e){!function(){var t={229:function(e){var t,r,s,a=e.exports={};function l(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function n(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(e){r=c}}();var o=[],i=!1,d=-1;function x(){i&&s&&(i=!1,s.length?o=s.concat(o):d=-1,o.length&&m())}function m(){if(!i){var e=n(x);i=!0;for(var t=o.length;t;){for(s=o,o=[];++d<t;)s&&s[d].run();d=-1,t=o.length}s=null,i=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function u(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.push(new p(e,t)),1!==o.length||i||n(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=u,a.addListener=u,a.once=u,a.off=u,a.removeListener=u,a.removeAllListeners=u,a.emit=u,a.prependListener=u,a.prependOnceListener=u,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},r={};function s(e){var a=r[e];if(void 0!==a)return a.exports;var l=r[e]={exports:{}},c=!0;try{t[e](l,l.exports,s),c=!1}finally{c&&delete r[e]}return l.exports}s.ab="//";var a=s(229);e.exports=a}()}},function(e){e.O(0,[648,64,82,354,837,971,117,744],function(){return e(e.s=80051)}),_N_E=e.O()}]);
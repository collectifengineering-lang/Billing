(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[685],{63774:function(e,t,s){Promise.resolve().then(s.bind(s,50356))},50356:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(57437),r=s(2265),n=s(69064);function o(){let[e,t]=(0,r.useState)({}),[s,o]=(0,r.useState)({}),[l,c]=(0,r.useState)(!0),[i,d]=(0,r.useState)(null),[u,m]=(0,r.useState)("");(0,r.useEffect)(()=>{x()},[]);let x=async()=>{try{c(!0);let[e,s]=await Promise.all([fetch("/api/statuses"),fetch("/api/comments")]);if(e.ok){let s=await e.json();t(s)}if(s.ok){let e=await s.json();o(e)}}catch(e){console.error("Error fetching data:",e),n.Am.error("Failed to load data")}finally{c(!1)}},p=(t,a,r)=>{var n,o;let l="status"===t?(null===(n=e[a])||void 0===n?void 0:n[r])||"":(null===(o=s[a])||void 0===o?void 0:o[r])||"";d({type:t,projectId:a,month:r}),m(l)},h=async()=>{if(i)try{let e="status"===i.type?"/api/statuses":"/api/comments",s="status"===i.type?{projectId:i.projectId,month:i.month,status:u}:{projectId:i.projectId,month:i.month,comment:u};(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?("status"===i.type?t(e=>({...e,[i.projectId]:{...e[i.projectId],[i.month]:u}})):o(e=>({...e,[i.projectId]:{...e[i.projectId],[i.month]:u}})),n.Am.success("".concat("status"===i.type?"Status":"Comment"," updated successfully"))):n.Am.error("Failed to update")}catch(e){console.error("Error updating:",e),n.Am.error("Failed to update")}finally{d(null),m("")}},y=()=>{d(null),m("")},j=e=>{"Enter"===e.key?h():"Escape"===e.key&&y()},f=new Set([...Object.keys(e),...Object.keys(s)]),g=new Set;Object.values(e).forEach(e=>{Object.keys(e).forEach(e=>g.add(e))}),Object.values(s).forEach(e=>{Object.keys(e).forEach(e=>g.add(e))});let b=Array.from(f).sort(),v=Array.from(g).sort();return l?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading public data..."})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Public Project Statuses & Comments"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"View and edit project statuses and comments. No authentication required."})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Project ID"}),v.map(e=>(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e},e))]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(t=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t}),v.map(r=>{var n,o;return(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Status:"}),(null==i?void 0:i.type)==="status"&&i.projectId===t&&i.month===r?(0,a.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),onKeyDown:j,onBlur:h,className:"ml-2 px-2 py-1 text-xs border rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,a.jsx)("button",{onClick:()=>p("status",t,r),className:"ml-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200 min-w-[60px] text-left",children:(null===(n=e[t])||void 0===n?void 0:n[r])||"Click to add"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Comment:"}),(null==i?void 0:i.type)==="comment"&&i.projectId===t&&i.month===r?(0,a.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),onKeyDown:j,onBlur:h,className:"ml-2 px-2 py-1 text-xs border rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,a.jsx)("button",{onClick:()=>p("comment",t,r),className:"ml-2 px-2 py-1 text-xs bg-green-100 text-green-800 rounded hover:bg-green-200 min-w-[60px] text-left",children:(null===(o=s[t])||void 0===o?void 0:o[r])||"Click to add"})]})]})},r)})]},t))})]})})]})})})}}},function(e){e.O(0,[64,971,117,744],function(){return e(e.s=63774)}),_N_E=e.O()}]);
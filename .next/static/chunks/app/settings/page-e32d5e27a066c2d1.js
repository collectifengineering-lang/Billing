(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{19396:function(e,r,t){Promise.resolve().then(t.bind(t,67518))},67518:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return u}});var a=t(57437),s=t(2265),l=t(77086),d=t(69064),o=t(27648),n=t(32660),i=t(39763);let c=(0,i.Z)("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);var x=t(95805),g=t(91723);let h=(0,i.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function m(){let[e,r]=(0,s.useState)(!1),[t,i]=(0,s.useState)(!1),[m,u]=(0,s.useState)(""),[b,y]=(0,s.useState)(""),[k,p]=(0,s.useState)("#6366f1"),[f,j]=(0,s.useState)({configured:!1}),{data:w,error:v}=(0,l.ZP)("/api/auth/status",async e=>{let r=await fetch(e);if(!r.ok)throw Error("Failed to fetch token status");return r.json()}),{data:N,mutate:C}=(0,l.ZP)("/api/project-managers",async e=>{let r=await fetch(e);if(!r.ok)throw Error("Failed to fetch project managers");let t=await r.json();try{let e=Object.entries(t||{}).map(e=>{let[r,t]=e;return{id:r,...t||{}}});localStorage.setItem("projectManagers",JSON.stringify(e))}catch(e){}return t});(0,s.useEffect)(()=>{S()},[]);let S=async()=>{try{console.log("Settings: Testing Clockify connection...");let e=await fetch("/api/clockify?action=test-connection"),r=await e.json();r.success?(console.log("Settings: Clockify connection successful"),j({configured:!0,workspaces:r.workspaces})):(console.log("Settings: Clockify connection failed:",r.error),j({configured:!1,error:r.error}))}catch(e){console.error("Settings: Error testing Clockify connection:",e),j({configured:!1,error:"Failed to connect to Clockify"})}},A=async()=>{try{console.log("\uD83D\uDD04 Starting Clockify sync..."),d.Am.loading("Syncing Clockify data...");let e=await fetch("/api/clockify/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({startDate:new Date(Date.now()-2592e6).toISOString(),endDate:new Date().toISOString()})});if(e.ok){let r=await e.json();console.log("✅ Clockify sync completed:",r),d.Am.dismiss(),d.Am.success("Clockify data synced successfully!"),window.location.reload()}else{let r=await e.json();console.error("❌ Clockify sync failed:",r),d.Am.dismiss(),d.Am.error("Clockify sync failed: ".concat(r.message))}}catch(e){console.error("❌ Clockify sync error:",e),d.Am.dismiss(),d.Am.error("Failed to sync Clockify data")}},E=async()=>{r(!0);try{if(!(await fetch("/api/auth/status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"refresh"})})).ok)throw Error("Failed to refresh token");d.Am.success("Token refreshed successfully")}catch(e){console.error("Error refreshing token:",e),d.Am.error("Failed to refresh token")}finally{r(!1)}},M=async()=>{if(!b.trim()){d.Am.error("Manager name is required");return}i(!0);try{if(!(await fetch("/api/project-managers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:m||void 0,name:b.trim(),color:k})})).ok)throw Error("Failed to save project manager");d.Am.success(m?"Manager updated successfully":"Manager added successfully"),u(""),y(""),p("#6366f1"),C()}catch(e){console.error("Error saving manager:",e),d.Am.error("Failed to save manager")}finally{i(!1)}},O=async e=>{if(confirm("Are you sure you want to delete this project manager?"))try{if(!(await fetch("/api/project-managers",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok)throw Error("Failed to delete project manager");d.Am.success("Manager deleted successfully"),C()}catch(e){console.error("Error deleting manager:",e),d.Am.error("Failed to delete manager")}};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"relative mb-12",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0",children:(0,a.jsx)(o.default,{href:"/",className:"inline-flex items-center justify-center w-12 h-12 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-gray-200 dark:border-slate-700 rounded-full hover:bg-white dark:hover:bg-slate-700 transition-all duration-200 shadow-lg hover:shadow-xl",children:(0,a.jsx)(n.Z,{className:"h-6 w-6 text-gray-600 dark:text-gray-300"})})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent mb-4",children:"Settings"}),(0,a.jsx)("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto",children:"Configure project managers, integrations, and system preferences"})]})]}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-gray-200 dark:border-slate-700 rounded-2xl shadow-xl p-8",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/40 rounded-xl flex items-center justify-center mr-4",children:(0,a.jsx)(c,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Authentication Status"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Zoho Books API connection status"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[v?(0,a.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:(0,a.jsx)("p",{className:"text-red-700 dark:text-red-300",children:"Error loading token status"})}):w?(0,a.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-4",children:(0,a.jsxs)("p",{className:"text-green-700 dark:text-green-300",children:["Token expires: ",new Date(w.expiresAt).toLocaleString()]})}):(0,a.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-4",children:(0,a.jsx)("p",{className:"text-yellow-700 dark:text-yellow-300",children:"Loading token status..."})}),(0,a.jsx)("button",{onClick:E,disabled:e,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-xl font-medium transition-colors duration-200 shadow-lg hover:shadow-xl disabled:cursor-not-allowed",children:e?"Refreshing...":"Refresh Token"})]})]}),(0,a.jsxs)("div",{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-gray-200 dark:border-slate-700 rounded-2xl shadow-xl p-8",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/40 rounded-xl flex items-center justify-center mr-4",children:(0,a.jsx)(x.Z,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Project Managers"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage project manager assignments and colors"})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-slate-700/50 rounded-xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:m?"Edit Manager":"Add New Manager"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Manager Name",value:b,onChange:e=>y(e.target.value),className:"px-4 py-3 border border-gray-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"}),(0,a.jsx)("input",{type:"color",value:k,onChange:e=>p(e.target.value),className:"w-full h-12 border border-gray-300 dark:border-slate-600 rounded-xl cursor-pointer"}),(0,a.jsx)("button",{onClick:M,disabled:t||!b.trim(),className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white rounded-xl font-medium transition-colors duration-200 shadow-lg hover:shadow-xl disabled:cursor-not-allowed",children:t?"Saving...":m?"Update":"Add"})]}),m&&(0,a.jsx)("button",{onClick:()=>{u(""),y(""),p("#6366f1")},className:"mt-3 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Cancel Edit"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Current Managers"}),N&&Object.keys(N).length>0?(0,a.jsx)("ul",{className:"space-y-3",children:Object.entries(N).map(e=>{let[r,{name:t,color:s}]=e;return(0,a.jsxs)("li",{className:"flex items-center justify-between bg-white dark:bg-slate-700 rounded-xl p-4 border border-gray-200 dark:border-slate-600",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border-2 border-white dark:border-slate-600 shadow-sm",style:{backgroundColor:s}}),(0,a.jsx)("span",{className:"text-gray-900 dark:text-white font-medium",children:t}),(0,a.jsxs)("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:["(",r,")"]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{u(r),y(t),p(s)},className:"px-3 py-1 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors duration-200",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>O(r),className:"px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors duration-200",children:"Delete"})]})]},r)})}):(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(x.Z,{className:"h-12 w-12 mx-auto mb-3 text-gray-400 dark:text-gray-500"}),(0,a.jsx)("p",{children:"No project managers configured yet"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-gray-200 dark:border-slate-700 rounded-2xl shadow-xl p-8",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/40 rounded-xl flex items-center justify-center mr-4",children:(0,a.jsx)(g.Z,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Clockify Integration"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Time tracking and analytics integration"})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[f.configured?(0,a.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-xl p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-green-800 dark:text-green-200",children:"Clockify Integration Active"}),(0,a.jsx)("p",{className:"text-green-600 dark:text-green-300",children:"Time tracking data will be included in dashboard metrics"})]})]})}):(0,a.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-yellow-800 dark:text-yellow-200",children:"Clockify Integration Not Configured"}),(0,a.jsx)("p",{className:"text-yellow-600 dark:text-yellow-300",children:f.error||"Please configure Clockify API credentials"})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsx)("button",{onClick:S,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl font-medium transition-colors duration-200 shadow-lg hover:shadow-xl",children:"Test Connection"}),(0,a.jsxs)("button",{onClick:A,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium transition-colors duration-200 shadow-lg hover:shadow-xl flex items-center justify-center",children:[(0,a.jsx)(h,{className:"h-5 w-5 mr-2"}),"Sync Clockify"]})]}),f.workspaces&&f.workspaces.length>0&&(0,a.jsxs)("div",{className:"bg-gray-50 dark:bg-slate-700/50 rounded-xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Available Workspaces"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.workspaces.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-slate-700 rounded-lg p-3 border border-gray-200 dark:border-slate-600",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",e.id]})]},e.id))})]})]})]})]})]})})}function u(){return(0,a.jsx)(m,{})}},32660:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},95805:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(39763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[451,64,848,971,117,744],function(){return e(e.s=19396)}),_N_E=e.O()}]);